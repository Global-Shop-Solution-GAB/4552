Program.Sub.ScreenSU.Start
Gui.In_Transit..Create
Gui.In_Transit..Caption("Pick/Ship Dashboard")
Gui.In_Transit..Size(15360,11400)
Gui.In_Transit..MinX(0)
Gui.In_Transit..MinY(0)
Gui.In_Transit..Position(0,0)
Gui.In_Transit..BackColor(-2147483633)
Gui.In_Transit..MousePointer(0)
Gui.In_Transit..Event(UnLoad,In_Transit_UnLoad)
Gui.In_Transit.tab1.Create(Tab)
Gui.In_Transit.tab1.Size(14970,9375)
Gui.In_Transit.tab1.Position(105,1035)
Gui.In_Transit.tab1.Tabs(3)
Gui.In_Transit.tab1.SetTab(0)
Gui.In_Transit.tab1.Caption("New")
Gui.In_Transit.tab1.SetTab(1)
Gui.In_Transit.tab1.Caption("Receive")
Gui.In_Transit.tab1.SetTab(2)
Gui.In_Transit.tab1.Caption("Stage for Ship")
Gui.In_Transit.GsGridControlNew.Create(GsGridControl)
Gui.In_Transit.GsGridControlNew.Size(14715,8205)
Gui.In_Transit.GsGridControlNew.Position(75,120)
Gui.In_Transit.GsGridControlNew.Parent("tab1",0)
Gui.In_Transit.GsGridControlNew.Event(RowCellClick,RowCellClick)
Gui.In_Transit.GsGridControlRec.Create(GsGridControl)
Gui.In_Transit.GsGridControlRec.Size(14715,8205)
Gui.In_Transit.GsGridControlRec.Position(75,120)
Gui.In_Transit.GsGridControlRec.Parent("tab1",1)
Gui.In_Transit.GsGridControlRec.Event(CellValueChanged,GsGridControlRec_CellValueChanged)
Gui.In_Transit.GsGridControlRec.Event(RowCellClick,RowCellClick)
Gui.In_Transit.GsGridControlStage.Create(GsGridControl)
Gui.In_Transit.GsGridControlStage.Size(14715,8205)
Gui.In_Transit.GsGridControlStage.Position(75,120)
Gui.In_Transit.GsGridControlStage.Parent("tab1",2)
Gui.In_Transit.GsGridControlStage.Event(RowCellClick,RowCellClick)
Gui.In_Transit.txtNewPart.Create(TextBox,"",True,2760,300,0,105,8655,True,0,"Arial",8,-2147483643,1)
Gui.In_Transit.txtNewPart.Parent("tab1",0)
Gui.In_Transit.txtNewPart.Event(KeyPressEnter,ScanPart)
Gui.In_Transit.txtNewPart.Event(GotFocus,txtNewPart_GotFocus)
Gui.In_Transit.lblNewPart.Create(Label,"Part",True,1935,255,0,105,8430,True,0,"Arial",8,-2147483633,0)
Gui.In_Transit.lblNewPart.Parent("tab1",0)
Gui.In_Transit.cmdSetAll.Create(Button)
Gui.In_Transit.cmdSetAll.Size(1290,375)
Gui.In_Transit.cmdSetAll.Position(3015,8580)
Gui.In_Transit.cmdSetAll.Parent("tab1",1)
Gui.In_Transit.cmdSetAll.Caption("Auto Fill Bin")
Gui.In_Transit.cmdSetAll.Event(Click,cmdSetAll_Click)
Gui.In_Transit.lblPart.Create(Label,"Part",True,1935,255,0,105,8430,True,0,"Arial",8,-2147483633,0)
Gui.In_Transit.lblPart.Parent("tab1",2)
Gui.In_Transit.txtPartStage.Create(TextBox,"",True,2760,300,0,105,8655,True,0,"Arial",8,-2147483643,1)
Gui.In_Transit.txtPartStage.Parent("tab1",2)
Gui.In_Transit.txtPartStage.Event(KeyPressEnter,ScanPart)
Gui.In_Transit.txtPartStage.Event(GotFocus,txtPartStage_GotFocus)
Gui.In_Transit.txtRecPart.Create(TextBox,"",True,2760,300,0,105,8655,True,0,"Arial",8,-2147483643,1)
Gui.In_Transit.txtRecPart.Parent("tab1",1)
Gui.In_Transit.txtRecPart.Event(KeyPressEnter,ScanPart)
Gui.In_Transit.txtRecPart.Event(GotFocus,txtRecPart_GotFocus)
Gui.In_Transit.lblRecpart.Create(Label,"Part",True,1935,255,0,105,8430,True,0,"Arial",8,-2147483633,0)
Gui.In_Transit.lblRecpart.Parent("tab1",1)
Gui.In_Transit.frame1.Create(Frame)
Gui.In_Transit.frame1.Size(14910,975)
Gui.In_Transit.frame1.Position(105,45)
Gui.In_Transit.txtNum.Create(TextBox,"",True,1785,300,0,105,495,True,0,"Arial",8,-2147483643,1)
Gui.In_Transit.txtNum.Parent("frame1")
Gui.In_Transit.txtNum.Event(GotFocus,txtNum_GotFocus)
Gui.In_Transit.txtNum.Event(KeyPressEnter,txtNum_KeyPressEnter)
Gui.In_Transit.txtNum.Event(LostFocus,txtNum_LostFocus)
Gui.In_Transit.lblNum.Create(Label,"Sales Order",True,1935,255,0,105,255,True,0,"Arial",8,-2147483633,0)
Gui.In_Transit.lblNum.Parent("frame1")
Gui.In_Transit.cmdNum.Create(Button)
Gui.In_Transit.cmdNum.Size(390,375)
Gui.In_Transit.cmdNum.Position(1980,465)
Gui.In_Transit.cmdNum.Parent("frame1")
Gui.In_Transit.cmdNum.Caption("^")
Gui.In_Transit.cmdNum.Event(Click,cmdNum_Click)
Gui.In_Transit.cmdupdate.Create(Button)
Gui.In_Transit.cmdupdate.Size(1905,375)
Gui.In_Transit.cmdupdate.Position(12915,465)
Gui.In_Transit.cmdupdate.Parent("frame1")
Gui.In_Transit.cmdupdate.Caption("Update Sales Order")
Gui.In_Transit.cmdupdate.DefaultValue("")
Gui.In_Transit.cmdupdate.Event(Click,cmdupdate_Click)
Gui.In_Transit.lblStatus.Create(Label,"Status:",True,10245,705,0,2595,240,True,0,"Arial",8,-2147483633,0)
Gui.In_Transit.lblStatus.Parent("frame1")
Gui.In_Transit.lblStatus.FontStyle(True,False,False,False,False)
Gui.In_Transit.lblStatus.ForeColor(255)
Gui.In_Transit.cmdSave.Create(Button)
Gui.In_Transit.cmdSave.Size(855,375)
Gui.In_Transit.cmdSave.Position(105,10530)
Gui.In_Transit.cmdSave.Caption("Save")
Gui.In_Transit.cmdSave.Event(Click,cmdSave_Click)
Gui.FormItemMaster..Create
Gui.FormItemMaster..Caption("Item Master View")
Gui.FormItemMaster..Size(10470,5115)
Gui.FormItemMaster..MinX(0)
Gui.FormItemMaster..MinY(0)
Gui.FormItemMaster..Position(0,0)
Gui.FormItemMaster..BackColor(-2147483633)
Gui.FormItemMaster..MousePointer(0)
Gui.FormItemMaster..Event(UnLoad,FormItemMaster_UnLoad)
Gui.FormItemMaster.GsGridControl1.Create(GsGridControl)
Gui.FormItemMaster.GsGridControl1.Size(10110,4500)
Gui.FormItemMaster.GsGridControl1.Position(75,75)
Gui.BinToBin..Create
Gui.BinToBin..Caption("Bin Transfer")
Gui.BinToBin..Size(15360,8505)
Gui.BinToBin..MinX(0)
Gui.BinToBin..MinY(0)
Gui.BinToBin..Position(0,0)
Gui.BinToBin..BackColor(-2147483633)
Gui.BinToBin..MousePointer(0)
Gui.BinToBin..Event(UnLoad,BinToBin_UnLoad)
Gui.BinToBin.txtSalesOrder.Create(TextBox,"",True,2085,300,0,105,360,True,0,"Arial",8,-2147483643,1)
Gui.BinToBin.lblSalesOrder.Create(Label,"Sales Order",True,1935,255,0,105,120,True,0,"Arial",8,-2147483633,0)
Gui.BinToBin.GsGridControlBinTransfer.Create(GsGridControl)
Gui.BinToBin.GsGridControlBinTransfer.Size(14970,6750)
Gui.BinToBin.GsGridControlBinTransfer.Position(105,765)
Gui.BinToBin.GsGridControlBinTransfer.Event(RowCellClick,GsGridControlBinTransfer_RowCellClick)
Gui.BinToBin.cmdSubmit.Create(Button)
Gui.BinToBin.cmdSubmit.Size(960,375)
Gui.BinToBin.cmdSubmit.Position(105,7575)
Gui.BinToBin.cmdSubmit.Caption("Submit")
Gui.BinToBin.cmdSubmit.DefaultValue("")
Gui.BinToBin.cmdSubmit.Event(Click,cmdSubmit_Click)
Gui.BinToBin.txtDiff.Create(TextBox,"",True,2040,300,0,13035,360,True,0,"Arial",8,-2147483643,1)
Gui.BinToBin.lblDiff.Create(Label,"Qty Left",True,2100,255,0,12975,120,True,0,"Arial",8,-2147483633,0)
Gui.BinToBin.cmdAutoToBin.Create(Button)
Gui.BinToBin.cmdAutoToBin.Size(1545,375)
Gui.BinToBin.cmdAutoToBin.Position(1605,7575)
Gui.BinToBin.cmdAutoToBin.Caption("Auto Fill To Bin")
Gui.BinToBin.cmdAutoToBin.Event(Click,cmdAutoToBin_Click)
Gui.Form_BinSelect..Create
Gui.Form_BinSelect..Caption("Select Bin")
Gui.Form_BinSelect..Size(14970,6705)
Gui.Form_BinSelect..MinX(0)
Gui.Form_BinSelect..MinY(0)
Gui.Form_BinSelect..Position(0,0)
Gui.Form_BinSelect..BackColor(-2147483633)
Gui.Form_BinSelect..MousePointer(0)
Gui.Form_BinSelect..Event(UnLoad,Form_BinSelect_UnLoad)
Gui.Form_BinSelect.txtScanBin.Create(TextBox,"",True,1635,300,0,105,420,True,0,"Arial",8,-2147483643,1)
Gui.Form_BinSelect.txtScanBin.Event(KeyPressEnter,txtScanBin_KeyPressEnter)
Gui.Form_BinSelect.lblScanBin.Create(Label,"Scan Bin",True,1575,255,0,105,195,True,0,"Arial",8,-2147483633,0)
Gui.Form_BinSelect.GsGridControlScanBin.Create(GsGridControl)
Gui.Form_BinSelect.GsGridControlScanBin.Size(14625,5295)
Gui.Form_BinSelect.GsGridControlScanBin.Position(105,795)
Gui.Form_BinSelect.txtScanSerial.Create(TextBox,"",True,2205,300,0,1860,420,True,0,"Arial",8,-2147483643,1)
Gui.Form_BinSelect.txtScanSerial.Event(KeyPressEnter,txtScanBin_KeyPressEnter)
Gui.Form_BinSelect.lblSerial.Create(Label,"Scan Serial",True,1935,255,0,1860,195,True,0,"Arial",8,-2147483633,0)
Gui.Form_PickShipQty..Create
Gui.Form_PickShipQty..Caption("Pick/Ship Quantity")
Gui.Form_PickShipQty..Size(15360,8505)
Gui.Form_PickShipQty..MinX(0)
Gui.Form_PickShipQty..MinY(0)
Gui.Form_PickShipQty..Position(0,0)
Gui.Form_PickShipQty..BackColor(-2147483633)
Gui.Form_PickShipQty..MousePointer(0)
Gui.Form_PickShipQty..Event(UnLoad,Form_PickShipQty_UnLoad)
Gui.Form_PickShipQty.txtQtyCount.Create(TextBox,"",True,1605,300,0,105,495,True,0,"Arial",8,-2147483643,1)
Gui.Form_PickShipQty.txtQtyCount.Locked(True)
Gui.Form_PickShipQty.lblQtyCount.Create(Label,"Qty Count",True,1935,255,0,105,270,True,0,"Arial",8,-2147483633,0)
Gui.Form_PickShipQty.txtQtyLeft.Create(TextBox,"",True,1605,300,0,2115,480,True,0,"Arial",8,-2147483643,1)
Gui.Form_PickShipQty.txtQtyLeft.Locked(True)
Gui.Form_PickShipQty.lblQtyLeft.Create(Label,"Qty Left On Line",True,1935,255,0,2115,255,True,0,"Arial",8,-2147483633,0)
Gui.Form_PickShipQty.GsGridControlPickShipQty.Create(GsGridControl)
Gui.Form_PickShipQty.GsGridControlPickShipQty.Size(14970,6510)
Gui.Form_PickShipQty.GsGridControlPickShipQty.Position(105,930)
Gui.Form_PickShipQty.GsGridControlPickShipQty.Event(CellValueChanged,GsGridControlPickShipQty_CellValueChanged)
Gui.Form_PickShipQty.cmdPickShipSubmit.Create(Button)
Gui.Form_PickShipQty.cmdPickShipSubmit.Size(855,375)
Gui.Form_PickShipQty.cmdPickShipSubmit.Position(105,7515)
Gui.Form_PickShipQty.cmdPickShipSubmit.Caption("Submit")
Gui.Form_PickShipQty.cmdPickShipSubmit.Event(Click,cmdPickShipSubmit_Click)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
Variable.Global.iTab.Declare(Long,0)
Variable.Global.iIndex.Declare(Long,0)
Variable.Global.iBIndex.Declare(Long,0)
Variable.Global.sGrid.Declare(String,"")
Variable.Global.sBin.Declare(String,"")
Variable.Global.bDelete.Declare(Boolean,False)
Variable.Global.sReason.Declare(String,"")
Variable.Global.sGoodScan.Declare(String,"")
Variable.Global.sBadScan.Declare(String,"")
Program.Sub.Preflight.End

Program.Sub.Main.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")

F.ODBC.Connection!con.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass)
Gui.In_Transit.lblStatus.Caption("")
Gui.In_Transit.cmdupdate.Visible(False)
Gui.In_Transit.tab1.SetTab(0)
Gui.BinToBin.txtSalesOrder.Locked(True)

'setting path for wav file
F.Intrinsic.String.Build("{0}\GCG_4552_GoodScan.wav",V.Caller.GasDir,V.Global.sGoodScan)
F.Intrinsic.String.Build("{0}\GCG_4552_BadScan.wav",V.Caller.GasDir,V.Global.sBadScan)

'Gui.In_Transit.cmdSave.Enabled(False)
Gui.In_Transit.lblStatus.Alignment(3)
'creating from bin dictionary
F.Intrinsic.String.Build("Select Bin,Bin From V_Bin_Master Where Bin = 'INTRAN'","",V.Local.sSql)
F.Data.Dictionary.CreateFromSQL("FromBin","con",V.Local.sSql)

'creating to bin dictionary
F.Intrinsic.String.Build("Select Bin,Bin From V_Bin_Master Order by Bin Desc","",V.Local.sSql)
F.Data.Dictionary.CreateFromSQL("ToBin","con",V.Local.sSql)

F.Intrinsic.String.Build("Select Bin, Bin From V_Bin_Master Where Bin like 'XSH%' or Bin = 'INTRAN'","",V.Local.sSql)
'F.Intrinsic.String.Build("Select Bin, Bin From V_Bin_Master Order by Bin Desc","",V.Local.sSql)
F.Data.Dictionary.CreateFromSQL("StageBin","con",V.Local.sSql)

F.Intrinsic.String.Build("Select rtrim(Order_No), rtrim(Name_Customer_Ship) as Name_Customer From V_ORDER_SHIP_TO where Ship_Id <> ''","",V.Local.sSql)
F.Data.Dictionary.CreateFromSQL("CustName","con",V.Local.sSql)
F.Data.Dictionary.SetDefaultReturn("CustName","")

F.Data.DataTable.CreateFromSQL("ItemMaster","con","Select Part, Lot, Bin, Heat, Serial_Number as 'Serial Number', Quantity From V_Item_Master",True)
F.Data.DataView.Create("ItemMaster","ItemMaster")
Gui.FormItemMaster.GsGridControl1.AddGridviewFromDataview("ItemMaster","ItemMaster","ItemMaster")
Gui.FormItemMaster.GsGridControl1.SetGridviewProperty("ItemMaster","ReadOnly",True)
Gui.FormItemMaster.GsGridControl1.SetGridviewProperty("ItemMaster","Editable",False)
Gui.FormItemMaster.GsGridControl1.MainView("ItemMaster")

'creating context menu
Gui.In_Transit..ContextMenuCreate("DeletePart")
'adding the menu items
Gui.In_Transit..ContextMenuAddItem("DeletePart","Item 0",0)
Gui.In_Transit..ContextMenuAddItem("DeletePart","Item 1",0)
Gui.In_Transit..ContextMenuAddItem("DeletePart","Item 2",0)
Gui.In_Transit..ContextMenuAddItem("DeletePart","Item 3",0)
'setting item text
Gui.In_Transit..ContextMenuSetItemText("DeletePart","Item 0","Undo Scan")
Gui.In_Transit..ContextMenuSetItemText("DeletePart","Item 1","Swap Serial Number")
Gui.In_Transit..ContextMenuSetItemText("DeletePart","Item 2","Pick/Ship Qty")
Gui.In_Transit..ContextMenuSetItemText("DeletePart","Item 3","Remove Part")

'attaching menu to subroutine
Gui.In_Transit..ContextMenuSetItemEventHandler("DeletePart","Item 0",ReversePartEntry)
Gui.In_Transit..ContextMenuSetItemEventHandler("DeletePart","Item 1",ReversePartEntry)
Gui.In_Transit..ContextMenuSetItemEventHandler("DeletePart","Item 2",ReversePartEntry)
Gui.In_Transit..ContextMenuSetItemEventHandler("DeletePart","Item 3",ReversePartEntry)

'creating context menu
Gui.In_Transit..ContextMenuCreate("Qty")
'adding the menu items
Gui.In_Transit..ContextMenuAddItem("Qty","Item 0",0)
'setting item text
Gui.In_Transit..ContextMenuSetItemText("Qty","Item 0","View Part Quantities")
'attaching menu to subroutine
Gui.In_Transit..ContextMenuSetItemEventHandler("Qty","Item 0",ReversePartEntry)

'creating context menu
Gui.In_Transit..ContextMenuCreate("Remove")
'adding the menu items
Gui.In_Transit..ContextMenuAddItem("Remove","Item 0",0)
Gui.In_Transit..ContextMenuAddItem("Remove","Item 1",0)
Gui.In_Transit..ContextMenuAddItem("Remove","Item 2",0)
'setting item text
Gui.In_Transit..ContextMenuSetItemText("Remove","Item 0","Undo Scan")
Gui.In_Transit..ContextMenuSetItemText("Remove","Item 1","Pick/Ship Qty")
Gui.In_Transit..ContextMenuSetItemText("Remove","Item 2","Remove Part")
'attaching menu to subroutine
Gui.In_Transit..ContextMenuSetItemEventHandler("Remove","Item 0",ReversePartEntry)
Gui.In_Transit..ContextMenuSetItemEventHandler("Remove","Item 1",ReversePartEntry)
Gui.In_Transit..ContextMenuSetItemEventHandler("Remove","Item 2",ReversePartEntry)

Gui.In_Transit..Show

Gui.In_Transit..Enabled(False)

Gui.In_Transit.frame1.Anchor(13)
Gui.In_Transit.tab1.Anchor(15)
Gui.In_Transit.GsGridControlNew.Anchor(15)
Gui.In_Transit.GsGridControlRec.Anchor(15)
Gui.In_Transit.GsGridControlStage.Anchor(15)
Gui.In_Transit.cmdSave.Anchor(6)
Gui.In_Transit.txtNewPart.Anchor(6)
Gui.In_Transit.txtPartStage.Anchor(6)
Gui.In_Transit.cmdSetAll.Anchor(6)
Gui.In_Transit.lblNewPart.Anchor(6)
Gui.In_Transit.lblPart.Anchor(6)

Gui.BinToBin.cmdAutoToBin.Visible(False)
Gui.BinToBin.cmdSubmit.Enabled(False)

Gui.In_Transit..Enabled(True)

Gui.In_Transit.txtNum.SetFocus

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.In_Transit_UnLoad.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

F.ODBC.Connection!con.Close
F.Intrinsic.Control.End

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End

	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.In_Transit_UnLoad.End

Program.Sub.txtNum_GotFocus.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
	
Gui.In_Transit.txtNum.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.txtNum_GotFocus.End

Program.Sub.cmdNum_Click.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sSql.Declare(String,"")

F.Intrinsic.Control.SelectCase(V.Screen.In_Transit!tab1.Tab)
	F.Intrinsic.Control.Case(0)
		F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

		V.Local.sSql.Set("Select Order_No, Customer From V_Order_Header Order by Order_No") 
		V.Local.sTitles.Set("Order*!*Customer")
		V.Local.sWidths.Set("1800*!*6250")

		F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
		F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

		F.Intrinsic.UI.Browser("Select Sales Order","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)
		
		F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			Gui.In_Transit.txtNum.Text(V.Local.sRet.Trim)
	
			F.Intrinsic.Control.CallSub(Get_Data)

		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case(1)
		F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

		V.Local.sSql.Set("Select Distinct a.Order_NO, Customer From GCG_4552_Sales_Order a join GCG_4552_In_Transit b on a.order_No = b.order_no and a.record_No = b.record_No Where Rec_Type = 'T' Order by a.Order_No") 
		V.Local.sTitles.Set("Order*!*Customer")
		V.Local.sWidths.Set("1800*!*6250")

		F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
		F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

		F.Intrinsic.UI.Browser("Select Sales Order","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)
		
		F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			Gui.In_Transit.txtNum.Text(V.Local.sRet.Trim)
		
			F.Intrinsic.Control.CallSub(Get_Data)
		F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Case(2)
		F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

		V.Local.sSql.Set("Select Distinct a.Order_NO, Customer From GCG_4552_Sales_Order a join GCG_4552_In_Transit b on a.order_No = b.order_no and a.record_No = b.record_No Where Rec_Type = 'R' Order by a.Order_No") 
		V.Local.sTitles.Set("Order*!*Customer")
		V.Local.sWidths.Set("1800*!*6250")

		F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
		F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

		F.Intrinsic.UI.Browser("Select Sales Order","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)
		
		F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			Gui.In_Transit.txtNum.Text(V.Local.sRet.Trim)
	
			F.Intrinsic.Control.CallSub(Get_Data)
			
		F.Intrinsic.Control.EndIf
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.cmdNum_Click.End

Program.Sub.tab1_Click.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

F.Intrinsic.Control.BlockEvents

V.Global.iTab.Set(V.Screen.In_Transit!tab1.Tab)

Gui.In_Transit.txtNewPart.Text("")
Gui.In_Transit.txtNum.Text("")
Gui.In_Transit.txtOpenPart.Text("")
		
F.Intrinsic.Control.UnBlockEvents

Gui.In_Transit.txtNum.SetFocus
Gui.In_Transit.txtNum.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.tab1_Click.End

Program.Sub.Get_Data.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.iTransit.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.sStatus.Declare(String,"")
V.Local.sOrder.Declare(String,"")

F.Intrinsic.Control.If(V.DataTable.Change.Exists,=,True)
	F.Data.DataTable.Close("Change")
F.Intrinsic.Control.EndIf

V.Local.sOrder.Set(V.Screen.In_Transit!txtNum.Text)
F.Intrinsic.Control.If(V.Local.sOrder.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.LPad(V.Local.sOrder.Trim,"0",7,V.Local.sOrder)

Gui.In_Transit.txtNum.Text(V.Local.sOrder)

'checking and seeing if the sales order as changed
F.Intrinsic.String.Build("Select Order_No, Record_No, Reason, Delete_Order From GCG_4552_SO_CHANGE Where Order_No = '{0}' Order by Record_No",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
F.Data.DataTable.CreateFromSQL("Change","con",V.Local.sSql,True)

F.Intrinsic.Control.If(V.DataTable.Change.RowCount--,<>,-1)
	Gui.In_Transit.cmdupdate.Visible(True)
	F.Intrinsic.Control.If(V.DataTable.Change(V.DataTable.Change.RowCount--).Delete_Order!FieldVal,=,True)
		V.Local.sStatus.Set("Status: Sales Order has been deleted.")
		F.Intrinsic.Control.ExitFor(V.Local.i)
	F.Intrinsic.Control.Else
		V.Local.sStatus.Set("Status: Sales Order has change.")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

Gui.In_Transit.lblStatus.Caption(V.Local.sStatus)

F.Intrinsic.Control.SelectCase(V.Screen.In_Transit!tab1.Tab)
	F.Intrinsic.Control.Case(0)
		F.Intrinsic.String.Build("Select Distinct Order_No, Record_No, rtrim(Customer) as Customer, Name_Customer, a.Part, b.Description, ((Select sum(Quantity) From V_Item_Master c Where a.part = c.part and (bin not like 'XSH%' and bin not like 'HOLD%' and bin <> 'INTRAN')) - (Select Count(Qty_Required) From GCG_4552_IN_Transit Where Order_No = '{0}' and Record_No = a.Record_No)) as Qty_OnHand, a.Qty_Ordered, (a.Qty_Ordered - (Select Count(Qty_Required) From GCG_4552_IN_Transit Where Order_No = '{0}' and Record_No = a.Record_No)) as Qty_Required, (Select Count(Qty_Required) From GCG_4552_IN_Transit Where Order_No = '{0}' and Record_No = a.Record_No and (Rec_Type = '' or Rec_Type is null)) as Qty_Scanned, Flag_Bom From GCG_4552_Sales_Order a Left Join V_Inventory_Mstr b on a.Part = b.Part Where Order_No = '{0}' Order By Record_No",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
		
		F.Intrinsic.Control.If(V.DataTable.SO.Exists,=,True)
			F.Data.DataTable.Close("SO")
		F.Intrinsic.Control.EndIf
		
		'creating header table for sales order
		F.Data.DataTable.CreateFromSQL("SO","con",V.Local.sSql,True)
		
		F.Intrinsic.Control.If(V.DataTable.SO.RowCount--,=,-1)
			F.Intrinsic.String.Build("Select Distinct Order_No, Record_No, rtrim(Customer) as Customer, '' as Name_Customer, a.Part, b.Description, (Select sum(Quantity) From V_Item_Master c Where a.part = c.part and (bin not like 'XSH%' or bin not like 'HOLD%' and bin <> 'INTRAN')) as Qty_OnHand, a.Qty_Ordered, a.Qty_Ordered as Qty_Required, 0 as Qty_Scanned, Flag_Bom From V_Order_Lines a Left Join V_Inventory_Mstr b on a.Part = b.Part Where Order_No = '{0}' Order By Record_No",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
			F.Intrinsic.Control.If(V.DataTable.SO.Exists,=,True)
				F.Data.DataTable.Close("SO")
			F.Intrinsic.Control.EndIf
			
			'creating header table for sales order
			F.Data.DataTable.CreateFromSQL("SO","con",V.Local.sSql,True)
			F.Data.DataTable.FillFromDictionary("SO","CustName","Order_No","Name_Customer")
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.If(V.DataView.SO!SO.Exists,=,True)
			F.Data.DataView.Close("SO","SO")
		F.Intrinsic.Control.EndIf
			
		F.Data.DataView.Create("SO","SO")
		
		'getting lines
		F.Intrinsic.String.Build("Select Rec_No, Order_No, Record_No, Part, Description, Qty_Required, Qty_Scanned, Lot, Heat, Serial_Number, From_Bin, To_Bin, Rec_Type, Bom_Parent From GCG_4552_IN_TRANSIT Where Order_No = '{0}' and (Rec_Type = '' or Rec_Type is Null) Order By Record_No",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
		F.Intrinsic.Control.If(V.DataTable.SO$Line.Exists,=,True)
			F.Data.DataTable.Close("SO$Line")
		F.Intrinsic.Control.EndIf
		
		'creating header table for sales order
		F.Data.DataTable.CreateFromSQL("SO$Line","con",V.Local.sSql,True)
		
		F.Intrinsic.Control.If(V.DataView.SO$Line!Line.Exists,=,True)
			F.Data.DataView.Close("SO$Line","Line")
		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Create("SO$Line","Line")
		
		F.Intrinsic.Control.CallSub(SetProperties)
		
		Gui.In_Transit.GsGridControlNew.MainView("SO")
		
		F.Data.DataTable.SaveToDB("SO","con","GCG_4552_Sales_Order","Order_No*!*Record_NO",256,"Order_No@!@Order_No*!*Record_No@!@Record_No*!*Customer@!@Customer*!*Name_Customer@!@Name_Customer*!*Part@!@Part*!*Description@!@Description*!*Qty_Ordered@!@Qty_Ordered*!*Qty_Required@!@Qty_Required*!*Qty_Scanned@!@Qty_Scanned*!*Flag_Bom@!@Flag_Bom")
	
		F.Intrinsic.Control.For(V.Local.iTransit,0,V.DataTable.SO.RowCount--,1)
			Gui.In_Transit.GsGridControlNew.ExpandMasterRow("SO",V.Local.iTransit)
		F.Intrinsic.Control.Next(V.Local.iTransit)
		
		Gui.In_Transit.txtNewPart.SetFocus
		Gui.In_Transit.txtNewPart.SelectAll
		
	F.Intrinsic.Control.Case(1)
		F.Intrinsic.String.Build("Select Order_No, Record_No, rtrim(Customer) as Customer, Name_Customer, Part, Description, (Select if(Sum(Qty_Required) > 0,(Sum(Qty_Required) - Sum(Qty_Scanned)),.5) From GCG_4552_In_Transit b Where a.order_No = b.Order_No and a.Record_No = b.Record_No and b.Rec_Type = 'T' Group By Record_No) as Qty_Required, (Select if(Sum(Qty_Scanned) > 0,Sum(Qty_Scanned),0) From GCG_4552_In_Transit b Where a.order_No = b.Order_No and a.Record_No = b.Record_No and b.Rec_Type = 'T' Group By Record_No) as Qty_Scanned From GCG_4552_Sales_Order a Where Order_No = '{0}' and Record_No IN (Select Record_No From GCG_4552_In_Transit Where Order_No = '{0}' and Rec_Type = 'T') Order By Record_No",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
		F.Intrinsic.Control.If(V.DataTable.SORec.Exists,=,True)
			F.Data.DataTable.Close("SORec")
		F.Intrinsic.Control.EndIf
		
		'creating header table for sales order
		F.Data.DataTable.CreateFromSQL("SORec","con",V.Local.sSql,True)
		
		F.Intrinsic.Control.If(V.DataView.SORec!SORec.Exists,=,True)
			F.Data.DataView.Close("SORec","SORec")
		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Create("SORec","SORec")
		
		'getting lines
		F.Intrinsic.String.Build("Select Rec_No, Order_No, Record_No, Part, Description, Qty_Scanned, Lot, Heat, Serial_Number, if (To_Bin = 'INTRAN',To_Bin,From_Bin) as From_Bin, if (To_Bin <> 'INTRAN',To_Bin,'') as To_Bin, Rec_Type, Bom_Parent From GCG_4552_IN_TRANSIT a Where Order_No = '{0}' and Rec_Type = 'T' Order By Record_No",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
		F.Intrinsic.Control.If(V.DataTable.SORec$LineRec.Exists,=,True)
			F.Data.DataTable.Close("SORec$LineRec")
		F.Intrinsic.Control.EndIf
		
		'creating header table for sales order
		F.Data.DataTable.CreateFromSQL("SORec$LineRec","con",V.Local.sSql,True)
		
		F.Intrinsic.Control.If(V.DataView.SORec$LineRec!LineRec.Exists,=,True)
			F.Data.DataView.Close("SORec$LineRec","LineRec")
		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Create("SORec$LineRec","LineRec")
		
		F.Intrinsic.Control.CallSub(SetProperties)
		
		Gui.In_Transit.GsGridControlRec.MainView("SORec")
		
		F.Intrinsic.Control.For(V.Local.iTransit,0,V.DataTable.SORec.RowCount--,1)
			Gui.In_Transit.GsGridControlRec.ExpandMasterRow("SORec",V.Local.iTransit)
		F.Intrinsic.Control.Next(V.Local.iTransit)
		
	F.Intrinsic.Control.Case(2)	
		F.Intrinsic.String.Build("Select a.Order_No, a.Record_No, rtrim(Customer) as Customer, Name_Customer, Part, Description, Qty_Ordered, (Select if(Sum(Qty_Required) > 0,(Sum(Qty_Required) - Sum(Qty_Scanned)),.5) From GCG_4552_In_Transit b Where a.order_No = b.Order_No and a.Record_No = b.Record_No and b.Rec_Type = 'R' Group By Record_No) as Qty_Required, (Select if(Sum(Qty_Scanned) > 0,Sum(Qty_Scanned),0) From GCG_4552_In_Transit b Where a.order_No = b.Order_No and a.Record_No = b.Record_No and b.Rec_Type = 'R' Group By Record_No) as Qty_Scanned,Flag_Bom From GCG_4552_Sales_Order a Where a.Order_No = '{0}' and Record_No IN (Select Record_No From GCG_4552_In_Transit Where Order_No = '{0}' and Rec_Type = 'R') Order By a.Record_No",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
		F.Intrinsic.Control.If(V.DataTable.SOStage.Exists,=,True)
			F.Data.DataTable.Close("SOStage")
		F.Intrinsic.Control.EndIf
		
'		'creating header table for sales order
		F.Data.DataTable.CreateFromSQL("SOStage","con",V.Local.sSql,True)
		
		F.Data.DataView.Create("SOStage","Temp",22,"Qty_Required = .5","Record_No")
		
		F.Intrinsic.Control.For(V.Local.iTransit,0,V.DataView.SOStage!Temp.RowCount--,1)
			F.Data.DataView.SetValue("SOStage","Temp",V.Local.iTransit,"Qty_Required",V.DataView.SOStage!Temp(V.Local.iTransit).Qty_Ordered!FieldValTrim)
		F.Intrinsic.Control.Next(V.Local.iTransit)
		
		F.Intrinsic.Control.If(V.DataView.SOStage!SOStage.Exists,=,True)
			F.Data.DataView.Close("SOStage","SOStage")
		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Create("SOStage","SOStage")
		
		'getting lines
		F.Intrinsic.String.Build("Select Rec_No, Order_No, Record_No, Part, Description, Qty_Required, Qty_Scanned, Lot, Heat, Serial_Number, From_Bin, To_Bin, Rec_Type From GCG_4552_IN_TRANSIT Where Order_No = '{0}' and Rec_Type = 'R' Order By Record_No",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
		F.Intrinsic.Control.If(V.DataTable.SOStage$LineStage.Exists,=,True)
			F.Data.DataTable.Close("SOStage$LineStage")
		F.Intrinsic.Control.EndIf
		
		'creating header table for sales order
		F.Data.DataTable.CreateFromSQL("SOStage$LineStage","con",V.Local.sSql,True)
		
		F.Data.DataView.Create("SOStage$LineStage","LineStage")
		
		F.Intrinsic.Control.CallSub(SetProperties)
		
		Gui.In_Transit.GsGridControlStage.MainView("SOStage")
		
		F.Intrinsic.Control.For(V.Local.iTransit,0,V.DataTable.SOStage.RowCount--,1)
			Gui.In_Transit.GsGridControlStage.ExpandMasterRow("SOStage",V.Local.iTransit)
		F.Intrinsic.Control.Next(V.Local.iTransit)
		
		Gui.In_Transit.txtPartStage.SetFocus
		Gui.In_Transit.txtPartStage.SelectAll

F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.Get_Data.End

Program.Sub.SetProperties.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.iC.Declare(Long,0)
V.Local.sFromBin.Declare(String,"")
V.Local.sToBin.Declare(String,"")
V.Local.sFilter.Declare(String,"")

F.Data.Dictionary.ReturnAllPairs("FromBin",V.Local.sFromBin)
F.Data.Dictionary.ReturnAllPairs("ToBin",V.Local.sToBin)

F.Intrinsic.String.Split(V.Local.sFromBin,"!*!",V.Local.sFromBin)
F.Intrinsic.String.Split(V.Local.sToBin,"!*!",V.Local.sToBin)

'setting properites depending on the tab that's selected.
F.Intrinsic.Control.SelectCase(V.Screen.In_Transit!tab1.Tab)
	'new
	F.Intrinsic.Control.Case(0)	
		Gui.In_Transit.GsGridControlNew.AddGridviewFromDataview("SO","SO","SO")
		Gui.In_Transit.GsGridControlNew.AddGridviewFromDataview("Line","SO","Line")
		
		Gui.In_Transit.GsGridControlNew.AddRelation("SO","Line","Order_No*!*Record_No","Order_No*!*Record_No","SOLINES")
		
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Order_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Order_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Order_NO","Caption","Sales Order")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Flag_Bom","Visible",False)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Order_No","Visible",False)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Record_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Record_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Record_No","Caption","Sales Order Line")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Customer","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Customer","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Description","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Description","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Description","Caption","Description")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Customer","Visible",False)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Flag_Bom","Visible",False)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Name_Customer","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Name_Customer","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Name_Customer","Caption","Customer Name")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Part","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Part","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_OnHand","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_OnHand","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_OnHand","Caption","Qty OnHand")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Ordered","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Ordered","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Ordered","Caption","Qty Ordered")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Ordered","Visible",False)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Required","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Required","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Required","Caption","Qty Required")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Required","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Required","Caption","Qty Remaining")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Scanned","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Scanned","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Scanned","Caption","Qty Scannned")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Scanned","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_OnHand","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_OnHand","DisplayCustomNumeric","#0.00")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Ordered","DisplayCustomNumeric","#0.00")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Scanned","DisplayCustomNumeric","#0.00")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Required","DisplayCustomNumeric","#0.00")
		
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Order_No","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Flag_Bom","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Record_No","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Customer","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Description","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Name_Customer","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Part","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_OnHand","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Ordered","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Required","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Scanned","HeaderFontSize","14")
		
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Order_No","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Flag_Bom","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Record_No","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Customer","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Description","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Name_Customer","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Part","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_OnHand","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Ordered","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Required","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("SO","Qty_Scanned","HeaderWordWrap","Wrap")
		
		Gui.In_Transit.GsGridControlNew.SetGridviewProperty("SO","ColumnPanelRowHeight","30")
		Gui.In_Transit.GsGridControlNew.SetGridviewProperty("SO","OptionsViewRowAutoHeight",True)
			
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.SO.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.SO(V.Local.i).Flag_Bom!FieldValTrim,<>,"Y")
				F.Intrinsic.Control.If(V.DataTable.SO(V.Local.i).Qty_Required!FieldValFloat,=,0)
					F.Intrinsic.Control.For(V.Local.iC,0,9,1)
						Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.iC,V.Local.i,"BackColor","#64fd64")
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.If(V.DataTable.SO(V.Local.i).Qty_OnHand!FieldValFloat,<=,0)
						F.Intrinsic.Control.For(V.Local.iC,0,9,1)
							Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.iC,V.Local.i,"BackColor","#fd6464")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.For(V.Local.iC,0,9,1)
							Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",0,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",1,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",2,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",3,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",4,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",5,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",6,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",7,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",8,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",9,V.Local.i,"Halignment","far")
			
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",0,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",1,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",2,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",3,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",4,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",5,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",6,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",7,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",8,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",9,V.Local.i,"Fontsize","14")
			
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",0,V.Local.i,"wordwrap","Wrap")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",1,V.Local.i,"wordwrap","Wrap")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",2,V.Local.i,"wordwrap","Wrap")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",3,V.Local.i,"wordwrap","Wrap")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",4,V.Local.i,"wordwrap","Wrap")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",5,V.Local.i,"wordwrap","Wrap")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",6,V.Local.i,"wordwrap","Wrap")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",7,V.Local.i,"wordwrap","Wrap")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",8,V.Local.i,"wordwrap","Wrap")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",9,V.Local.i,"wordwrap","Wrap")
			
		F.Intrinsic.Control.Next(V.Local.i)
			
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Order_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Order_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Record_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Record_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Part","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Part","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Description","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Description","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Required","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Required","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Scanned","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Scanned","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","From_Bin","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","From_Bin","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Rec_NO","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Rec_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Rec_Type","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Rec_Type","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Rec_Type","Visible",False)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Order_NO","Caption","Sales Order")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","From_Bin","Caption","From Bin")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Part","Caption","Part")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Description","Caption","Description")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Record_NO","Caption","Sales Order Line")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Required","Caption","Qty Required")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Scanned","Caption","Qty Scanned")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Scanned","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Required","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Rec_No","Caption","Rec NO")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Order_NO","visible",False)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Part","visible",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Record_No","visible",False)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Scanned","DisplayCustomNumeric","#0.00")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Required","DisplayCustomNumeric","#0.00")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Rec_No","Visible",False)
		Gui.In_Transit.GsGridControlNew.ColumnEdit("Line","From_Bin","Combobox",V.Local.sFromBin(1))
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Order_No","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Order_No","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Record_No","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Record_No","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Part","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Part","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Description","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Description","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Required","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Required","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Scanned","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Qty_Scanned","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Rec_No","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Rec_No","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","From_Bin","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","From_Bin","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","To_Bin","Visible",False)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","To_Bin","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","To_Bin","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","To_Bin","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","To_Bin","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Serial_Number","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Serial_Number","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Serial_Number","Caption","Serial Number")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Serial_Number","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Serial_Number","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Lot","Visible",False)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Lot","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Lot","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Lot","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Lot","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Heat","Visible",False)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Heat","ReadOnly",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Heat","AllowEdit",True)
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Heat","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Heat","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlNew.SetColumnProperty("Line","Bom_Parent","Visible",False)
		
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.SO$Line.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.SO$Line(V.Local.i).Qty_Scanned!FieldValFloat,>,0)
				F.Intrinsic.Control.For(V.Local.iC,0,12,1)
					Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",V.Local.iC,V.Local.i,"BackColor","#64fd64")
				F.Intrinsic.Control.Next(V.Local.iC)
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.For(V.Local.iC,0,12,1)
					Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",V.Local.iC,V.Local.i,"BackColor","#fd6464")
				F.Intrinsic.Control.Next(V.Local.iC)
			F.Intrinsic.Control.EndIf
			
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",0,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",1,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",2,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",3,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",4,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",5,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",6,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",7,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",8,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",9,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",10,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",11,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",12,V.Local.i,"Halignment","near")
			
		F.Intrinsic.Control.Next(V.Local.i)
	
	'rec
	F.Intrinsic.Control.Case(1)
		Gui.In_Transit.GsGridControlRec.AddGridviewFromDataview("SORec","SORec","SORec")
		Gui.In_Transit.GsGridControlRec.AddGridviewFromDataview("LineRec","SORec","LineRec")
		
		Gui.In_Transit.GsGridControlRec.AddRelation("SORec","LineRec","Order_No*!*Record_No","Order_No*!*Record_No","SOLINES")
		
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Order_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Order_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Order_NO","Caption","Sales Order")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Order_NO","Visible",False)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Record_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Record_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Record_No","Caption","Sales Order Line")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Customer","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Customer","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Customer","Visible",False)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Name_Customer","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Name_Customer","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Name_Customer","Caption","Customer Name")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Part","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Part","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Description","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Description","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Description","Caption","Description")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Required","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Required","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Required","Caption","Qty Required")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Required","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Required","Caption","Qty Remaining")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Scanned","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Scanned","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Scanned","Caption","Qty Scannned")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Scanned","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Scanned","DisplayCustomNumeric","#0.00")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Required","DisplayCustomNumeric","#0.00")
		
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Order_No","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Record_No","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Customer","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Description","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Name_Customer","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Part","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Required","HeaderFontSize","14")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Scanned","HeaderFontSize","14")
		
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Order_No","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Record_No","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Customer","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Description","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Name_Customer","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Part","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Required","HeaderWordWrap","Wrap")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("SORec","Qty_Scanned","HeaderWordWrap","Wrap")
		
		Gui.In_Transit.GsGridControlRec.SetGridviewProperty("SORec","ColumnPanelRowHeight","30")
		Gui.In_Transit.GsGridControlRec.SetGridviewProperty("SORec","OptionsViewRowAutoHeight",True)

		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.SORec.RowCount--,1)
			F.Intrinsic.String.Build("Record_No = '{0}' and To_Bin = ''",V.DataTable.SORec(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.Create("SORec$LineRec","RecTemp")
			F.Data.DataView.Create("SORec$LineRec","TempRec")
			F.Data.DataView.SetFilter("SORec","RecTemp",V.Local.sFilter)
			F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SORec(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.SetFilter("SORec","TempRec",V.Local.sFilter)
			
			F.Intrinsic.Control.If(V.DataView.SORec$LineRec!RecTemp.RowCount--,=,-1)
				F.Intrinsic.Control.If(V.DataTable.SORec(V.Local.i).Qty_Required.FieldValFloat,=,0)
					F.Intrinsic.Control.For(V.Local.iC,0,7,1)
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#64fd64")
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"Fontsize","14")
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"wordWrap","Wrap")
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.For(V.Local.iC,0,7,1)
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"Fontsize","14")
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"wordWrap","Wrap")
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.DataView.SORec$LineRec!RecTemp.RowCount--,=,V.DataView.SORec$LineRec!TempRec.RowCount--)
					F.Intrinsic.Control.If(V.DataTable.SORec(V.Local.i).Qty_Scanned!FieldValTrim,=,0)
						F.Intrinsic.Control.For(V.Local.iC,0,7,1)
							Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#fd6464")
							Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"Fontsize","14")
							Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"wordWrap","Wrap")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.For(V.Local.iC,0,7,1)
							Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
							Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"Fontsize","14")
							Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"wordWrap","Wrap")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else		
					F.Intrinsic.Control.For(V.Local.iC,0,7,1)
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"Fontsize","14")
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"wordWrap","Wrap")
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		
			F.Data.DataView.Close("SORec$LineRec","RecTemp")
			F.Data.DataView.Close("SORec$LineRec","TempRec")
		F.Intrinsic.Control.Next(V.Local.i)
		
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Order_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Order_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Record_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Record_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Part","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Part","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Description","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Description","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Qty_Scanned","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Qty_Scanned","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","From_Bin","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","From_Bin","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Rec_NO","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Rec_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Rec_Type","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Rec_Type","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Rec_Type","Visible",False)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Order_NO","Caption","Sales Order")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Record_NO","Caption","Sales Order Line")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","From_Bin","Caption","From Bin")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","To_Bin","Caption","To Bin")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Qty_Scanned","Caption","Qty Scanned")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Qty_Scanned","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Rec_No","Caption","Rec NO")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Order_NO","visible",False)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Part","visible",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Record_No","visible",False)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Qty_Scanned","DisplayCustomNumeric","#0.00")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Rec_No","Visible",False)
		Gui.In_Transit.GsGridControlRec.ColumnEdit("LineRec","To_Bin","Combobox",V.Local.sToBin(1))
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Order_No","ReadOnly",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Order_No","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Record_No","ReadOnly",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Record_No","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Part","ReadOnly",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Part","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Description","ReadOnly",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Description","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Qty_Scanned","ReadOnly",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Qty_Scanned","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Rec_No","ReadOnly",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Rec_No","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","From_Bin","ReadOnly",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","From_Bin","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","To_Bin","Visible",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","To_Bin","ReadOnly",False)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","To_Bin","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","To_Bin","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","To_Bin","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","From_Bin","Visible",False)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","From_Bin","ReadOnly",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","From_Bin","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Serial_Number","Caption","Serial Number")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Serial_Number","ReadOnly",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Serial_Number","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Serial_Number","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Serial_Number","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Lot","Visible",False)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Lot","ReadOnly",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Lot","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Lot","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Lot","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Heat","Visible",False)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Heat","ReadOnly",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Heat","AllowEdit",True)
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Heat","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Heat","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlRec.SetColumnProperty("LineRec","Bom_Parent","Visible",False)
		
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.SORec$LineRec.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.SORec$LineRec(V.Local.i).Qty_Scanned!FieldValLong,>,0)
				F.Intrinsic.Control.If(V.DataTable.SORec$LineRec(V.Local.i).To_Bin!FieldValTrim,<>,"")
					F.Intrinsic.Control.For(V.Local.iC,0,12,1)
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",V.Local.iC,V.Local.i,"BackColor","#64fd64")
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.For(V.Local.iC,0,12,1)
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.DataTable.SORec$LineRec(V.Local.i).To_Bin!FieldValTrim,<>,"")
					F.Intrinsic.Control.For(V.Local.iC,0,12,1)
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.For(V.Local.iC,0,12,1)
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",V.Local.iC,V.Local.i,"BackColor","#fd6464")
					F.Intrinsic.Control.Next(V.Local.iC)		
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf

			Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",5,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",6,V.Local.i,"Halignment","far")

		F.Intrinsic.Control.Next(v.Local.i)
		
	'stage
	F.Intrinsic.Control.Case(2)		
		Gui.In_Transit.GsGridControlStage.AddGridviewFromDataview("SOStage","SOStage","SOStage")
		Gui.In_Transit.GsGridControlStage.AddGridviewFromDataview("LineStage","SOStage","LineStage")
		
		Gui.In_Transit.GsGridControlStage.AddRelation("SOStage","LineStage","Order_No*!*Record_No","Order_No*!*Record_No","SOLINES")
		
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Order_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Order_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Order_NO","Caption","Sales Order")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Order_No","Visible",False)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Record_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Record_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Record_No","Caption","Sales Order Line")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Customer","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Customer","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Customer","Visible",False)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Name_Customer","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Name_Customer","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Name_Customer","Caption","Customer Name")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Part","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Part","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Ordered","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Ordered","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Ordered","Caption","Qty Ordered")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Ordered","Visible",False)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Flag_Bom","Visible",False)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Required","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Required","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Required","Caption","Qty Required")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Required","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Required","Caption","Qty Remaining")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Scanned","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Scanned","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Scanned","Caption","Qty Scannned")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Scanned","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Description","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Description","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Description","Caption","Description")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Ordered","DisplayCustomNumeric","#0.00")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Scanned","DisplayCustomNumeric","#0.00")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Required","DisplayCustomNumeric","#0.00")

		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Order_No","HeaderFontSize","18")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Record_No","HeaderFontSize","18")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Customer","HeaderFontSize","18")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Description","HeaderFontSize","18")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Name_Customer","HeaderFontSize","18")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Flag_Bom","HeaderFontSize","18")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Part","HeaderFontSize","18")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Ordered","HeaderFontSize","18")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Required","HeaderFontSize","18")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("SOStage","Qty_Scanned","HeaderFontSize","18")
		Gui.In_Transit.GsGridControlStage.SetGridviewProperty("SOStage","ColumnPanelRowHeight","16")
		Gui.In_Transit.GsGridControlStage.SetGridviewProperty("SOStage","OptionsViewRowAutoHeight",True)
		
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.SOStage.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.SOStage(V.Local.i).Flag_Bom!FieldValTrim,<>,"Y")
				F.Intrinsic.Control.If(V.DataTable.SOStage(V.Local.i).Qty_Required!FieldValFloat,=,0)
					F.Intrinsic.Control.For(V.Local.iC,0,9,1)
						Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",V.Local.iC,V.Local.i,"BackColor","#64fd64")
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.If(V.DataTable.SOStage(V.Local.i).Qty_Scanned!FieldValTrim,=,0)
						F.Intrinsic.Control.For(V.Local.iC,0,9,1)
							Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",V.Local.iC,V.Local.i,"BackColor","#fd6464")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.For(V.Local.iC,0,9,1)
							Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",0,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",1,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",2,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",3,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",4,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",5,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",6,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",7,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",8,V.Local.i,"Halignment","far")
			
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",0,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",1,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",2,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",3,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",4,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",5,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",6,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",7,V.Local.i,"Fontsize","14")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",8,V.Local.i,"Fontsize","14")
			
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",0,V.Local.i,"wordWrap","Wrap")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",1,V.Local.i,"wordWrap","Wrap")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",2,V.Local.i,"wordWrap","Wrap")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",3,V.Local.i,"wordWrap","Wrap")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",4,V.Local.i,"wordWrap","Wrap")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",5,V.Local.i,"wordWrap","Wrap")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",6,V.Local.i,"wordWrap","Wrap")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",7,V.Local.i,"wordWrap","Wrap")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",8,V.Local.i,"wordWrap","Wrap")
		
		F.Intrinsic.Control.Next(V.Local.i)
			
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Order_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Order_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Record_No","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Record_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Part","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Part","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Description","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Description","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Required","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Required","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Scanned","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Scanned","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","From_Bin","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","From_Bin","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Rec_NO","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Rec_No","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Rec_Type","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Rec_Type","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Rec_Type","Visible",False)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Order_NO","Caption","Sales Order")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Record_NO","Caption","Sales Order Line")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Required","Caption","Qty Required")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Scanned","Caption","Qty Scanned")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Scanned","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Required","HeaderHAlignment","far")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Rec_No","Caption","Rec NO")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Order_NO","visible",False)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Part","visible",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Record_No","visible",False)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Scanned","DisplayCustomNumeric","#0.00")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Required","DisplayCustomNumeric","#0.00")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Rec_No","Visible",False)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Order_No","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Order_No","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Record_No","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Record_No","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Part","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Part","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Description","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Description","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Required","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Required","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Scanned","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Qty_Scanned","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Rec_No","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Rec_No","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","From_Bin","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","From_Bin","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","From_Bin","Caption","From Bin")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","From_Bin","Visible",False)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","From_Bin","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","From_Bin","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","To_Bin","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","To_Bin","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","To_Bin","Caption","Bin")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","To_Bin","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","To_Bin","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Serial_Number","Caption","Serial Number")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Serial_Number","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Serial_Number","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Serial_Number","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Serial_Number","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Lot","Visible",False)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Lot","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Lot","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Lot","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Lot","HeaderForeColor","White")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Heat","Visible",False)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Heat","ReadOnly",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Heat","AllowEdit",True)
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Heat","HeaderBackColor","Green")
		Gui.In_Transit.GsGridControlStage.SetColumnProperty("LineStage","Heat","HeaderForeColor","White")
		
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.SOStage$LineStage.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.SOStage$LineStage(V.Local.i).Qty_Scanned!FieldValFloat,>,0)
				F.Intrinsic.Control.For(V.Local.iC,0,12,1)
					Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",V.Local.iC,V.Local.i,"BackColor","#64fd64")
				F.Intrinsic.Control.Next(V.Local.iC)
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.For(V.Local.iC,0,12,1)
					Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",V.Local.iC,V.Local.i,"BackColor","#fd6464")
				F.Intrinsic.Control.Next(V.Local.iC)
			F.Intrinsic.Control.EndIf
			
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",0,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",1,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",2,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",3,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",4,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",5,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",6,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",7,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",8,V.Local.i,"Halignment","far")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",9,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",10,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",11,V.Local.i,"Halignment","near")
			Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",12,V.Local.i,"Halignment","near")
			
		F.Intrinsic.Control.Next(V.Local.i)
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.SetProperties.End

Program.Sub.ScanPart.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.iC.Declare(Long,0)
V.Local.fQty.Declare(Float,0)
V.Local.sPart.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.iRec.Declare(Long,0)
V.Local.sDes.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.sBomParent.Declare(String,"")
V.Local.sRecord.Declare(String,"")
V.Local.iIndex.Declare(Long,0)
V.Local.bFound.Declare(Boolean,False)

F.Intrinsic.UI.InvokeWaitDialog("Processing Scaned Part.............","Processing")

F.Intrinsic.Control.SelectCase(V.Screen.In_Transit!tab1.Tab)
	F.Intrinsic.Control.Case(0)	
		Gui.In_Transit..Visible(False)
		Gui.In_Transit.txtNewPart.Enabled(False)
		Gui.In_Transit.GsGridControlNew.Enabled(False)
		Gui.In_Transit..Enabled(False)
		
		'spliting the scanned part to get acual part number
		V.Local.sPart.Set(V.Screen.In_Transit!txtNewPart.Text)
		V.Local.sPart.Set(V.Local.sPart.UCase)
		Gui.In_Transit.txtNewPart.Text(V.Local.sPart.Trim)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.SO.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.SO(V.Local.i).Part!FieldValTrim,=,V.Local.sPart)
				F.Intrinsic.Control.If(V.DataTable.SO(V.Local.i).Flag_Bom!FieldValTrim,=,"Y")
					Gui.In_Transit.txtNewPart.Enabled(True)
					Gui.In_Transit.GsGridControlNew.Enabled(True)
					Gui.In_Transit..Enabled(True)
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.Control.If(V.DataTable.SO(V.Local.i).Qty_Required!FieldValFloat,>,0)
					F.Intrinsic.String.Build("Select Description From Inventory_Mstr Where Part = '{0}'",V.DataTable.SO(V.Local.i).Part!FieldValTrim,V.Local.sSql)
					F.Data.DataTable.CreateFromSQL("Des","con",V.Local.sSql,True)
					
					F.Intrinsic.Control.If(V.DataTable.Des.RowCount--,<>,-1)
						V.Local.sDes.Set(V.DataTable.Des(V.DataTable.Des.RowCount--).Description!FieldValTrim)
					F.Intrinsic.Control.EndIf
					
					F.Data.DataTable.Close("Des")
					
					F.Intrinsic.String.Build("Select Distinct Lot, Bin, Heat, Serial_Number, Quantity From V_Item_Master Where Quantity >= {0} and Part = '{1}' and Bin <> 'INTRAN' and (Heat = '' or Heat is null)",1,V.DataTable.SO(V.Local.i).Part!FieldValTrim,V.Local.sSql) 
					V.Local.sTitles.Set("Lot*!*Bin*!*Heat*!*Serial*!*Quantity")
					V.Local.sWidths.Set("1800*!*1800*!*1800*!*6250*!*1800")

					F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
					F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)
					
					F.Intrinsic.Control.If(V.DataTable.BinTemp.Exists,=,True)
						F.Data.DataTable.Close("BinTemp")
					F.Intrinsic.Control.EndIf
					
					V.Local.bFound.Set(True)
					
					F.Data.DataTable.CreateFromSQL("BinTemp","con",V.Local.sSql,True)
					F.Intrinsic.Control.If(V.DataTable.BinTemp.RowCount--,=,-1)
						F.Intrinsic.String.Build("No Qty Available for Part {0}",V.DataTable.SO(V.Local.i).Part!FieldValTrim,V.Local.sSql)
						F.Intrinsic.UI.Msgbox(V.Local.sSql,"Warning")
						F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.Next(V.Local.i)
					F.Intrinsic.Control.EndIf
	
					F.Data.DataView.Create("BinTemp","Temp")
	
					F.Intrinsic.Control.If(V.DataTable.SO$Line.Exists,=,True)
						F.Intrinsic.Control.For(V.Local.iC,0,V.DataTable.SO$Line.RowCount--,1)
							F.Intrinsic.String.Build("Select Bom_Parent From V_Order_Lines Where Order_No = '{0}' and Record_No = '{1}'",V.DataTable.SO$Line(V.Local.iC).Order_No!FieldValTrim,V.DataTable.SO$Line(V.Local.iC).Record_NO!FieldValTrim,V.Local.sSql)
							F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sBomParent)
						F.Intrinsic.Control.Next(V.Local.iC)
						
					F.Intrinsic.Control.EndIf
		
					F.Intrinsic.Control.If(V.DataView.BinTemp!Temp.RowCount--,=,0)
						
						F.ODBC.Connection!con.GetID("GCG_4552_In_Transit","Rec_No",True,V.Local.iRec)
						F.Data.DataTable.AddRow("SO$Line","Rec_No",V.Local.iRec,"Order_No",V.DataTable.SO(V.Local.i).Order_No!FieldValTrim,"Record_No",V.DataTable.SO(V.Local.i).Record_No!FieldValTrim,"Part",V.DataTable.SO(V.Local.i).Part!FieldValTrim,"Description",V.Local.sDes,"Qty_Required",1,"Qty_Scanned",1,"From_Bin",V.DataTable.BinTemp(V.DataTable.BinTemp.RowCount--).Bin!FieldValTrim,"Heat",V.DataTable.BinTemp(V.DataTable.BinTemp.RowCount--).Heat!FieldValTrim,"Lot",V.DataTable.BinTemp(V.DataTable.BinTemp.RowCount--).Lot!FieldValTrim,"Serial_Number",V.DataTable.BinTemp(V.DataTable.BinTemp.RowCount--).Serial_Number!FieldValTrim)
					F.Intrinsic.Control.Else							
							F.ODBC.Connection!con.GetID("GCG_4552_In_Transit","Rec_No",True,V.Local.iRec)
							
							Gui.Form_BinSelect.GsGridControlScanBin.AddGridviewFromDataview("BinTemp","BinTemp","Temp")
							Gui.Form_BinSelect.GsGridControlScanBin.MainView("BinTemp")
							Gui.Form_BinSelect..Show
							F.Intrinsic.Control.CallSub(WaitForDismiss,"Screen","BinSelect")
							F.Intrinsic.Control.If(V.DataView.BinTemp!Temp.RowCount--,=,0)
								F.Data.DataTable.AddRow("SO$Line","Rec_No",V.Local.iRec,"Order_No",V.DataTable.SO(V.Local.i).Order_No!FieldValTrim,"Record_No",V.DataTable.SO(V.Local.i).Record_No!FieldValTrim,"Part",V.DataTable.SO(V.Local.i).Part!FieldValTrim,"Description",V.Local.sDes,"Qty_Required",1,"Qty_Scanned",1,"From_Bin",V.DataView.BinTemp!Temp(V.DataView.BinTemp!Temp.RowCount--).Bin!FieldValTrim,"Heat",V.DataView.BinTemp!Temp(V.DataView.BinTemp!Temp.RowCount--).Heat!FieldValTrim,"Lot",V.DataView.BinTemp!Temp(V.DataView.BinTemp!Temp.RowCount--).Lot!FieldValTrim,"Serial_Number",V.DataView.BinTemp!Temp(V.DataView.BinTemp!Temp.RowCount--).Serial_Number!FieldValTrim)
							F.Intrinsic.Control.Else
								Gui.In_Transit.txtNewPart.Enabled(True)
								Gui.In_Transit.GsGridControlNew.Enabled(True)
								Gui.In_Transit..Enabled(True)
								F.Intrinsic.Control.ExitSub
							F.Intrinsic.Control.EndIf

					F.Intrinsic.Control.EndIf
					F.Data.DataTable.Close("BinTemp")
					
					V.Local.fQty.Set(V.DataTable.SO(V.Local.i).Qty_Scanned!FieldValFloat)
					F.Intrinsic.Math.Add(V.Local.fQty,1,V.Local.fQty)
					F.Data.DataTable.SetValue("SO",V.Local.i,"Qty_Scanned",V.Local.fQty)
					F.Intrinsic.Math.Sub(V.DataTable.SO(V.Local.i).Qty_Required!FieldValFloat,1,V.Local.fQty)
					F.Data.DataTable.SetValue("SO",V.Local.i,"Qty_Required",V.Local.fQty)
					F.Intrinsic.Math.Sub(V.DataTable.SO(V.Local.i).Qty_OnHand!FieldValFloat,1,V.Local.fQty)
					F.Data.DataTable.SetValue("SO",V.Local.i,"Qty_OnHand",V.Local.fQty)
					
					Gui.In_Transit.GsGridControlNew.SuspendLayout()
					
					F.Intrinsic.Control.If(V.DataTable.SO(V.Local.i).Flag_Bom!FieldValTrim,<>,"Y")
						F.Intrinsic.Control.If(V.DataTable.SO(V.Local.i).Qty_Required!FieldValFloat,=,0)
							F.Intrinsic.Control.For(V.Local.iC,0,9,1)
								Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.iC,V.Local.i,"BackColor","#64fd64")
							F.Intrinsic.Control.Next(V.Local.iC)
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.DataTable.SO(V.Local.i).Qty_OnHand!FieldValFloat,<=,0)
								F.Intrinsic.Control.For(V.Local.iC,0,9,1)
									Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.iC,V.Local.i,"BackColor","#fd6464")
								F.Intrinsic.Control.Next(V.Local.iC)
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.For(V.Local.iC,0,9,1)
									Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
								F.Intrinsic.Control.Next(V.Local.iC)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
					
					
					F.Intrinsic.Control.For(V.Local.iC,0,12,1)
						Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",V.Local.iC,V.DataTable.SO$Line.RowCount--,"BackColor","#64fd64")
					F.Intrinsic.Control.Next(V.Local.iC)
					
					Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",5,V.DataTable.SO$Line.RowCount--,"Halignment","far")
					Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",6,V.DataTable.SO$Line.RowCount--,"Halignment","far")
					Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",7,V.DataTable.SO$Line.RowCount--,"Halignment","far")
					Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",8,V.DataTable.SO$Line.RowCount--,"Halignment","far")
					
					Gui.In_Transit.GsGridControlNew.ResumeLayout()
					
					Gui.In_Transit.GsGridControlNew.ExpandMasterRow("SO",V.Local.i)
					
					F.Intrinsic.Control.ExitFor(V.Local.i)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
		
		'saving everytime to incase user looses connection
		F.Data.DataTable.SaveToDB("SO","con","GCG_4552_Sales_Order","Order_No*!*Record_NO",256,"Order_No@!@Order_No*!*Record_No@!@Record_No*!*Customer@!@Customer*!*Part@!@Part*!*Qty_Ordered@!@Qty_Ordered*!*Qty_Required@!@Qty_Required*!*Qty_Scanned@!@Qty_Scanned")
		F.Data.DataTable.SaveToDB("SO$Line","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*Order_No@!@Order_No*!*Record_No@!@Record_No*!*Part@!@Part*!*Description@!@Description*!*Qty_Required@!@Qty_Required*!*Qty_Scanned@!@Qty_Scanned*!*From_Bin@!@From_Bin*!*To_Bin@!@To_Bin*!*Lot@!@Lot*!*Heat@!@Heat*!*Serial_Number@!@Serial_Number*!*Rec_Type@!@Rec_Type")
		
		Gui.In_Transit.txtNewPart.Enabled(True)
		Gui.In_Transit.GsGridControlNew.Enabled(True)
		Gui.In_Transit..Enabled(True)
		Gui.In_Transit.txtNewPart.SetFocus
		Gui.In_Transit.txtNewPart.SelectAll
		
		F.Intrinsic.Control.If(V.Local.bFound,=,False)
			F.Intrinsic.UI.PlaySound(V.Global.sBadScan)
			F.Intrinsic.UI.SleepMS(250)
			F.Intrinsic.UI.PlaySound(V.Global.sBadScan)
		F.Intrinsic.Control.Else
			F.Intrinsic.UI.PlaySound(V.Global.sGoodScan)
		F.Intrinsic.Control.EndIf
		
		Gui.In_Transit..Visible(True)
		
	F.Intrinsic.Control.Case(1)	
		Gui.In_Transit..Visible(False)
		Gui.In_Transit.txtRecPart.Enabled(False)
		Gui.In_Transit.GsGridControlRec.Enabled(False)
		Gui.In_Transit..Enabled(False)
		
		V.Local.sPart.Set(V.Screen.In_Transit!txtRecPart.Text)
		V.Local.sPart.Set(V.Local.sPart.UCase)
		Gui.In_Transit.txtRecPart.Text(V.Local.sPart.Trim)
		Gui.In_Transit.GsGridControlRec.SuspendLayout()
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.SORec$LineRec.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.SORec$LineRec(V.Local.i).Part!FieldValTrim,=,V.Local.sPart.Trim)
				F.Intrinsic.Control.If(V.DataTable.SORec$LineRec(V.Local.i).Qty_Scanned!FieldValFloat,=,0)	
					V.Local.bFound.Set(True)
					
					F.Data.DataTable.SetValue("SORec$LineRec",V.Local.i,"Qty_Scanned",1)
					F.Intrinsic.Control.If(V.DataTable.SORec$LineRec(V.Local.i).To_Bin!FieldValTrim,<>,"")
						F.Intrinsic.Control.For(V.Local.iC,0,12,1)
							Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",V.Local.iC,V.Local.i,"BackColor","#64fd64")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.For(V.Local.iC,0,12,1)
							Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
					v.Local.iIndex.Set(v.Local.i)
					F.Intrinsic.Control.ExitFor(V.Local.i)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
		
		F.Intrinsic.Control.If(V.Local.bFound,=,True)
			F.Intrinsic.Control.For(V.Local.iC,0,V.DataTable.SORec.RowCount--,1)
				F.Intrinsic.Control.If(V.DataTable.SORec(V.Local.iC).Record_No!FieldValTrim,=,V.DataTable.SORec$LineRec(V.Local.iIndex).Record_No!FieldValTrim)
					F.Intrinsic.Control.If(V.DataTable.SORec(V.Local.ic).Qty_Required!FieldValFloat,>=,0)
						V.Local.sRecord.Set(V.DataTable.SORec(V.Local.iC).Record_No!FieldValTrim)
						F.Intrinsic.Math.Add(V.DataTable.SORec(V.Local.iC).Qty_Scanned!FieldValFloat,1,V.Local.i)
						F.Data.DataTable.SetValue("SORec",V.Local.iC,"Qty_Scanned",V.Local.i)
						F.Intrinsic.Math.Sub(V.DataTable.SORec(V.Local.iC).Qty_Required!FieldValFloat,1,V.Local.i)
						F.Data.DataTable.SetValue("SORec",V.Local.iC,"Qty_Required",V.Local.i)
						F.Intrinsic.Control.ExitFor(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iC)
		
			F.Intrinsic.String.Build("Record_No = '{0}'",V.Local.sRecord,V.Local.sFilter)
	
			F.Intrinsic.Control.If(V.DataView.SORec!RecTemp.Exists)
				F.Data.DataView.Close("SOREC","RecTemp")
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Create("SOREC","RecTemp")
			F.Data.DataView.SetFilter("SOREC","RecTemp",V.Local.sFilter)
			
			V.Local.i.Set(V.DataView.SORec!RecTemp(V.DataView.SORec!RecTemp.RowCount--).DataTableIndex)
			
			F.Data.DataView.Close("SORec","RecTemp")
			
			F.Intrinsic.String.Build("Record_No = '{0}' and To_Bin = ''",V.Local.sRecord,V.Local.sFilter)
			F.Intrinsic.Control.If(V.DataView.SORec$LineRec!RecTemp.Exists)
				F.Data.DataView.Close("SORec$LineRec","RecTemp")
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.DataView.SORec$LineRec!TempRec.Exists)
				F.Data.DataView.Close("SORec$LineRec","TempRec")
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Create("SORec$LineRec","RecTemp")
			F.Data.DataView.Create("SORec$LineRec","TempRec")
			F.Data.DataView.SetFilter("SORec","RecTemp",V.Local.sFilter)
			F.Intrinsic.String.Build("Record_No = '{0}'",V.Local.sRecord,V.Local.sFilter)
			F.Data.DataView.SetFilter("SORec","TempRec",V.Local.sFilter)
			
			F.Intrinsic.Control.If(V.DataView.SORec$LineRec!RecTemp.RowCount--,=,-1)
				F.Intrinsic.Control.If(V.DataTable.SORec(V.Local.i).Qty_Required.FieldValFloat,=,0)
					F.Intrinsic.Control.For(V.Local.iC,0,7,1)
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#64fd64")
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.For(V.Local.iC,0,7,1)
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.DataView.SORec$LineRec!RecTemp.RowCount--,=,V.DataView.SORec$LineRec!TempRec.RowCount--)
					F.Intrinsic.Control.If(V.DataTable.SORec(V.Local.i).Qty_Scanned!FieldValTrim,=,0)
						F.Intrinsic.Control.For(V.Local.iC,0,7,1)
							Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#fd6464")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.For(V.Local.iC,0,7,1)
							Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else		
					F.Intrinsic.Control.For(V.Local.iC,0,7,1)
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			
			F.Data.DataView.Close("SORec$LineRec","RecTemp")
			F.Data.DataView.Close("SORec$LineRec","TempRec")
		
			Gui.In_Transit.GsGridControlRec.ResumeLayout()
			
			F.Data.DataTable.SaveToDB("SORec$LineRec","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*Order_No@!@Order_No*!*Record_No@!@Record_No*!*Part@!@Part*!*Description@!@Description*!*Qty_Scanned@!@Qty_Scanned*!*From_Bin@!@From_Bin*!*To_Bin@!@To_Bin*!*Rec_Type@!@Rec_Type")
		F.Intrinsic.Control.EndIf
		
		Gui.In_Transit.txtRecPart.Enabled(True)
		Gui.In_Transit.GsGridControlRec.Enabled(True)
		
		F.Intrinsic.Control.If(V.Local.bFound,=,False)
			F.Intrinsic.UI.PlaySound(V.Global.sBadScan)
			F.Intrinsic.UI.SleepMS(250)
			F.Intrinsic.UI.PlaySound(V.Global.sBadScan)
		F.Intrinsic.Control.Else
			F.Intrinsic.UI.PlaySound(V.Global.sGoodScan)
		F.Intrinsic.Control.EndIf
		
		Gui.In_Transit..Visible(True)
		Gui.In_Transit..Enabled(True)
		Gui.In_Transit.txtRecPart.SetFocus
		Gui.In_Transit.txtRecPart.SelectAll
		
	F.Intrinsic.Control.Case(2)	
		Gui.In_Transit..Visible(False)
		Gui.In_Transit.txtPartStage.Enabled(False)
		Gui.In_Transit.GsGridControlStage.Enabled(False)
		
		V.Local.sPart.Set(V.Screen.In_Transit!txtPartStage.Text)
		V.Local.sPart.Set(V.Local.sPart.UCase)
		Gui.In_Transit.txtPartStage.Text(V.Local.sPart.Trim)
		F.Data.DataView.Create("SOStage$LineStage","PartScan")
		F.Intrinsic.String.Build("Part = '{0}'",V.Local.sPart.Trim,V.Local.sFilter)
		F.Data.DataView.SetFilter("SOStage","PartScan",V.Local.sFilter)
		
		F.Intrinsic.Control.For(V.Local.i,0,V.DataView.SOStage$LineStage!PartScan.RowCount--,1)
			Gui.In_Transit.GsGridControlStage.SuspendLayout()
			F.Intrinsic.Control.If(V.DataView.SOStage$LineStage!PartScan(V.Local.i).Part!FieldValTrim,=,V.Local.sPart.Trim)
				F.Intrinsic.Control.If(V.DataView.SOStage$LineStage!PartScan(V.Local.i).Qty_Scanned!FieldValFloat,=,0)	

					V.Local.bFound.Set(True)
					
					F.Data.DataView.SetValue("SOStage$LineStage","PartScan",V.Local.i,"Qty_Scanned",1)
					F.Intrinsic.Control.For(V.Local.iC,0,12,1)
						V.Local.iIndex.Set(V.DataView.SOStage$LineStage!PartScan(V.Local.i).DataTableIndex)
						Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",V.Local.iC,V.Local.iIndex,"BackColor","#64fd64")
					F.Intrinsic.Control.Next(V.Local.iC)
'					V.Local.iIndex.Set(V.Local.i)
					F.Intrinsic.Control.ExitFor(V.Local.i)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
		
		F.Data.DataView.Close("SOStage$LineStage","PartScan")
		
		F.Intrinsic.Control.For(V.Local.iC,0,V.DataTable.SOStage.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.SOStage(V.Local.iC).Record_No!FieldValTrim,=,V.DataTable.SOStage$LineStage(V.Local.iIndex).Record_No!FieldValTrim)
				V.Local.i.Set(V.Local.iC)
				F.Intrinsic.Math.Add(V.DataTable.SOStage(V.Local.i).Qty_Scanned!FieldValFloat,1,V.Local.iC)
				F.Data.DataTable.SetValue("SOStage",V.Local.i,"Qty_Scanned",V.Local.iC)
				F.Intrinsic.Math.Sub(V.DataTable.SOStage(V.Local.i).Qty_Required!FieldValFloat,1,V.Local.iC)
				F.Data.DataTable.SetValue("SOStage",V.Local.i,"Qty_Required",V.Local.iC)
				F.Intrinsic.Control.ExitFor(V.Local.iC)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iC)
		
		F.Intrinsic.Control.If(V.DataTable.SOStage(V.Local.i).Qty_Required.FieldValFloat,=,0)
			F.Intrinsic.Control.For(V.Local.iC,0,9,1)
				Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",V.Local.iC,V.Local.i,"BackColor","#64fd64")
			F.Intrinsic.Control.Next(V.Local.iC)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.DataTable.SOStage(V.Local.i).Qty_Scanned!FieldValTrim,=,0)
				F.Intrinsic.Control.For(V.Local.iC,0,9,1)
					Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",V.Local.iC,V.Local.i,"BackColor","#fd6464")
				F.Intrinsic.Control.Next(V.Local.iC)
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.For(V.Local.iC,0,9,1)
					Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
				F.Intrinsic.Control.Next(V.Local.iC)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		Gui.In_Transit.GsGridControlStage.ResumeLayout()
		
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.SOStage$LineStage.RowCount--,1)
            F.Intrinsic.Control.If(V.DataTable.SOStage$LineStage(V.Local.i).Part!FieldValTrim,=,V.Local.sPart.Trim)
				F.Intrinsic.Control.If(V.DataTable.SOStage$LineStage(V.Local.i).Qty_Scanned!FieldValFloat,>,0)
					F.Data.DataTable.SaveToDB("SOStage$LineStage","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*Order_No@!@Order_No*!*Record_No@!@Record_No*!*Part@!@Part*!*Description@!@Description*!*Qty_Required@!@Qty_Required*!*Qty_Scanned@!@Qty_Scanned*!*From_Bin@!@From_Bin*!*To_Bin@!@To_Bin*!*Rec_Type@!@Rec_Type")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
		
		Gui.In_Transit.txtPartStage.Enabled(True)
		Gui.In_Transit.GsGridControlStage.Enabled(True)
		Gui.In_Transit.txtPartStage.SetFocus
		Gui.In_Transit.txtPartStage.SelectAll
	
		F.Intrinsic.Control.If(V.Local.bFound,=,False)
			F.Intrinsic.UI.PlaySound(V.Global.sBadScan)
			F.Intrinsic.UI.SleepMS(250)
			F.Intrinsic.UI.PlaySound(V.Global.sBadScan)
		F.Intrinsic.Control.Else
			F.Intrinsic.UI.PlaySound(V.Global.sGoodScan)
		F.Intrinsic.Control.EndIf
		
		Gui.In_Transit..Visible(True)
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.UI.CloseWaitDialog

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.ScanPart.End

Program.Sub.txtNum_KeyPressEnter.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.sTemp.Declare(String,"")

Gui.In_Transit..Enabled(False)
F.Intrinsic.Control.CallSub(Get_Data)
Gui.In_Transit..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.txtNum_KeyPressEnter.End

Program.Sub.cmdSave_Click.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.iTransit.Declare(Long,0)
V.Local.sParams.Declare(String,"")
V.Local.sFile.Declare(String,"")
V.Local.sText.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sFqn.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sRev.Declare(String,"")
V.Local.sOrderNo.Declare(String,"")
V.Local.sOrderLine.Declare(String,"")
V.Local.fQty.Declare(Float,0)
V.Local.sQty.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.iC.Declare(Long,0)
V.Local.sHeat.Declare(String,"")
V.Local.sStop.Declare(String,"")
V.Local.iUser.Declare(Long,0)
V.Local.sTransID.Declare(String,"")
V.Local.sPack.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.bNew.Declare(Boolean,False)
V.Local.iRet.Declare(Long,0)

F.Intrinsic.UI.InvokeWaitDialog("Saving.....")

F.Intrinsic.Control.SelectCase(V.Screen.In_Transit!tab1.Tab)
	F.Intrinsic.Control.Case(0)
		Gui.In_Transit..Enabled(False)
		F.Intrinsic.Control.If(V.DataView.SORec$LineRec!Temp.Exists,=,True)
			F.Data.DataView.Close("SO$Line","Temp")
		F.Intrinsic.Control.EndIf
		V.Local.sOrderNo.Set(V.DataTable.SO(V.DataTable.SO.RowCount--).Order_No!FieldValTrim)
		F.Intrinsic.Control.If(V.DataView.SO$Line!Temp.Exists,=,True)
			F.Data.DataView.Close("SO$Line","Temp")
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Create("SO$Line","Temp",22,"","Record_No")
		F.Intrinsic.Control.If(V.DataView.SO$Line!Temp.RowCount--,<>,-1)
			F.Intrinsic.Control.If(V.DataTable.SOTEMP.Exists,=,True)
				F.Data.DataTable.Close("SOTemp")
			F.Intrinsic.Control.EndIf
			F.Data.DataView.ToDataTable("SO","Temp","SOTemp")
			F.Intrinsic.Control.If(V.DataTable.TEMP.Exists,=,True)
				F.Data.DataTable.Close("Temp")
			F.Intrinsic.Control.EndIf
			F.Data.DataView.ToDataTableDistinct("SO","Temp","Temp","Part*!*Lot*!*From_Bin*!*To_Bin*!*Heat*!*Serial_Number",True)
			F.Intrinsic.Control.For(V.Local.iTransit,0,V.DataTable.Temp.RowCount--,1)
				'creating temp datatble for qty, loc, lot, heat, serial for bin selected
				F.Intrinsic.String.Build("Select Quantity, Location, Lot, Heat, Serial_Number From V_Item_Master Where Part = '{0}' and Bin = '{1}' and Lot = '{2}' and Heat = '{3}' and Serial_Number = '{4}'",V.DataTable.Temp(V.Local.iTransit).Part!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).From_Bin!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Lot!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Heat!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Serial_Number!FieldValTrim,V.Local.sSql)
				
				F.Intrinsic.Control.If(V.DataTable.Item.Exists,=,True)
					F.Data.DataTable.Close("Item")
				F.Intrinsic.Control.EndIf
				
				F.Data.DataTable.CreateFromSQL("Item","con",V.Local.sSql,True)
				
				F.Intrinsic.Control.If(V.DataTable.Item.RowCount--,<>,-1)
					F.Intrinsic.String.Build("(Lot = '{0}' or Lot is Null) and From_Bin = '{1}' and (Heat = '{2}' or Heat is Null) and (Serial_Number = '{3}' or Serial_Number is Null) and Part = '{4}' and Qty_Scanned = 1",V.DataTable.Temp(V.Local.iTransit).Lot!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).From_Bin!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Heat!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Serial_Number!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Part!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.Create("SO$Line","Bin",22,V.Local.sFilter,"Record_No")
					F.Intrinsic.Control.For(V.Local.iC,0,V.DataView.SO$Line!Bin.RowCount--,1)
						F.Intrinsic.Math.Add(V.Local.fQty,V.DataView.SO$Line!Bin(V.Local.iC).Qty_Scanned!FieldValFloat,V.Local.fQty)
					F.Intrinsic.Control.Next(V.Local.iC)
	
					F.Intrinsic.Control.If(V.Local.fQty,>,0)
						F.Intrinsic.Control.If(V.DataTable.Item(V.DataTable.Item.RowCount--).Quantity!FieldValFloat,>=,V.Local.fQty)
							
							F.Data.DataView.SetValue("SO$Line","Bin",-1,"To_Bin","INTRAN")
							F.Data.DataView.SetValue("SO$Line","Bin",-1,"Rec_Type","T")
							F.Data.DataView.SetValue("SO$Line","Bin",-1,"Qty_Scanned",0)
							
							V.Local.sTemp.Redim(0,13)
							'part
							V.Local.sTemp(0).Set(V.DataTable.Temp(V.Local.iTransit).Part!FieldValTrim)
							f.Intrinsic.String.RPad(v.Local.sTemp(0)," ",20,v.Local.sTemp(0))
							
							'loc
							V.Local.sTemp(1).set(V.DataTable.Item(V.DataTable.Item.RowCount--).Location!FieldValTrim)
							'transfer qty
							V.Local.sTemp(2).Set(V.Local.fQty)
							'from bin
							V.Local.sTemp(3).Set(V.DataTable.Temp(V.Local.iTransit).From_Bin!FieldValTrim)
							'to bin
							V.Local.sTemp(4).Set("INTRAN")
							'lot
							V.Local.sTemp(5).Set(V.DataTable.Temp(V.Local.iTransit).Lot!FieldValTrim)
							'heat
							V.Local.sTemp(6).Set(V.DataTable.Temp(V.Local.iTransit).Heat!FieldValTrim)
							'serial
							V.Local.sTemp(7).Set(V.DataTable.Temp(V.Local.iTransit).Serial_Number!FieldValTrim)
							V.Local.sTemp(8).Set("")
							V.Local.sTemp(9).Set("")
							'to loc
							V.Local.sTemp(10).Set(V.DataTable.Item(V.DataTable.Item.RowCount--).Location!FieldValTrim)
							V.Local.sTemp(11).Set("Y")
							V.Local.sTemp(12).Set(V.Caller.User)
							V.Local.sTemp(13).Set(V.Ambient.Date.formatYYYYMMDD)
							
							V.Local.fQty.Set(0)
							
							F.Intrinsic.String.Build("{0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13}",V.Local.sTemp(0),V.Local.sTemp(1),V.Local.sTemp(2),V.Local.sTemp(3),V.Local.sTemp(4),V.Local.sTemp(5),V.Local.sTemp(6),V.Local.sTemp(7),V.Local.sTemp(8),V.Local.sTemp(9),V.Local.sTemp(10),V.Local.sTemp(11),V.Local.sTemp(12),V.Local.sTemp(13),V.Local.sTemp)
							F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sText,V.Local.sTemp,V.Ambient.NewLine,V.Local.sText)
						
						F.Intrinsic.Control.Else
							F.Data.DataView.SetValue("SO$Line","Temp",V.Local.iTransit,"From_Bin","")
							F.Data.DataView.SetValue("SO$Line","Temp",V.Local.iTransit,"Rec_Type","")
						F.Intrinsic.Control.EndIf	
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				
				V.Local.fQty.Set(0)
				
				F.Intrinsic.Control.If(V.DataView.SO$Line!Bin.Exists,=,True)
					F.Data.DataView.Close("SO$Line","Bin")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.DataTable.Item.Exists,=,True)
					F.Data.DataTable.Close("Item")
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.Next(V.Local.iTransit)
			
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.If(V.Local.sText.Length,>,0)
			'accu
			F.Intrinsic.String.Build("0{0}{1}BIN2BINTRNS",V.Caller.CompanyCode,V.Caller.Terminal,V.Local.sFile)
			F.Intrinsic.String.Build("{0}\{1}",V.Caller.FilesDir,V.Local.sFile,V.Local.sFqn)
			F.Intrinsic.File.String2File(V.Local.sFqn,V.Local.sText)
	
			F.Intrinsic.String.Build("{0}\{1}4552.stop",V.Caller.FilesDir,V.Caller.Terminal,V.Local.sStop)
			F.Intrinsic.File.String2File(V.Local.sStop,"Stop")
			F.Intrinsic.Task.LaunchGSSSync("LOT054UP","-c",V.Local.sFile)	
			F.Intrinsic.File.DeleteFile(V.Local.sStop)
		F.Intrinsic.Control.EndIf
		
		F.ODBC.Connection!con.Execute(V.Local.sSql)
	
		F.Data.DataTable.SaveToDB("SO","con","GCG_4552_Sales_Order","Order_No*!*Record_NO",256,"Order_No@!@Order_No*!*Record_No@!@Record_No*!*Customer@!@Customer*!*Name_Customer@!@Name_Customer*!*Part@!@Part*!*Qty_Ordered@!@Qty_Ordered*!*Qty_Required@!@Qty_Required*!*Qty_Scanned@!@Qty_Scanned*!*Flag_Bom@!@Flag_Bom")
		F.Data.DataTable.SaveToDB("SO$Line","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*Order_No@!@Order_No*!*Record_No@!@Record_No*!*Part@!@Part*!*Description@!@Description*!*Qty_Required@!@Qty_Required*!*Qty_Scanned@!@Qty_Scanned*!*From_Bin@!@From_Bin*!*To_Bin@!@To_Bin*!*Lot@!@Lot*!*Heat@!@Heat*!*Serial_Number@!@Serial_Number*!*Rec_Type@!@Rec_Type*!*Bom_Parent@!@Bom_Parent")
		
		F.Intrinsic.Control.For(V.Local.iTransit,V.DataTable.SO$Line.RowCount--,0,-1)
			F.Intrinsic.Control.If(V.DataTable.SO$Line(V.Local.iTransit).Rec_Type!FieldValTrim,=,"T")
				F.Data.DataTable.DeleteRow("SO$Line",V.Local.iTransit)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iTransit)
		
		F.Intrinsic.Control.If(V.DataView.SO$Line!Temp.Exists,=,True)
			F.Data.DataView.Close("SO$Line","Temp")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataTable.SO$Line.Exists,=,True)
			F.Data.DataTable.Close("SO$Line")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataTable.SO.Exists,=,True)
			F.Data.DataTable.Close("SO")
		F.Intrinsic.Control.EndIf
		
		Gui.In_Transit.txtNum.Text(V.Local.sOrderNo)
		F.Intrinsic.Control.CallSub(Get_Data)
		Gui.In_Transit..Enabled(True)
	F.Intrinsic.Control.Case(1)	
		Gui.In_Transit..Enabled(False)
		F.Data.DataTable.AcceptChanges("SORec$LineRec")
		F.Intrinsic.Control.If(V.DataView.SORec$LineRec!Temp.Exists,=,True)
			F.Data.DataView.Close("SORec$LineRec","Temp")
		F.Intrinsic.Control.EndIf
		V.Local.sOrderNo.Set(V.DataTable.SORec(V.DataTable.SORec.RowCount--).Order_No!FieldValTrim)
		F.Intrinsic.Control.If(V.DataView.SORec$LineRec!Temp.Exists,=,True)
			F.Data.DataView.Close("SORec$LineRec","Temp")
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Create("SORec$LineRec","Temp",22,"","Record_No")
		F.Intrinsic.Control.If(V.DataView.SORec$LineRec!Temp.RowCount--,<>,-1)
			F.Intrinsic.Control.If(V.DataTable.SOTemp.Exists,=,True)
				F.Data.DataTable.Close("SOTemp")
			F.Intrinsic.Control.EndIf
			F.Data.DataView.ToDataTable("SORec","Temp","SOTemp")
			F.Intrinsic.Control.If(V.DataTable.Temp.Exists,=,True)
				F.Data.DataTable.Close("Temp")
			F.Intrinsic.Control.EndIf
			F.Data.DataView.ToDataTableDistinct("SORec","Temp","Temp","Part*!*Lot*!*From_Bin*!*To_Bin*!*Heat*!*Serial_Number",True)
			F.Intrinsic.Control.For(V.Local.iTransit,0,V.DataTable.Temp.RowCount--,1)
				F.Intrinsic.Control.If(V.DataTable.Temp(V.Local.iTransit).To_Bin!FieldValTrim,<>,"")
					'creating temp datatble for qty, loc, lot, heat, serial for bin selected
					F.Intrinsic.String.Build("Select Quantity, Location, Lot, Heat, Serial_Number From V_Item_Master Where Part = '{0}' and Bin = '{1}' and Lot = '{2}' and Heat = '{3}' and Serial_Number = '{4}'",V.DataTable.Temp(V.Local.iTransit).Part!FieldValTrim,"INTRAN",V.DataTable.Temp(V.Local.iTransit).Lot!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Heat!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Serial_Number!FieldValTrim,V.Local.sSql)
					
					F.Intrinsic.Control.If(V.DataTable.Item.Exists,=,True)
						F.Data.DataTable.Close("Item")
					F.Intrinsic.Control.EndIf
				
					F.Data.DataTable.CreateFromSQL("Item","con",V.Local.sSql,True)
					
					F.Intrinsic.Control.If(V.DataTable.Item.RowCount--,<>,-1)
						F.Intrinsic.String.Build("Part = '{0}' and (Lot = '{1}' or Lot is Null) and (Heat = '{2}' or Heat is Null) and (Serial_Number = '{3}' or Serial_Number is Null) and Part = '{4}' and Rec_Type = 'T' and (To_Bin = '{5}') and Qty_Scanned = 1",V.DataTable.Temp(V.Local.iTransit).Part!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Lot!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Heat!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Serial_Number!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).Part!FieldValTrim,V.DataTable.Temp(V.Local.iTransit).To_Bin!FieldValTrim,V.Local.sFilter)
						F.Intrinsic.Control.If(V.DataView.SORec$LineRec!Bin.Exists,=,True)
							F.Data.DataView.Close("SORec$LineRec","Bin")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("SORec$LineRec","Bin",22,V.Local.sFilter,"Record_No")
						
						V.Local.fQty.Set(0)
						
						F.Intrinsic.Control.For(V.Local.iC,0,V.DataView.SORec$LineRec!Bin.RowCount--,1)
							F.Intrinsic.Math.Add(V.Local.fQty,V.DataView.SORec$LineRec!Bin(V.Local.iC).Qty_Scanned!FieldValFloat,V.Local.fQty)
						F.Intrinsic.Control.Next(V.Local.iC)
						
						F.Intrinsic.Control.If(V.Local.fQty,>,0)
							F.Intrinsic.Control.If(V.DataTable.Item(V.DataTable.Item.RowCount--).Quantity!FieldValFloat,>=,V.Local.fQty)
				
								V.Local.sTemp.Redim(0,13)
								'part
								V.Local.sTemp(0).Set(V.DataTable.Temp(V.Local.iTransit).Part!FieldValTrim)
								f.Intrinsic.String.RPad(v.Local.sTemp(0)," ",20,v.Local.sTemp(0))
								'loc
								V.Local.sTemp(1).set(V.DataTable.Item(V.DataTable.Item.RowCount--).Location!FieldVal)
								'transfer qty
								V.Local.sTemp(2).Set(V.Local.fQty)
								'from bin
								V.Local.sTemp(3).Set("INTRAN")
								'to bin
								V.Local.sTemp(4).Set(V.DataTable.Temp(V.Local.iTransit).To_Bin!FieldValTrim)
								'lot
								V.Local.sTemp(5).Set(V.DataTable.Temp(V.Local.iTransit).Lot!FieldValTrim)
								'heat
								V.Local.sTemp(6).Set("")
								'serial
								V.Local.sTemp(7).Set(V.DataTable.Temp(V.Local.iTransit).Serial_Number!FieldValTrim)
								V.Local.sTemp(8).Set("")
								V.Local.sTemp(9).Set("")
								'to loc
								V.Local.sTemp(10).Set(V.DataTable.Item(V.DataTable.Item.RowCount--).Location!FieldValTrim)
								V.Local.sTemp(11).Set("Y")
								V.Local.sTemp(12).Set(V.Caller.User)
								V.Local.sTemp(13).Set(V.Ambient.Date.formatYYYYMMDD)
								
								V.Local.fQty.Set(0)
						
								F.Intrinsic.String.Build("{0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13}",V.Local.sTemp(0),V.Local.sTemp(1),V.Local.sTemp(2),V.Local.sTemp(3),V.Local.sTemp(4),V.Local.sTemp(5),V.Local.sTemp(6),V.Local.sTemp(7),V.Local.sTemp(8),V.Local.sTemp(9),V.Local.sTemp(10),V.Local.sTemp(11),V.Local.sTemp(12),V.Local.sTemp(13),V.Local.sTemp)
								F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sText,V.Local.sTemp,V.Ambient.NewLine,V.Local.sText)
								
								F.Data.DataView.SetValue("SORec$LineRec","Bin",-1,"Rec_Type","R")
								
								F.Intrinsic.String.Build("Part = '{0}' and  Rec_Type = 'R'",V.DataTable.Temp(V.Local.iTransit).Part!FieldValTrim,V.Local.sFilter)
								F.Intrinsic.Control.If(V.DataView.SORec$LineRec!Bin.Exists,=,True)
									F.Data.DataView.Close("SORec$LineRec","Bin")
								F.Intrinsic.Control.EndIf
								F.Data.DataView.Create("SORec$LineRec","Bin",22,V.Local.sFilter,"Record_No")
								
								F.Data.DataView.SetValue("SORec$LineRec","Bin",-1,"Qty_Scanned","0")

							F.Intrinsic.Control.Else
								F.Data.DataView.SetValue("SORec$LineRec","Bin",-1,"To_Bin","")
							F.Intrinsic.Control.EndIf
						
							F.Data.DataView.Close("SORec$LineRec","Bin")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.Control.If(V.DataTable.Item.Exists,=,True)
					F.Data.DataTable.Close("Item")
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.Next(V.Local.iTransit)
			
			F.Data.DataTable.Close("Temp")
		
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.If(V.Local.sText.Length,>,0)
			F.Intrinsic.String.Build("0{0}{1}BIN2BINTRNS",V.Caller.CompanyCode,V.Caller.Terminal,V.Local.sFile)
			F.Intrinsic.String.Build("{0}\{1}",V.Caller.FilesDir,V.Local.sFile,V.Local.sFqn)
			F.Intrinsic.File.String2File(V.Local.sFqn,V.Local.sText)
			
			F.Intrinsic.String.Build("{0}\{1}4552.stop",V.Caller.FilesDir,V.Caller.Terminal,V.Local.sStop)
			F.Intrinsic.File.String2File(V.Local.sStop,"Stop")
			F.Intrinsic.Task.LaunchGSSSync("LOT054UP","-c",V.Local.sFile)
			F.Intrinsic.File.DeleteFile(V.Local.sStop)
		
		F.Intrinsic.Control.EndIf
		
		F.Data.DataTable.SaveToDB("SORec$LineRec","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*Order_No@!@Order_No*!*Record_No@!@Record_No*!*Part@!@Part*!*Description@!@Description*!*Qty_Scanned@!@Qty_Scanned*!*From_Bin@!@From_Bin*!*To_Bin@!@To_Bin*!*Rec_Type@!@Rec_Type")

		F.Data.DataView.Close("SORec$LineRec","Temp")
		F.Data.DataTable.Close("SOTemp")
		F.Data.DataTable.Close("SORec$LineRec")
		F.Data.DataTable.Close("SORec")
		
		Gui.In_Transit.txtNum.Text(V.Local.sOrderNo)
		F.Intrinsic.Control.CallSub(Get_Data)
		Gui.In_Transit..Enabled(True)
		
	F.Intrinsic.Control.Case(2)	
		Gui.In_Transit..Enabled(False)
		F.Intrinsic.String.Build("Select USER_ID From X_Lock_File Where Company = '{0}' and Rec_Key = '{1}'",V.Caller.CompanyCode,V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
		F.Intrinsic.Control.If(V.DataTable.Lock.Exists,=,True)
			F.Data.DataTable.Close("Lock")
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.CreateFromSQL("Lock","con",V.Local.sSql,True)
		
		F.Intrinsic.Control.If(V.DataTable.Lock.RowCount--,<>,-1)
			F.Intrinsic.String.Build("Sales Order {0} is Locked by User:{1}",V.Screen.In_Transit!txtNum.Text,V.DataTable.Lock(V.DataTable.Lock.RowCount--).User_ID!FieldValTrim,V.Local.sFilter)
			F.Intrinsic.UI.Msgbox(V.Local.sFilter,"Warning")
			F.Intrinsic.UI.CloseWaitDialog
			Gui.In_Transit..Enabled(True)
			F.Intrinsic.Control.ExitSub
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.If(V.DataView.SOStage$LineStage!Temp.Exists,=,True)
			F.Data.DataView.Close("SOStage$LineStage","Temp")
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Create("SOStage$LineStage","Temp",22,"","Record_No")
		F.Intrinsic.Control.If(V.DataView.SOStage$LineStage!Temp.RowCount--,<>,-1)	
			F.Intrinsic.Control.If(V.DataTable.BinTemp.SOTemp.Exists,=,True)
				F.Data.DataTable.Close("SOTemp")
			F.Intrinsic.Control.EndIf
			F.Data.DataView.ToDataTable("SOStage","Temp","SOTemp")
	
			F.Intrinsic.String.Build("Qty_Scanned > 0","",V.Local.sFilter)
			F.Intrinsic.Control.If(V.DataView.SOStage$LineStage!Bin.Exists,=,True)
				F.Data.DataView.Close("SOStage$LineStage","Bin")
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Create("SOStage$LineStage","Bin",22,V.Local.sFilter,"Record_No")
			F.Intrinsic.Control.For(V.Local.iC,0,V.DataView.SOStage$LineStage!Bin.RowCount--,1)
					F.Data.DataView.SetValue("SOStage$LineStage","Bin",V.Local.iC,"Rec_Type","S")
					F.Intrinsic.String.RPad(V.DataView.SOStage$LineStage!Bin(V.Local.iC).Part!FieldValTrim," ",20,V.Local.sPart)
					F.Intrinsic.String.Right(V.Local.sPart,3,V.Local.sRev)
					F.Intrinsic.String.Left(V.Local.sPart,17,V.Local.sPart)
					F.Intrinsic.String.Left(V.DataView.SOStage$LineStage!Bin(V.Local.iC).Record_No!FieldValTrim,3,V.Local.sOrderLine)
					F.Intrinsic.String.Left(V.DataView.SOStage$LineStage!Bin(V.Local.iC).Order_No!FieldValTrim,7,V.Local.sOrderNo)
					
					'creating temp datatble for qty, loc, lot, heat, serial for bin selected
					F.Intrinsic.String.Build("Select Quantity, Location, Lot, Heat, Serial_Number From V_Item_Master Where Part = '{0}' and Bin = '{1}' and Lot = '{2}' and Heat = '{3}' and Serial_Number = '{4}'",V.DataView.SOStage$LineStage!Bin(V.Local.iC).Part!FieldValTrim,V.DataView.SOStage$LineStage!Bin(V.Local.iC).To_Bin!FieldValTrim,V.DataView.SOStage$LineStage!Bin(V.Local.iC).Lot!FieldValTrim,V.DataView.SOStage$LineStage!Bin(V.Local.iC).Heat!FieldValTrim,V.DataView.SOStage$LineStage!Bin(V.Local.iC).Serial_Number!FieldValTrim,V.Local.sSql)
					
					F.Intrinsic.Control.If(V.DataTable.Item.Exists,=,True)
						F.Data.DataTable.Close("Item")
					F.Intrinsic.Control.EndIf
				
					F.Data.DataTable.CreateFromSQL("Item","con",V.Local.sSql,True)
					
					F.Intrinsic.Control.If(V.DataTable.Item.RowCount--,=,-1)
						F.Intrinsic.String.Build("Part: {0} Bin: {1} Lot: {2} Heat: {3} Serial_Number: {4} doesn't have an Item Master Record",V.DataView.SOStage$LineStage!Bin(V.Local.iC).Part!FieldValTrim,V.DataView.SOStage$LineStage!Bin(V.Local.iC).To_Bin!FieldValTrim,V.DataView.SOStage$LineStage!Bin(V.Local.iC).Lot!FieldValTrim,V.DataView.SOStage$LineStage!Bin(V.Local.iC).Heat!FieldValTrim,V.DataView.SOStage$LineStage!Bin(V.Local.iC).Serial_Number!FieldValTrim,V.Local.sSql)
						F.Intrinsic.UI.Msgbox(V.Local.sSql)
						F.Data.DataView.SetValue("SOStage$LineStage","Bin",V.Local.iC,"Rec_Type","R")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
					
					F.ODBC.Connection!con.OpenLocalRecordSetRW("wir","Select * From Wireless_Line")
					F.Intrinsic.Control.If(V.ODBC.con!wir.EOF,=,True)
						V.Local.iUser.Set(0)
					F.Intrinsic.Control.Else
						F.ODBC.Connection!con.GetID("Wireless_Line","Trans_ID",True,V.Local.iUser)
					F.Intrinsic.Control.EndIf
					
					F.ODBC.con!wir.AddNew
					F.Intrinsic.String.LPad(V.Local.iUser,"0",9,V.Local.sTransID)
					F.ODBC.con!wir.Set!TRANS_ID(V.Local.sTransID)
					F.ODBC.con!wir.Set!SEQ("0000")
					F.ODBC.con!wir.Set!TRANS_TYPE("S10")
					'packing list number
					'check existing
					'giving time for pervasive to populate staging orders table.
					F.Intrinsic.Control.If(V.Local.sPack.Length,=,0)
						f.Intrinsic.String.Build("select pck_no from v_staging_orders where order_no = '{0}'",V.Local.sOrderNo,v.Local.sSql)
						f.ODBC.Connection!con.executeandreturn(v.Local.sSql,v.Local.sRet)
					F.Intrinsic.Control.EndIf
					
					f.Intrinsic.Control.If(v.Local.sRet.Length,>,0)
    					v.Local.sPack.Set(v.Local.sRet)
    					v.Local.bNew.Set(False)
					f.Intrinsic.Control.Else
    					f.Global.General.ReadOption("401060",3,1,v.Local.iRet)
    					f.Intrinsic.String.LPad(v.Local.iRet,"0",7,v.Local.sRet)
    					v.Local.sPack.Set(v.Local.sRet)
    					v.Local.bNew.Set(True)
    					'update the company option
   		 				f.Intrinsic.Math.Add(v.Local.iRet,2,v.local.iRet)
    					Function.Global.General.SaveOption("401060","0000","", "", "", "", "","",v.Local.iRet)
					f.Intrinsic.Control.Endif
					F.Intrinsic.String.Build("Select Top 1 Field_1, Field_11 From Wireless_Line Where Field_2 = '{0}'",V.Local.sOrderNo,V.Local.sSql)
					F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sSql)
					F.Intrinsic.Control.If(V.Local.sSql.Length,>,0)
						F.Intrinsic.String.Split(V.Local.sSql,"*!*",V.Local.sTemp)
						F.ODBC.con!wir.Set!FIELD_1(V.Local.sPack)
						'pallet #
						F.Intrinsic.String.LPad(V.Local.sTemp(1),"0",8,V.Local.sTemp(1))
						F.ODBC.con!wir.Set!FIELD_11(V.Local.sTemp(1))
					F.Intrinsic.Control.Else
						F.ODBC.con!wir.Set!FIELD_1(V.Local.sPack)
						'pallet #
						F.ODBC.Connection!con.GetID("Wireless_Line","FIELD_11",True,V.Local.iUser)
						F.Intrinsic.String.LPad(V.Local.iUser,"0",8,V.Local.sTemp)
						F.ODBC.con!wir.Set!FIELD_11(V.Local.sTemp)
					F.Intrinsic.Control.EndIf
					'Order No
					F.ODBC.con!wir.Set!FIELD_2(V.Local.sOrderNo)
					'Order line
					F.ODBC.con!wir.Set!FIELD_3(V.Local.sOrderLine)
					'Part
					F.ODBC.con!wir.Set!FIELD_4(V.DataView.SOStage$LineStage!Bin(V.Local.iC).Part!FieldValTrim)
					'Loc
					F.ODBC.con!wir.Set!FIELD_5(V.DataTable.Item(V.DataTable.Item.RowCount--).Location!FieldValTrim)
					'Lot
					F.ODBC.con!wir.Set!FIELD_6(V.DataView.SOStage$LineStage!Bin(V.Local.iC).Lot!FieldValTrim)
					'Bin
					F.ODBC.con!wir.Set!FIELD_7(V.DataView.SOStage$LineStage!Bin(V.Local.iC).To_Bin!FieldValTrim)
					'Heat
					F.ODBC.con!wir.Set!FIELD_8(V.DataView.SOStage$LineStage!Bin(V.Local.iC).Heat!FieldValTrim)
					'Serial
					F.ODBC.con!wir.Set!FIELD_9(V.DataView.SOStage$LineStage!Bin(V.Local.iC).Serial_Number!FieldValTrim)
					'each indvidual part will have its own carton
					F.Intrinsic.String.Build("Select Top 1 Field_10 From Wireless_Line Where Field_2 = '{0}' Order by Field_10 Desc",V.Local.sOrderNo,V.Local.sSql)
					F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sSql)
					F.Intrinsic.Math.Add(V.Local.sSql.Long,1,V.Local.sSql)
					F.Intrinsic.String.LPad(V.Local.sSql,"0",8,V.Local.sSql)
					F.ODBC.con!wir.Set!FIELD_10(V.Local.sSql) 
					'Pallet codel
					F.ODBC.con!wir.Set!FIELD_13("") 
					'Qty (in container)
					F.ODBC.con!wir.Set!FIELD_14("1")
					'part weight per piece
					F.ODBC.con!wir.Set!FIELD_15("")
					'pallet weight
					F.ODBC.con!wir.Set!FIELD_18("") 
					'saving key value from custom table for to remove the part if needed.
					F.ODBC.con!wir.Set!FIELD_21(V.DataView.SOStage$LineStage!Bin(V.Local.iC).Rec_No!FieldVal)
					'print qyt
					F.ODBC.con!wir.Set!FIELD_24(0)
					'print labels
					F.ODBC.con!wir.Set!FIELD_25("N")
					F.ODBC.con!wir.Set!ERROR_ID(0)
					F.ODBC.con!wir.Update
					F.ODBC.con!wir.Close
					
					F.ODBC.Connection!con.OpenLocalRecordSetRW("rstNew","SELECT * from WIRELESS_HDR")
					F.ODBC.con!rstNew.AddNew
					F.ODBC.con!rstNew.Set!TRANS_ID(V.Local.sTransID)
					F.ODBC.con!rstNew.Set!TRANS_TYPE("S10")
					F.ODBC.con!rstNew.Set!ATTEMPTED_DATE("00000000")
					F.ODBC.con!rstNew.Set!ATTEMPTED_TIME("00000000")
					F.ODBC.con!rstNew.Set!LABEL_PRINTER("")
					F.Global.Security.GetUserId(V.Caller.User,V.Caller.CompanyCode,V.Local.iUser)
					F.ODBC.con!rstNew.Set!USER_ID(V.Local.iUser)
					F.ODBC.con!rstNew.Set!BATCH(0)
					F.ODBC.con!rstNew.Update
					F.ODBC.con!rstNew.Close
				F.Intrinsic.Control.Next(V.Local.iC)
				
				F.Data.DataView.Close("SOStage$LineStage","Bin")
				F.Data.DataTable.Close("Item")
				
			F.Intrinsic.Control.Next(V.Local.iTransit)
		F.Intrinsic.Control.EndIf
		
		F.Data.DataTable.SaveToDB("SOStage$LineStage","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*Order_No@!@Order_No*!*Record_No@!@Record_No*!*Part@!@Part*!*Description@!@Description*!*Qty_Required@!@Qty_Required*!*Qty_Scanned@!@Qty_Scanned*!*Heat@!@Heat*!*From_Bin@!@From_Bin*!*To_Bin@!@To_Bin*!*Rec_Type@!@Rec_Type")

		F.Intrinsic.Control.For(V.Local.iTransit,V.DataTable.SOStage$LineStage.RowCount--,0,-1)
			F.Intrinsic.Control.If(V.DataTable.SOStage$LineStage(V.Local.iTransit).Rec_Type!FieldValTrim,=,"S")
				F.Data.DataTable.DeleteRow("SOStage$LineStage",V.Local.iTransit)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iTransit)
		
		Gui.In_Transit.GsGridControlStage.MainView("SOStage")
		
		V.Local.sOrderNo.Set(V.DataTable.SOStage(V.DataTable.SOStage.RowCount--).Order_No!FieldValTrim)
		
		F.Data.DataView.Close("SOStage$LineStage","Temp")
		F.Data.DataTable.Close("SOStage$LineStage")
		F.Data.DataTable.Close("SOStage")
		
		Gui.In_Transit.txtNum.Text(V.Local.sOrderNo)
		F.Intrinsic.Control.CallSub(Get_Data)
		Gui.In_Transit..Enabled(True)
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.UI.CloseWaitDialog

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.cmdSave_Click.End

Program.Sub.cmdSetAll_Click.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.iTemp.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.iC.Declare(Long,0)
V.Local.sFilter.Declare(String,"")

Gui.In_Transit.GsGridControlRec.SuspendLayout()
'looping through when and setting line colors when select all is selected.
F.Intrinsic.Control.If(V.DataTable.SORec$LineRec.Exists,=,True)
	F.Intrinsic.Control.If(V.DataTable.SORec$LineRec.RowCount--,<>,-1)
		F.Data.DataTable.SetValue("SORec$LineRec",-1,"To_Bin",V.Global.sBin)
		F.Intrinsic.Control.For(V.Local.iTemp,0,V.DataTable.SORec$LineRec.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.SORec$LineRec(V.Local.iTemp).Qty_Scanned!FieldValFloat,>,0)
				F.Intrinsic.Control.For(V.Local.i,0,12,1)
					Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",V.Local.i,V.Local.iTemp,"BackColor","#64fd64")
				F.Intrinsic.Control.Next(V.Local.i)
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.For(V.Local.i,0,12,1)
					Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",V.Local.i,V.Local.iTemp,"BackColor","#EDFD73")
				F.Intrinsic.Control.Next(V.Local.i)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iTemp)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.SORec.RowCount--,1)
	F.Intrinsic.String.Build("Record_No = '{0}' and To_Bin = ''",V.DataTable.SORec(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
	F.Data.DataView.Create("SORec$LineRec","RecTemp")
	F.Data.DataView.Create("SORec$LineRec","TempRec")
	F.Data.DataView.SetFilter("SORec","RecTemp",V.Local.sFilter)
	F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SORec(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
	F.Data.DataView.SetFilter("SORec","TempRec",V.Local.sFilter)
	
	F.Intrinsic.Control.If(V.DataView.SORec$LineRec!RecTemp.RowCount--,=,-1)
		F.Intrinsic.Control.If(V.DataTable.SORec(V.Local.i).Qty_Required.FieldValFloat,=,0)
			F.Intrinsic.Control.For(V.Local.iC,0,7,1)
				Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#64fd64")
			F.Intrinsic.Control.Next(V.Local.iC)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.For(V.Local.iC,0,7,1)
				Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
			F.Intrinsic.Control.Next(V.Local.iC)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.DataView.SORec$LineRec!RecTemp.RowCount--,=,V.DataView.SORec$LineRec!TempRec.RowCount--)
			F.Intrinsic.Control.If(V.DataTable.SORec(V.Local.i).Qty_Scanned!FieldValTrim,=,0)
				F.Intrinsic.Control.For(V.Local.iC,0,7,1)
					Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#fd6464")
				F.Intrinsic.Control.Next(V.Local.iC)
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.For(V.Local.iC,0,7,1)
					Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
				F.Intrinsic.Control.Next(V.Local.iC)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else		
			F.Intrinsic.Control.For(V.Local.iC,0,7,1)
				Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
			F.Intrinsic.Control.Next(V.Local.iC)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Data.DataView.Close("SORec$LineRec","RecTemp")
	F.Data.DataView.Close("SORec$LineRec","TempRec")
F.Intrinsic.Control.Next(V.Local.i)

Gui.In_Transit.GsGridControlRec.ResumeLayout()

F.Data.DataTable.AcceptChanges("SORec$LineRec")

F.Data.DataTable.SaveToDB("SORec$LineRec","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*Order_No@!@Order_No*!*Record_No@!@Record_No*!*Part@!@Part*!*Description@!@Description*!*Qty_Scanned@!@Qty_Scanned*!*From_Bin@!@From_Bin*!*To_Bin@!@To_Bin*!*Rec_Type@!@Rec_Type")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.cmdSetAll_Click.End

Program.Sub.GsGridControlRec_CellValueChanged.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sFilter.Declare(String,"")
V.Local.iC.Declare(Long,0)

'coloring the grid when a to bin is selected.
Gui.In_Transit.GsGridControlRec.SuspendLayout()
F.Intrinsic.Control.If(V.Args.Column.UCase,=,"TO_BIN")
	v.Global.iBIndex.Set(v.Args.RowIndex)
	F.Intrinsic.Control.If(V.DataTable.SORec$LineRec(V.Args.RowIndex).Qty_Scanned!FieldValLong,>,0)
		F.Intrinsic.Control.For(V.Local.i,0,12,1)
			Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",V.Local.i,V.Args.RowIndex,"BackColor","#64fd64")
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.For(V.Local.i,0,12,1)
			Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",V.Local.i,V.Args.RowIndex,"BackColor","#EDFD73")
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SORec$LineRec(V.Global.iBIndex).Record_No!FieldValTrim,V.Local.sFilter)

F.Data.DataView.Create("SOREC","RecTemp")
F.Data.DataView.SetFilter("SOREC","RecTemp",V.Local.sFilter)
		
V.Local.i.Set(V.DataView.SORec!RecTemp(V.DataView.SORec!RecTemp.RowCount--).DataTableIndex)
		
F.Data.DataView.Close("SORec","RecTemp")

F.Intrinsic.String.Build("Record_No = '{0}' and (To_Bin = '' or To_Bin is Null)",V.DataTable.SORec(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
F.Data.DataView.Create("SORec$LineRec","RecTemp")
F.Data.DataView.Create("SORec$LineRec","TempRec")
F.Data.DataTable.AcceptChanges("SORec$LineRec")
F.Data.DataView.SetFilter("SORec","RecTemp",V.Local.sFilter)
F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SORec(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
F.Data.DataView.SetFilter("SORec","TempRec",V.Local.sFilter)

F.Intrinsic.Control.If(V.DataView.SORec$LineRec!RecTemp.RowCount--,=,-1)
	F.Intrinsic.Control.If(V.DataTable.SORec(V.Local.i).Qty_Required!FieldValLong,=,0)
		F.Intrinsic.Control.For(V.Local.iC,0,7,1)
			Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#64fd64")
		F.Intrinsic.Control.Next(V.Local.iC)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.For(V.Local.iC,0,7,1)
			Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
		F.Intrinsic.Control.Next(V.Local.iC)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.DataView.SORec$LineRec!RecTemp.RowCount--,=,V.DataView.SORec$LineRec!TempRec.RowCount--)
		F.Intrinsic.Control.For(V.Local.iC,0,7,1)
			Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
		F.Intrinsic.Control.Next(V.Local.iC)
	F.Intrinsic.Control.Else		
		F.Intrinsic.Control.For(V.Local.iC,0,7,1)
			Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.iC,V.Local.i,"BackColor","#EDFD73")
		F.Intrinsic.Control.Next(V.Local.iC)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("SORec$LineRec","RecTemp")
F.Data.DataView.Close("SORec$LineRec","TempRec")
		
V.Global.sBin.Set(V.DataTable.SORec$LineRec(V.Args.RowIndex).To_Bin!FieldValTrim)
Gui.In_Transit.GsGridControlRec.ResumeLayout()

F.Data.DataTable.SaveToDB("SORec$LineRec","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*Order_No@!@Order_No*!*Record_No@!@Record_No*!*Part@!@Part*!*Description@!@Description*!*Qty_Scanned@!@Qty_Scanned*!*From_Bin@!@From_Bin*!*To_Bin@!@To_Bin*!*Rec_Type@!@Rec_Type")

F.Data.DataTable.AcceptChanges("SORec$LineRec")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.GsGridControlRec_CellValueChanged.End

Program.Sub.ReversePartEntry.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.iScanned.Declare(Long,0)
V.Local.sFilter.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.iReq.Declare(Long,0)
V.Local.iQty.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.iIndex.Declare(Long,0)
V.Local.sToBin.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sFile.Declare(String,"")
V.Local.sFqn.Declare(String,"")
V.Local.sText.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sLoc.Declare(String,"")
V.Local.sStop.Declare(String,"")

F.Intrinsic.Control.SelectCase(V.Screen.In_Transit!tab1.Tab)
	F.Intrinsic.Control.Case(0)	
		'removing part
		F.Intrinsic.Control.If(V.Global.sGrid.UCase,=,"LINE")
			F.Intrinsic.Control.If(V.Args.ItemName.UCase,=,"ITEM 0")
				F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SO$Line(V.Global.iIndex).Record_No!FieldValTrim,V.Local.sFilter)
				F.Intrinsic.Control.If(V.DataView.SO!STemp.Exists)
					F.Data.DataView.Close("SO","STemp")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.DataView.SO!STemp.Exists,=,True)
					F.Data.DataView.Close("SO","STemp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("SO","STemp",22,V.Local.sFilter,"Record_No")
				F.Intrinsic.Math.Sub(V.DataView.SO!STemp(V.DataView.SO!STemp.RowCount--).Qty_Scanned!FieldValFloat,1,V.Local.iScanned)
				F.Intrinsic.Math.Sub(V.DataView.SO!STemp(V.DataView.SO!STemp.RowCount--).Qty_Ordered!FieldValFloat,V.Local.iScanned,V.Local.iReq)
				F.Intrinsic.Math.Add(V.DataView.SO!STemp(V.DataView.SO!STemp.RowCount--).Qty_OnHand!FieldValFloat,1,V.Local.iQty)
				F.Intrinsic.String.Build("Delete From GCG_4552_In_Transit Where Rec_No = '{0}'",V.DataTable.SO$Line(V.Global.iIndex).Rec_No!FieldValTrim,V.Local.sSql)
				F.Data.DataView.SetValue("SO","STemp",V.DataView.SO!STemp.RowCount--,"Qty_Scanned",V.Local.iScanned,"Qty_Required",V.Local.iReq,"Qty_OnHand",V.Local.iQty)
				F.ODBC.Connection!con.Execute(V.Local.sSql)
				F.Data.DataTable.DeleteRow("SO$Line",V.Global.iIndex)
				Gui.In_Transit.GsGridControlNew.MainView(SO)
				Gui.In_Transit.GsGridControlNew.SuspendLayout()
				
				F.Data.DataTable.AcceptChanges("SO$Line")
				
				V.Local.iIndex.Set(V.DataView.SO!STemp(V.DataView.SO!STemp.RowCount--).DataTableIndex)
				Gui.In_Transit.GsGridControlNew.ExpandMasterRow("SO",V.Local.iIndex)
				
				V.Local.iIndex.Set(V.DataView.SO!STemp(V.DataView.SO!STemp.RowCount--).DataTableIndex)
				F.Intrinsic.Control.If(V.DataView.SO!STemp(V.DataView.SO!STemp.RowCount--).Flag_Bom!FieldValTrim,<>,"Y")
					F.Intrinsic.Control.If(V.DataView.SO!STemp(V.DataView.SO!STemp.RowCount--).Qty_Required!FieldValFloat,=,0)
						F.Intrinsic.Control.For(V.Local.i,0,9,1)
							Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.i,V.Local.iIndex,"BackColor","#64fd64")
						F.Intrinsic.Control.Next(V.Local.i)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.If(V.DataView.SO!STemp(V.DataView.SO!STemp.RowCount--).Qty_OnHand!FieldValFloat,<=,0)
							F.Intrinsic.Control.For(V.Local.i,0,9,1)
								Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.i,V.Local.iIndex,"BackColor","#fd6464")
							F.Intrinsic.Control.Next(V.Local.i)
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.For(V.Local.i,0,9,1)
								Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.i,V.Local.iIndex,"BackColor","#EDFD73")
							F.Intrinsic.Control.Next(V.Local.i)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				
				F.Data.DataView.Close("SO","STemp")
				Gui.In_Transit.GsGridControlNew.ResumeLayout()
				
				F.Data.DataTable.SaveToDB("SO","con","GCG_4552_Sales_Order","Order_NO*!*Record_NO",256,"Order_NO@!@Order_No*!*Record_NO@!@Record_No*!*Qty_Scanned@!@Qty_Scanned*!*Qty_Required@!@Qty_Required")
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SO$Line(V.Global.iIndex).Record_No!FieldValTrim,V.Local.sFilter)
				F.Intrinsic.Control.If(V.DataView.SO!STemp.Exists)
					F.Data.DataView.Close("SO","STemp")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.DataView.SO!STemp.Exists,=,True)
					F.Data.DataView.Close("SO","STemp")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Create("SO","STemp",22,V.Local.sFilter,"Record_No")
				
				gui.Form_PickShipQty.txtQtyLeft.Text(V.DataView.SO!STemp(V.DataView.SO!STemp.RowCount--).Qty_Required!FieldValFloat)
				F.Intrinsic.String.Build("Select Distinct 0 as Qty, Quantity as Qty_OnHand, Bin, Serial_Number, Lot, Heat From V_Item_Master Where Quantity >= {0} and Part = '{1}' and Bin <> 'INTRAN' and (Heat = '' or Heat is null)",1,V.DataView.SO!STemp(V.DataView.SO!STemp.RowCount--).Part!FieldValTrim,V.Local.sSql)
				F.Data.DataTable.CreateFromSQL("QtySelect","con",V.Local.sSql,True)
				
				F.Data.DataTable.AddExpressionColumn("QtySelect","QtyCount","Float","Sum(Qty)")
				
				F.Intrinsic.Control.If(V.DataTable.QtySelect.RowCount--,<>,-1)
					Gui.Form_PickShipQty.txtQtyCount.Text(V.DataTable.QtySelect(V.DataTable.QtySelect.RowCount--).QtyCount!FieldValFloat)
				F.Intrinsic.Control.Else
					Gui.Form_PickShipQty.txtQtyCount.Text("0")
				F.Intrinsic.Control.EndIf
				Gui.Form_PickShipQty.GsGridControlPickShipQty.AddGridviewFromDatatable("QtySelect","QtySelect")
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","QtyCount","Visible",False)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Qty","ReadOnly",False)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Qty","allowedit",True)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Qty_OnHand","ReadOnly",True)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Qty_OnHand","allowedit",False)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Qty_OnHand","Caption","Qty OnHand")
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Bin","ReadOnly",True)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Bin","allowedit",False)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Serial_Number","ReadOnly",True)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Serial_Number","allowedit",False)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Serial_Number","Caption","Serial Number")
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Lot","ReadOnly",True)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Lot","allowedit",False)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Heat","ReadOnly",True)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Heat","allowedit",False)
				Gui.Form_PickShipQty.GsGridControlPickShipQty.MainView("QtySelect")
				
				Gui.Form_PickShipQty..Show
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			'item master view for selected part
			F.Intrinsic.String.Build("(Part = '{0}' and Bin <> 'INTRAN') or (Part = '{0}' and Bin not like 'XSH%')",V.DataTable.SO(V.Global.iIndex).Part!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.SetFilter("ItemMaster","ItemMaster",V.Local.sFilter)
			
			Gui.FormItemMaster.GsGridControl1.MainView("ItemMaster")
			Gui.FormItemMaster..Show
			
		F.Intrinsic.Control.EndIf	
		
	F.Intrinsic.Control.Case(1)		
		F.Intrinsic.Control.If(V.Global.sGrid.UCase,=,"LINEREC")
			'unscanning part
			F.Intrinsic.Control.If(V.Args.ItemName.UCase,=,"ITEM 0")
				'checking if the qty scanned on the selected part <> 0
				F.Intrinsic.Control.If(V.DataTable.SORec$LineRec(V.Global.iIndex).Qty_Scanned!FieldValFloat,>,0)
				
					F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SORec$LineRec(V.Global.iIndex).Record_No!FieldValTrim,V.Local.sFilter)
					F.Intrinsic.Control.If(V.DataView.SORec!STemp.Exists)
						F.Data.DataView.Close("SORec","STemp")
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Create("SORec","STemp",22,V.Local.sFilter,"Record_No")
					F.Intrinsic.Math.Sub(V.DataView.SORec!STemp(V.DataView.SORec!STemp.RowCount--).Qty_Scanned!FieldValFloat,1,V.Local.iScanned)
					F.Intrinsic.Math.Add(V.DataView.SORec!STemp(V.DataView.SORec!STemp.RowCount--).Qty_Required!FieldValFloat,1,V.Local.iQty)
					F.Data.DataView.SetValue("SORec","STemp",V.DataView.SORec!STemp.RowCount--,"Qty_Scanned",V.Local.iScanned,"Qty_Required",V.Local.iQty)
					Gui.In_Transit.GsGridControlRec.MainView(SORec)
					V.Local.iIndex.Set(V.DataView.SORec!STemp(V.DataView.SORec!STemp.RowCount--).DataTableIndex)
					Gui.In_Transit.GsGridControlRec.ExpandMasterRow("SORec",V.Local.iIndex)
					
					Gui.In_Transit.GsGridControlRec.SuspendLayout()
					F.Intrinsic.Control.If(V.DataView.SORec!STemp(V.DataView.SORec!STemp.RowCount--).Flag_Bom!FieldValTrim,<>,"Y")
						F.Intrinsic.Control.If(V.DataView.SORec!STemp(V.DataView.SORec!STemp.RowCount--).Qty_Required!FieldValFloat,=,0)
							F.Intrinsic.Control.For(V.Local.i,0,7,1)
								Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.i,V.Local.iIndex,"BackColor","#64fd64")
							F.Intrinsic.Control.Next(V.Local.i)
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.DataView.SORec!STemp(V.DataView.SORec!STemp.RowCount--).Qty_Scanned!FieldValFloat,=,0)
								F.Intrinsic.Control.For(V.Local.i,0,7,1)
									Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.i,V.Local.iIndex,"BackColor","#fd6464")
								F.Intrinsic.Control.Next(V.Local.i)
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.For(V.Local.i,0,7,1)
									Gui.In_Transit.GsGridControlRec.SetCellAppearance("SORec",V.Local.i,V.Local.iIndex,"BackColor","#EDFD73")
								F.Intrinsic.Control.Next(V.Local.i)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
					
					F.Data.DataView.Close("SORec","STemp")
	
					F.Data.DataTable.SetValue("SORec$LineRec",V.Global.iIndex,"To_Bin"," ","Qty_Scanned",0)
					F.Intrinsic.Control.For(V.Local.i,0,12,1)
						Gui.In_Transit.GsGridControlRec.SetCellAppearance("LineRec",V.Local.i,V.Global.iIndex,"BackColor","#fd6464")
					F.Intrinsic.Control.Next(V.Local.i)
					Gui.In_Transit.GsGridControlRec.ResumeLayout()
				
					F.Data.DataTable.SaveToDB("SORec$LineRec","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*Order_No@!@Order_No*!*Record_No@!@Record_No*!*Part@!@Part*!*Description@!@Description*!*Qty_Scanned@!@Qty_Scanned*!*From_Bin@!@From_Bin*!*To_Bin@!@To_Bin*!*Rec_Type@!@Rec_Type")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Args.ItemName.UCase,=,"ITEM 1")
					'swapping out serial part for a new serial part
					F.Intrinsic.String.Build("Select Bin From V_Bin_Master","",V.Local.sSql)
					V.Local.sTitles.Set("Bin")
					V.Local.sWidths.Set("1800")
					F.Intrinsic.UI.Browser("Select Bin","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,V.Local.sRet)
		
					F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
						V.Local.sToBin.Set(V.Local.sRet)
						F.Intrinsic.String.Build("Select Distinct Lot, Bin, Heat, Serial_Number, Quantity From V_Item_Master Where Quantity >= 0 and Part = '{0}' and Bin <> 'INTRAN' and (Heat = '' or Heat is null)",V.DataTable.SORec$LineRec(V.Global.iIndex).Part!FieldValTrim,V.Local.sSql)
						
						V.Local.sTitles.Set("Lot*!*Bin*!*Heat*!*Serial*!*Quantity")
						V.Local.sWidths.Set("1800*!*1800*!*1800*!*6250*!*1800")
						
						F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
						F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)
						
						F.Intrinsic.UI.Browser("Select New Serial Part","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,V.Local.sRet)
						
						F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
							'creating temp datatble for loc  bin selected
							F.Intrinsic.String.Build("Select Location From V_Item_Master Where Part = '{0}' and Bin = '{1}' and Lot = '{2}' and Heat = '{3}' and Serial_Number = '{4}'",V.DataTable.SORec$LineRec(V.Global.iIndex).Part!FieldValTrim,"INTRAN",V.DataTable.SORec$LineRec(V.Global.iIndex).Lot!FieldValTrim,"",V.DataTable.SORec$LineRec(V.Global.iIndex).Serial_Number!FieldValTrim,V.Local.sSql)
					
							F.Data.DataTable.CreateFromSQL("Item","con",V.Local.sSql,True)
							
							F.Intrinsic.Control.If(V.DataTable.Item.Exists)
								F.Intrinsic.Control.If(V.DataTable.Item.RowCount--,<>,-1)
									V.Local.sLoc.Set(V.DataTable.Item(V.DataTable.Item.RowCount--).Location!FieldValTrim)
								F.Intrinsic.Control.Else
									V.Local.sLoc.Set("")
								F.Intrinsic.Control.EndIf
								
								F.Data.DataTable.Close("Item")
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
							F.Intrinsic.String.RPad(V.DataTable.SORec$LineRec(V.Global.iIndex).Part!FieldValTrim," ",20,V.Local.sPart)
							F.Intrinsic.String.Build("{0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13}",V.Local.sPart,V.Local.sLoc,"1",V.Local.sRet(1),"INTRAN",V.Local.sRet(0),"",V.Local.sRet(3),"","","","Y",V.Caller.User,V.Ambient.Date.formatYYYYMMDD,V.Local.sText)
							F.Intrinsic.String.Build("{14}{15}{0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13}",V.Local.sPart,V.Local.sLoc,"1","INTRAN",V.Local.sToBin,V.DataTable.SORec$LineRec(V.Global.iIndex).Lot!FieldValTrim,"",V.DataTable.SORec$LineRec(V.Global.iIndex).Serial_Number!FieldValTrim,"","","","Y",V.Caller.User,V.Ambient.Date.formatYYYYMMDD,V.Local.sText,V.Ambient.NewLine,V.Local.sText)
							F.Intrinsic.String.Build("0{0}{1}BIN2BINTRNS",V.Caller.CompanyCode,V.Caller.Terminal,V.Local.sFile)
							F.Intrinsic.String.Build("{0}\{1}",V.Caller.FilesDir,V.Local.sFile,V.Local.sFqn)
							F.Intrinsic.File.String2File(V.Local.sFqn,V.Local.sText)
							
							F.Intrinsic.String.Build("{0}\{1}4552.stop",V.Caller.FilesDir,V.Caller.Terminal,V.Local.sStop)
							F.Intrinsic.File.String2File(V.Local.sStop,"Stop")
							F.Intrinsic.Task.LaunchGSSSync("LOT054UP","-c",V.Local.sFile)
							F.Intrinsic.File.DeleteFile(V.Local.sStop)
							F.Data.DataTable.SetValue("SORec$LineRec",V.Global.iIndex,"Lot",V.Local.sRet(0),"Serial_Number",V.Local.sRet(3))
						F.Intrinsic.Control.Else
							F.Intrinsic.UI.Msgbox("A Serial Part must be selected before the old Serial Part is removed.","Warning")
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Else
						F.Intrinsic.UI.Msgbox("A Bin must be selected before you can swap out the part.","Warning")
						F.Intrinsic.Control.ExitSub
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.If(V.Args.ItemName.UCase,=,"ITEM 2")
						F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SORec$LineRec(V.Global.iIndex).Record_No!FieldValTrim,V.Local.sFilter)
						F.Intrinsic.Control.If(V.DataView.SORec!STemp.Exists)
							F.Data.DataView.Close("SORec","STemp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("SORec","STemp",22,V.Local.sFilter,"Record_No")
						
						gui.Form_PickShipQty.txtQtyLeft.Text(V.DataView.SORec!STemp(V.DataView.SORec!STemp.RowCount--).Qty_Required!FieldValFloat)
						F.Intrinsic.String.Build("Select Distinct Rec_No, Cast(0 as bit) as Selected, Serial_Number, Lot, Heat From GCG_4552_IN_TRANSIT Where Record_No = '{0}' and Qty_Scanned = 0 and Rec_Type = 'T' and Order_No = '{1}'",V.DataTable.SORec$LineRec(V.Global.iIndex).Record_No!FieldValTrim,V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
						F.Data.DataTable.CreateFromSQL("QtySelect","con",V.Local.sSql,True)
						
						F.Data.DataTable.AddExpressionColumn("QtySelect","QtySelect","Float","IIF(Selected = True,1,0)")
						F.Data.DataTable.AddExpressionColumn("QtySelect","QtyCount","Float","Sum(QtySelect)")
						
						F.Intrinsic.Control.If(V.DataTable.QtySelect.RowCount--,<>,-1)
							Gui.Form_PickShipQty.txtQtyCount.Text(V.DataTable.QtySelect(V.DataTable.QtySelect.RowCount--).QtyCount!FieldValFloat)
						F.Intrinsic.Control.Else
							Gui.Form_PickShipQty.txtQtyCount.Text("0")
						F.Intrinsic.Control.EndIf
						Gui.Form_PickShipQty.GsGridControlPickShipQty.AddGridviewFromDatatable("QtySelect","QtySelect")
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","QtyCount","Visible",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","QtySelect","Visible",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Rec_No","Visible",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Selected","ReadOnly",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Selected","allowedit",True)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Serial_Number","ReadOnly",True)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Serial_Number","allowedit",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Serial_Number","Caption","Serial Number")
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Lot","ReadOnly",True)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Lot","allowedit",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Heat","ReadOnly",True)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Heat","allowedit",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.MainView("QtySelect")
						
						Gui.Form_PickShipQty..Show
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.If(V.Args.ItemName.UCase,=,"ITEM 3")
							Gui.In_Transit..Enabled(False)
							V.Local.sTitles.Set("Bin")
							V.Local.sWidths.Set("1800")

							F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
							F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)
							
							F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
							
							V.Local.sSql.Set("Select Bin From V_Bin_Master Where Bin <> 'INTRAN' and Bin not Like 'XSH%'")
							F.Intrinsic.UI.Browser("Select Bin","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,7200,7700,V.Local.sRet)
'							F.Intrinsic.Ui.MiniBrowser(150,"Enter Bin",V.Local.sRet)
							F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
								F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
								
								V.Local.sLoc.Set("")
								
								F.Intrinsic.String.RPad(V.DataTable.SORec$LineRec(V.Global.iIndex).Part!FieldValTrim," ",20,V.Local.sPart)
								F.Intrinsic.String.Build("{0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13}",V.Local.sPart,V.Local.sLoc,"1","INTRAN",V.Local.sRet,V.DataTable.SORec$LineRec(V.Global.iIndex).Lot!FieldValTrim,"",V.DataTable.SORec$LineRec(V.Global.iIndex).Serial_Number!FieldValTrim,"","","","Y",V.Caller.User,V.Ambient.Date.formatYYYYMMDD,V.Local.sText)
								F.Intrinsic.String.Build("0{0}{1}BIN2BINTRNS",V.Caller.CompanyCode,V.Caller.Terminal,V.Local.sFile)
								F.Intrinsic.String.Build("{0}\{1}",V.Caller.FilesDir,V.Local.sFile,V.Local.sFqn)
								F.Intrinsic.File.String2File(V.Local.sFqn,V.Local.sText)
								
								F.Intrinsic.String.Build("{0}\{1}4552.stop",V.Caller.FilesDir,V.Caller.Terminal,V.Local.sStop)
								F.Intrinsic.File.String2File(V.Local.sStop,"Stop")
								F.Intrinsic.Task.LaunchGSSSync("LOT054UP","-c",V.Local.sFile)
								F.Intrinsic.File.DeleteFile(V.Local.sStop)
								F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SORec$LineRec(V.Global.iIndex).Record_No!FieldValTrim,V.Local.sFilter)
								F.Data.DataView.Create("SOREC","SORECTEMP")
								F.Data.DataView.SetFilter("SOREC","SORECTEMP",V.Local.sFilter)
								
								F.Intrinsic.Math.Sub(V.DataView.SORec!SORECTEMP(V.DataView.SORec!SORECTEMP.RowCount--).Qty_Scanned!FieldValFloat,1,V.Local.iQty)
								F.Data.DataView.SetValue("SOREC","SORECTEMP",V.DataView.SORec!SORECTEMP.RowCount--,"Qty_Scanned",V.Local.iQty)
								F.Intrinsic.Math.Add(V.DataView.SORec!SORECTEMP(V.DataView.SORec!SORECTEMP.RowCount--).Qty_Required!FieldValFloat,1,V.Local.iQty)
								F.Data.DataView.SetValue("SOREC","SORECTEMP",V.DataView.SORec!SORECTEMP.RowCount--,"Qty_Required",V.Local.iQty)
								
								F.Data.DataTable.SaveToDB("SOREC","con","GCG_4552_Sales_Order","Order_No*!*Record_No",7)
								
								F.Data.DataTable.DeleteRow("SORec$LineRec",V.Global.iIndex)
								
								F.Data.DataTable.SaveToDB("SORec$LineRec","con","GCG_4552_In_Transit","Rec_No",4)
								
								Gui.In_Transit.txtNum.Text(V.DataView.SORec!SORECTEMP(V.DataView.SORec!SORECTEMP.RowCount--).Order_No!FieldValTrim)
								
								F.Data.DataView.Close("SORec","SORECTEMP")
								
								F.Intrinsic.Control.CallSub(Get_Data)
								
							F.Intrinsic.Control.EndIf
							Gui.In_Transit..Enabled(True)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			'item master view for selected part
			F.Intrinsic.String.Build("(Part = '{0}' and Bin <> 'INTRAN') or (Part = '{0}' and Bin not like 'XSH%')",V.DataTable.SORec(V.Global.iIndex).Part!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.SetFilter("ItemMaster","ItemMaster",V.Local.sFilter)
			
			Gui.FormItemMaster.GsGridControl1.MainView("ItemMaster")
			Gui.FormItemMaster..Show
			
		F.Intrinsic.Control.EndIf	
		
	F.Intrinsic.Control.Case(2)
		F.Intrinsic.Control.If(V.Global.sGrid.UCase,=,"LINESTAGE")
			'removing scanned part
			F.Intrinsic.Control.If(V.Args.ItemName.UCase,=,"ITEM 0")
				'checking to see if qty_scanned <> 0
				F.Intrinsic.Control.If(V.DataTable.SOStage$LineStage(V.Global.iIndex).Qty_Scanned!FieldValFloat,>,0)
					F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SOStage$LineStage(V.Global.iIndex).Record_No!FieldValTrim,V.Local.sFilter)
					F.Intrinsic.Control.If(V.DataView.SOStage!STemp.Exists)
						F.Data.DataView.Close("SOStage","STemp")
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Create("SOStage","STemp",22,V.Local.sFilter,"Record_No")
					F.Intrinsic.Control.If(V.DataTable.SOStage$LineStage(V.Global.iIndex).Qty_Scanned!FieldValFloat,>,0)
						F.Intrinsic.Math.Sub(V.DataView.SOStage!STemp(V.DataView.SOStage!STemp.RowCount--).Qty_Scanned!FieldValFloat,1,V.Local.iScanned)
						F.Intrinsic.Math.Sub(V.DataView.SOStage!STemp(V.DataView.SOStage!STemp.RowCount--).Qty_Ordered!FieldValFloat,V.Local.iScanned,V.Local.iReq)
						F.Data.DataView.SetValue("SOStage","STemp",V.DataView.SOStage!STemp.RowCount--,"Qty_Scanned",V.Local.iScanned,"Qty_Required",V.Local.iReq)
						F.Data.DataTable.SetValue("SOStage$LineStage",V.Global.iIndex,"Qty_Scanned",0)
						Gui.In_Transit.GsGridControlStage.SuspendLayout()
						F.Intrinsic.Control.For(V.Local.i,0,12,1)
							Gui.In_Transit.GsGridControlStage.SetCellAppearance("LineStage",V.Local.i,V.Global.iIndex,"BackColor","#fd6464")
						F.Intrinsic.Control.Next(V.Local.i)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.ExitSub
					F.Intrinsic.Control.EndIf
					
					V.Local.iIndex.Set(V.DataView.SOStage!STemp(V.DataView.SOStage!STemp.RowCount--).DataTableIndex)
					F.Intrinsic.Control.If(V.DataView.SOStage!STemp(V.DataView.SOStage!STemp.RowCount--).Flag_Bom!FieldValTrim,<>,"Y")
						F.Intrinsic.Control.If(V.DataView.SOStage!STemp(V.DataView.SOStage!STemp.RowCount--).Qty_Required!FieldValFloat,=,0)
							F.Intrinsic.Control.For(V.Local.i,1,9,1)
								Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",V.Local.i,V.Local.iIndex,"BackColor","#64fd64")
							F.Intrinsic.Control.Next(V.Local.i)
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.DataView.SOStage!STemp(V.DataView.SOStage!STemp.RowCount--).Qty_Scanned!FieldValTrim,=,0)
								F.Intrinsic.Control.For(V.Local.i,1,9,1)
									Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",V.Local.i,V.Local.iIndex,"BackColor","#fd6464")
								F.Intrinsic.Control.Next(V.Local.i)
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.For(V.Local.i,1,9,1)
									Gui.In_Transit.GsGridControlStage.SetCellAppearance("SOStage",V.Local.i,V.Local.iIndex,"BackColor","#EDFD73")
								F.Intrinsic.Control.Next(V.Local.i)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
					Gui.In_Transit.GsGridControlStage.ResumeLayout()
					
					F.Data.DataView.Close("SOStage","STemp")
					
					F.Data.DataTable.SaveToDB("SOStage","con","GCG_4552_Sales_Order","Order_NO*!*Record_NO",256,"Order_NO@!@Order_No*!*Record_NO@!@Record_No*!*Qty_Scanned@!@Qty_Scanned*!*Qty_Required@!@Qty_Required")
					F.Data.DataTable.SaveToDB("SOStage$LineStage","con","GCG_4552_In_Transit","Rec_No",7)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Args.ItemName.UCase,=,"ITEM 1")
					'swapping out serial part for a new serial part
					F.Intrinsic.String.Build("Select Bin From V_Bin_Master","",V.Local.sSql)
					V.Local.sTitles.Set("Bin")
					V.Local.sWidths.Set("1800")
					F.Intrinsic.UI.Browser("Select Bin","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,V.Local.sRet)
		
					F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
						V.Local.sToBin.Set(V.Local.sRet)
						F.Intrinsic.String.Build("Select Distinct Lot, Bin, Heat, Serial_Number, Quantity From V_Item_Master Where Quantity >= 0 and Part = '{0}' and Bin <> 'INTRAN' and (Heat = '' or Heat is null)",V.DataTable.SOStage$LineStage(V.Global.iIndex).Part!FieldValTrim,V.Local.sSql)
						
						V.Local.sTitles.Set("Lot*!*Bin*!*Heat*!*Serial*!*Quantity")
						V.Local.sWidths.Set("1800*!*1800*!*1800*!*6250*!*1800")
						
						F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
						F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)
						
						F.Intrinsic.UI.Browser("Select New Serial Part","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,V.Local.sRet)
						
						F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
							'creating temp datatble for loc  bin selected
							F.Intrinsic.String.Build("Select Location From V_Item_Master Where Part = '{0}' and Bin = '{1}' and Lot = '{2}' and Heat = '{3}' and Serial_Number = '{4}'",V.DataTable.SOStage$LineStage(V.Global.iIndex).Part!FieldValTrim,"INTRAN",V.DataTable.SOStage$LineStage(V.Global.iIndex).Lot!FieldValTrim,"",V.DataTable.SOStage$LineStage(V.Global.iIndex).Serial_Number!FieldValTrim,V.Local.sSql)
					
							F.Data.DataTable.CreateFromSQL("Item","con",V.Local.sSql,True)
							
							F.Intrinsic.Control.If(V.DataTable.Item.Exists)
								F.Intrinsic.Control.If(V.DataTable.Item.RowCount--,<>,-1)
									V.Local.sLoc.Set(V.DataTable.Item(V.DataTable.Item.RowCount--).Location!FieldValTrim)
								F.Intrinsic.Control.Else
									V.Local.sLoc.Set("")
								F.Intrinsic.Control.EndIf
								
								F.Data.DataTable.Close("Item")
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
							F.Intrinsic.String.RPad(V.DataTable.SOStage$LineStage(V.Global.iIndex).Part!FieldValTrim," ",20,V.Local.sPart)
							F.Intrinsic.String.Build("{0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13}",V.Local.sPart,V.Local.sLoc,"1",V.Local.sRet(1).Trim,V.DataTable.SOStage$LineStage(V.Global.iIndex).To_Bin!FieldValTrim,V.Local.sRet(0).Trim,"",V.Local.sRet(3).Trim,"","","","Y",V.Caller.User,V.Ambient.Date.formatYYYYMMDD,V.Local.sText)
							F.Intrinsic.String.Build("{14}{15}{0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13}",V.Local.sPart,V.Local.sLoc,"1",V.DataTable.SOStage$LineStage(V.Global.iIndex).To_Bin!FieldValTrim,V.Local.sToBin.Trim,V.DataTable.SOStage$LineStage(V.Global.iIndex).Lot!FieldValTrim,"",V.DataTable.SOStage$LineStage(V.Global.iIndex).Serial_Number!FieldValTrim,"","","","Y",V.Caller.User,V.Ambient.Date.formatYYYYMMDD,V.Local.sText,V.Ambient.NewLine,V.Local.sText)
							F.Intrinsic.String.Build("0{0}{1}BIN2BINTRNS",V.Caller.CompanyCode,V.Caller.Terminal,V.Local.sFile)
							F.Intrinsic.String.Build("{0}\{1}",V.Caller.FilesDir,V.Local.sFile,V.Local.sFqn)
							F.Intrinsic.File.String2File(V.Local.sFqn,V.Local.sText)
							
							F.Intrinsic.String.Build("{0}\{1}4552.stop",V.Caller.FilesDir,V.Caller.Terminal,V.Local.sStop)
							F.Intrinsic.File.String2File(V.Local.sStop,"Stop")
							F.Intrinsic.Task.LaunchGSSSync("LOT054UP","-c",V.Local.sFile)
							F.Intrinsic.File.DeleteFile(V.Local.sStop)
							F.Data.DataTable.SetValue("SOStage$LineStage",V.Global.iIndex,"Lot",V.Local.sRet(0),"Serial_Number",V.Local.sRet(3))
						F.Intrinsic.Control.Else
							F.Intrinsic.UI.Msgbox("A Serial Part must be selected before the old Serial Part is removed.","Warning")
							F.Intrinsic.Control.ExitSub
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Else
						F.Intrinsic.UI.Msgbox("A Bin must be selected before you can swap out the part.","Warning")
						F.Intrinsic.Control.ExitSub
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.If(V.Args.ItemName.UCase,=,"ITEM 3")
						Gui.In_Transit..Enabled(False)
							V.Local.sTitles.Set("Bin")
							V.Local.sWidths.Set("1800")

							F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
							F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)
							
							F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
							
							V.Local.sSql.Set("Select Bin From V_Bin_Master Where Bin <> 'INTRAN' and Bin not Like 'XSH%'")
							F.Intrinsic.UI.Browser("Select Bin","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,7200,7700,V.Local.sRet)
'							F.Intrinsic.Ui.MiniBrowser(150,"Enter Bin",V.Local.sRet)
							F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
								F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
								
								V.Local.sLoc.Set("")
								
								F.Intrinsic.String.RPad(V.DataTable.SOStage$LineStage(V.Global.iIndex).Part!FieldValTrim," ",20,V.Local.sPart)
								F.Intrinsic.String.Build("{0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13}",V.Local.sPart,V.Local.sLoc,"1",V.DataTable.SOStage$LineStage(V.Global.iIndex).To_Bin!FieldValTrim,V.Local.sRet,V.DataTable.SOStage$LineStage(V.Global.iIndex).Lot!FieldValTrim,"",V.DataTable.SOStage$LineStage(V.Global.iIndex).Serial_Number!FieldValTrim,"","","","Y",V.Caller.User,V.Ambient.Date.formatYYYYMMDD,V.Local.sText)
								F.Intrinsic.String.Build("0{0}{1}BIN2BINTRNS",V.Caller.CompanyCode,V.Caller.Terminal,V.Local.sFile)
								F.Intrinsic.String.Build("{0}\{1}",V.Caller.FilesDir,V.Local.sFile,V.Local.sFqn)
								F.Intrinsic.File.String2File(V.Local.sFqn,V.Local.sText)
								
								F.Intrinsic.String.Build("{0}\{1}4552.stop",V.Caller.FilesDir,V.Caller.Terminal,V.Local.sStop)
								F.Intrinsic.File.String2File(V.Local.sStop,"Stop")
								F.Intrinsic.Task.LaunchGSSSync("LOT054UP","-c",V.Local.sFile)
								F.Intrinsic.File.DeleteFile(V.Local.sStop)
								F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SOStage$LineStage(V.Global.iIndex).Record_No!FieldValTrim,V.Local.sFilter)
								F.Data.DataView.Create("SOStage","SOSTageTEMP")
								F.Data.DataView.SetFilter("SOStage","SOSTageTEMP",V.Local.sFilter)
								
								F.Intrinsic.Math.Sub(V.DataView.SOStage!SOStageTEMP(V.DataView.SOStage!SOStageTEMP.RowCount--).Qty_Scanned!FieldValFloat,1,V.Local.iQty)
								F.Data.DataView.SetValue("SOStage","SOStageTEMP",V.DataView.SOStage!SOStageTEMP.RowCount--,"Qty_Scanned",V.Local.iQty)
								F.Intrinsic.Math.Add(V.DataView.SOStage!SOStageTEMP(V.DataView.SOStage!SOStageTEMP.RowCount--).Qty_Required!FieldValFloat,1,V.Local.iQty)
								F.Data.DataView.SetValue("SOStage","SOStageTEMP",V.DataView.SOStage!SOStageTEMP.RowCount--,"Qty_Required",V.Local.iQty)
								
								F.Data.DataTable.SaveToDB("SOStage","con","GCG_4552_Sales_Order","Order_No*!*Record_No",7)
								
								F.Data.DataTable.DeleteRow("SOStage$LineStage",V.Global.iIndex)
								
								F.Data.DataTable.SaveToDB("SOStage$LineStage","con","GCG_4552_In_Transit","Rec_No",4)
								
								Gui.In_Transit.txtNum.Text(V.DataView.SOStage!SOStageTEMP(V.DataView.SOStage!SOStageTEMP.RowCount--).Order_No!FieldValTrim)
								
								F.Data.DataView.Close("SOStage","SOStageTEMP")
								
								F.Intrinsic.Control.CallSub(Get_Data)
								
							F.Intrinsic.Control.EndIf
							Gui.In_Transit..Enabled(True)
						
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SOStage$LineStage(V.Global.iIndex).Record_No!FieldValTrim,V.Local.sFilter)
						F.Intrinsic.Control.If(V.DataView.SOStage!STemp.Exists)
							F.Data.DataView.Close("SOStage","STemp")
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Create("SOStage","STemp",22,V.Local.sFilter,"Record_No")
						
						gui.Form_PickShipQty.txtQtyLeft.Text(V.DataView.SOStage!STemp(V.DataView.SOStage!STemp.RowCount--).Qty_Required!FieldValFloat)
						F.Intrinsic.String.Build("Select Distinct Rec_No, Cast(0 as bit) as Selected, Serial_Number, Lot, Heat From GCG_4552_IN_TRANSIT Where Record_No = '{0}' and Qty_Scanned = 0 and Rec_Type = 'R' and Order_No = '{1}'",V.DataTable.SOStage$LineStage(V.Global.iIndex).Record_No!FieldValTrim,V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
						F.Data.DataTable.CreateFromSQL("QtySelect","con",V.Local.sSql,True)
						
						F.Data.DataTable.AddExpressionColumn("QtySelect","QtySelect","Float","IIF(Selected = True,1,0)")
						F.Data.DataTable.AddExpressionColumn("QtySelect","QtyCount","Float","Sum(QtySelect)")
						
						F.Intrinsic.Control.If(V.DataTable.QtySelect.RowCount--,<>,-1)
							Gui.Form_PickShipQty.txtQtyCount.Text(V.DataTable.QtySelect(V.DataTable.QtySelect.RowCount--).QtyCount!FieldValFloat)
						F.Intrinsic.Control.Else
							Gui.Form_PickShipQty.txtQtyCount.Text("0")
						F.Intrinsic.Control.EndIf
						Gui.Form_PickShipQty.GsGridControlPickShipQty.AddGridviewFromDatatable("QtySelect","QtySelect")
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","QtyCount","Visible",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","QtySelect","Visible",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Rec_No","Visible",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Selected","ReadOnly",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Selected","allowedit",True)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Serial_Number","ReadOnly",True)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Serial_Number","allowedit",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Serial_Number","Caption","Serial Number")
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Lot","ReadOnly",True)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Lot","allowedit",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Heat","ReadOnly",True)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.SetColumnProperty("QtySelect","Heat","allowedit",False)
						Gui.Form_PickShipQty.GsGridControlPickShipQty.MainView("QtySelect")
						
						Gui.Form_PickShipQty..Show
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			'item master view for selected part
			F.Intrinsic.String.Build("(Part = '{0}' and Bin <> 'INTRAN') or (Part = '{0}' and Bin not like 'XSH%')",V.DataTable.SOStage(V.Global.iIndex).Part!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.SetFilter("ItemMaster","ItemMaster",V.Local.sFilter)
			
			Gui.FormItemMaster.GsGridControl1.MainView("ItemMaster")
			Gui.FormItemMaster..Show
			
		F.Intrinsic.Control.EndIf
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.ReversePartEntry.End

Program.Sub.RowCellClick.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.iX.Declare(Long,0)
V.Local.iY.Declare(Long,0)

V.Global.iIndex.Set(V.Args.RowIndex)

F.Intrinsic.API.GetMousePosition(V.Local.iX,V.Local.iY)

F.Intrinsic.Control.If(V.Args.Column.UCase,=,"RECORD_NO")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.SelectCase(V.Screen.In_Transit!tab1.Tab)
	F.Intrinsic.Control.Case(0)
		F.Intrinsic.Control.Try
			Gui.In_Transit.GsGridControlNew.GetFocusedGridview(V.Global.sGrid)
			F.Intrinsic.Control.If(V.Global.sGrid.UCase,=,"SO")
				Gui.In_Transit..ContextMenuShow("Qty",V.Local.iX,V.Local.iY)
			F.Intrinsic.Control.Else
				Gui.In_Transit..ContextMenuShow("Remove",V.Local.iX,V.Local.iY)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Catch
			F.Intrinsic.UI.Msgbox("Left Click on the Grid to give it Focus")
			F.Intrinsic.Control.ExitSub
		F.Intrinsic.Control.EndTry
		
	F.Intrinsic.Control.Case(1)
		F.Intrinsic.Control.Try
			Gui.In_Transit.GsGridControlRec.GetFocusedGridview(V.Global.sGrid)
			F.Intrinsic.Control.If(V.Global.sGrid.UCase,=,"SOREC")
				Gui.In_Transit..ContextMenuShow("Qty",V.Local.iX,V.Local.iY)
			F.Intrinsic.Control.Else
				Gui.In_Transit..ContextMenuSetItemText("DeletePart","Item 0","Undo Scan")
				Gui.In_Transit..ContextMenuShow("DeletePart",V.Local.iX,V.Local.iY)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Catch
			F.Intrinsic.UI.Msgbox("Left Click on the Grid to give it Focus")
			F.Intrinsic.Control.ExitSub
		F.Intrinsic.Control.EndTry
		
	F.Intrinsic.Control.Case(2)	
		F.Intrinsic.Control.Try
			Gui.In_Transit.GsGridControlStage.GetFocusedGridview(V.Global.sGrid)
			F.Intrinsic.Control.If(V.Global.sGrid.UCase,=,"SOSTAGE")
				Gui.In_Transit..ContextMenuShow("Qty",V.Local.iX,V.Local.iY)
			F.Intrinsic.Control.Else
				Gui.In_Transit..ContextMenuShow("DeletePart",V.Local.iX,V.Local.iY)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Catch
			F.Intrinsic.UI.Msgbox("Left Click on the Grid to give it Focus")
			F.Intrinsic.Control.ExitSub
		F.Intrinsic.Control.EndTry
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.RowCellClick.End

Program.Sub.FormItemMaster_UnLoad.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

Gui.FormItemMaster..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.FormItemMaster_UnLoad.End

Program.Sub.cmdupdate_Click.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.iCount.Declare(Long,0)
V.Local.sSql.Declare(String,"")
V.Local.sDatatableParent.Declare(String,"")
V.Local.sDatatableChild.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.bDelete.Declare(Boolean,True)
V.Local.iDiff.Declare(Long,0)

V.Global.sReason.Set("")

Gui.In_Transit.cmdupdate.Enabled(False)

Gui.In_Transit..Enabled(False)

F.Intrinsic.Control.SelectCase(V.Screen.In_Transit!tab1.Tab)
	F.Intrinsic.Control.Case(0)
		V.Local.sDatatableParent.Set("SO")
		V.Local.sDatatableChild.Set("SO$Line")
		
	F.Intrinsic.Control.Case(1)
		V.Local.sDatatableParent.Set("SORec")
		V.Local.sDatatableChild.Set("SORec$LineRec")
		
	F.Intrinsic.Control.Case(2)	
		V.Local.sDatatableParent.Set("SOStage")
		V.Local.sDatatableChild.Set("SOStage$LineStage")
	
F.Intrinsic.Control.EndSelect

'creating data tables for so
F.Intrinsic.String.Build("Select Distinct Order_No, Record_No, rtrim(Customer) as Customer, '' as Name_Customer, a.Part, b.Description, (Select sum(Quantity) From V_Item_Master c Where a.part = c.part and (bin not like 'XSH%' and bin not like 'HOLD%' and bin <> 'INTRAN')) as Qty_OnHand, a.Qty_Ordered, a.Qty_Ordered as Qty_Required, 0 as Qty_Scanned, Flag_Bom From V_Order_Lines a Left Join V_Inventory_Mstr b on a.Part = b.Part Where Order_No = '{0}' Order By Record_No",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
F.Intrinsic.Control.If(V.DataTable.SOOrder.Exists)
	F.Data.DataTable.Close("SOOrder")
F.Intrinsic.Control.EndIf
F.Data.DataTable.CreateFromSQL("SOOrder","con",V.Local.sSql,True)
F.Data.DataView.Create("SOOrder","SSO")
F.Intrinsic.String.Build("Select Order_No, Record_No, Part, Customer, Name_Customer, Qty_Ordered, Qty_Required, Qty_Scanned, Flag_Bom, Description From GCG_4552_Sales_Order Where Order_No = '{0}'",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
F.Intrinsic.Control.If(V.DataTable.GCGSalesORder.Exists)
	F.Data.DataTable.Close("GCGSalesORder")
F.Intrinsic.Control.EndIf
F.Data.DataTable.CreateFromSQL("GCGSalesORder","con",V.Local.sSql,True)
F.Data.DataView.Create("GCGSalesORder","SO")
F.Intrinsic.String.Build("Select Rec_No, Order_No, Record_No, Part, Description, Qty_Required, Qty_Scanned, From_Bin, To_Bin, Lot, Heat, Serial_Number, Rec_Type, Bom_Parent From GCG_4552_IN_Transit Where Order_No = '{0}'",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
F.Intrinsic.Control.If(V.DataTable.GCG_INTransit.Exists)
	F.Data.DataTable.Close("GCG_INTransit")
F.Intrinsic.Control.EndIf
F.Data.DataTable.CreateFromSQL("GCG_INTransit","Con",V.Local.sSql,True)
F.Data.DataView.Create("GCG_INTransit","TSO")

'creating empty datatable to use for bin to bin
F.Intrinsic.String.Build("Select Cast(0 as Bit) as Selection, Rec_No, Record_No, Part, Lot, Heat, Serial_Number, '' as From_Bin, '' as To_Bin, Rec_Type From GCG_4552_IN_Transit Where Order_No = '{0}'","-1",V.Local.sSql)
F.Data.DataTable.CreateFromSQL("BinToBinTemp","Con",V.Local.sSql,True)

F.Data.DataTable.AddExpressionColumn("BintoBinTemp","Status","String","IIF(Rec_Type = 'T','In-Transit',IIF(Rec_Type = 'R','Recieved',IIF(Rec_Type = 'S','Staged','')))")

F.Intrinsic.Control.If(V.DataTable.GCGSalesORder.RowCount--,<>,-1)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.GCGSalesORder.RowCount--,1)
		F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
		F.Data.DataView.SetFilter("SOOrder","SSO",V.Local.sFilter)
		'checking to see if the part is different
		F.Intrinsic.Control.If(V.DataView.SOOrder!SSO(V.DataView.SOOrder!SSO.RowCount--).Part!FieldValTrim,<>,V.DataTable.GCGSalesORder(V.Local.i).Part!FieldValTrim)
			F.Data.DataTable.SetValue("GCGSalesORder",V.Local.i,"RECORD_NO",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,"Part",V.DataTable.GCGSalesORder(V.Local.i).Part!FieldValTrim,"Customer",V.DataTable.GCGSalesORder(V.Local.i).Customer!FieldValTrim,"Name_Customer","","Qty_Ordered",V.DataView.SOOrder!SSO(V.DataView.SOOrder!SSO.RowCount--).Qty_Ordered!FieldValFloat,"Qty_Required",V.DataView.SOOrder!SSO(V.DataView.SOOrder!SSO.RowCount--).Qty_Ordered!FieldValFloat,"Qty_Scanned",0,"Flag_Bom",V.DataView.SOOrder!SSO(V.DataView.SOOrder!SSO.RowCount--).Flag_Bom!FieldValTrim,"Description",V.DataView.SOOrder!SSO(V.DataView.SOOrder!SSO.RowCount--).Description!FieldValTrim)
			'checking to see the old part is in INTRAN if so add to datatable for user to Move to a different Bin
			F.Intrinsic.String.Build("Record_No = '{0}' and Rec_Type = 'T'",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.SetFilter("GCG_INTransit","TSO",V.Local.sFilter)
			'looping through and adding these records
			F.Intrinsic.Control.For(V.Local.iCount,0,V.DataView.GCG_INTransit!TSO.RowCount--,1)
				F.Data.DataTable.AddRow("BinToBinTemp","REC_NO",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Rec_No!FieldVal,"RECORD_NO",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,"Part",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Part!FieldValTrim,"Lot",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Lot!FieldValTrim,"Heat",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Heat!FieldValTrim,"Serial_Number",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Serial_Number!FieldValTrim,"From_Bin","INTRAN","TO_Bin","","Rec_Type",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Rec_Type!FieldValTrim)
			F.Intrinsic.Control.Next(V.Local.iCount)
			'checking to see the old part is in a Ship Bin if so add to datatable for user to Move to a different Bin
			F.Intrinsic.String.Build("Record_No = '{0}' and Rec_Type = 'R'",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.SetFilter("GCG_INTransit","TSO",V.Local.sFilter)
			'looping through and adding these records
			F.Intrinsic.Control.For(V.Local.iCount,0,V.DataView.GCG_INTransit!TSO.RowCount--,1)
				F.Data.DataTable.AddRow("BinToBinTemp","Rec_No",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Rec_No!FieldVal,"RECORD_NO",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,"Part",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Part!FieldValTrim,"Lot",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Lot!FieldValTrim,"Heat",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Heat!FieldValTrim,"Serial_Number",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Serial_Number!FieldValTrim,"From_Bin",V.DataView.GCG_INTransit!TSO(V.Local.iCount).To_Bin!FieldValTrim,"TO_Bin","","Rec_Type",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Rec_Type!FieldValTrim)
			F.Intrinsic.Control.Next(V.Local.iCount)
			
			'checking to see the old part is in a Ship Bin if so add to datatable for user to Move to a different Bin
			F.Intrinsic.String.Build("Record_No = '{0}' and Rec_Type = 'S'",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.SetFilter("GCG_INTransit","TSO",V.Local.sFilter)
			'looping through and adding these records
			F.Intrinsic.Control.For(V.Local.iCount,0,V.DataView.GCG_INTransit!TSO.RowCount--,1)
				F.Data.DataTable.AddRow("BinToBinTemp","REC_NO",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Rec_No!FieldVal,"RECORD_NO",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,"Part",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Part!FieldValTrim,"Lot",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Lot!FieldValTrim,"Heat",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Heat!FieldValTrim,"Serial_Number",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Serial_Number!FieldValTrim,"From_Bin",V.DataView.GCG_INTransit!TSO(V.Local.iCount).To_Bin!FieldValTrim,"TO_Bin","","Rec_Type",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Rec_Type!FieldValTrim)
			F.Intrinsic.Control.Next(V.Local.iCount)
			
			V.Local.iDiff.Set(V.DataView.BinToBinTemp.RowCount)
			
			'calling screen for the user to move these records to another bin before processing more records
			Gui.BinToBin.txtDiff.Text(V.Local.iDiff)
			Gui.BinToBin.txtSalesOrder.Text(V.DataTable.GCGSalesORder(V.Local.i).Order_No!FieldValTrim)
			
			F.Data.DataTable.SetValue("BintoBinTemp",-1,"Selection",False)
			
			F.Intrinsic.Control.CallSub(BinToBinSetProperties)
			
			Gui.BinToBin..Show
			
			'waiting for dismiss
			f.Intrinsic.Control.CallSub(WaitforDismiss,"Screen","BintoBin")
			'checking to see if there are no parts left to be moved
			'if parts still need to be moved so order will not be removed from the so change table
			F.Intrinsic.Control.If(V.Screen.BinToBin!txtDiff.Text,>,0)
				V.Local.bDelete.Set(False)
			F.Intrinsic.Control.EndIf
			'clearing out the temp datatable for the next set of records that need to bemoved
			F.Data.DataTable.DeleteRow("BinToBinTemp")
			F.Data.DataTable.AcceptChanges("BinToBinTemp")
		F.Intrinsic.Control.Else		
			'checking to see if the qty is different
			F.Intrinsic.Control.If(V.DataTable.GCGSalesORder(V.Local.i).Qty_Ordered!FieldValFloat,<>,V.DataView.SOOrder!SSO(V.DataView.SOOrder!SSO.RowCount--).Qty_Ordered!FieldValFloat)
				'checking to see if what has been scanned is greater than the new qty_Ordered
				F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.SetFilter("GCG_INTransit","TSO",V.Local.sFilter)
				F.Intrinsic.Control.If(V.DataView.SOOrder!SSO(V.DataView.SOOrder!SSO.RowCount--).Qty_Ordered!FieldValFloat,<,V.DataView.GCG_INTransit!TSO.RowCount)
					F.Intrinsic.String.Build("Record_No = '{0}' and (Rec_Type <> 'R' and Rec_Type <> 'T' and Rec_Type <> 'S')",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.SetFilter("GCG_INTransit","TSO",V.Local.sFilter)
					V.Local.iDiff.Set(V.DataView.GCG_INTransit!TSO.RowCount)
					'checking to see if what's been scanned in INTRAN or SHIP is greater than new Qty if so only remove parts that are not intran and ship
					F.Intrinsic.String.Build("Record_No = '{0}' and (Rec_Type = 'R' or Rec_Type = 'T' or Rec_Type = 'S')",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.SetFilter("GCG_INTransit","TSO",V.Local.sFilter)
					F.Intrinsic.Math.Sub(V.DataView.GCG_INTransit!TSO.RowCount,V.Local.iDiff,V.Local.iDiff)
					F.Intrinsic.Control.If(V.DataView.SOOrder!SSO(V.DataView.SOOrder!SSO.RowCount--).Qty_Ordered!FieldValFloat,<,V.Local.iDiff)
						'getting the diff
						F.Intrinsic.Math.Sub(V.Local.iDiff,V.DataView.SOOrder!SSO(V.DataView.SOOrder!SSO.RowCount--).Qty_Ordered!FieldValFloat,V.Local.iDiff)
						
						'adding records to bin temp folder
						 F.Intrinsic.Control.For(V.Local.iCount,0,V.DataView.GCG_INTransit!TSO.RowCount--,1)
						 	F.Intrinsic.Control.If(V.DataView.GCG_INTransit!TSO(V.Local.iCount).Rec_Type!FieldValTrim,=,"T")
						 		F.Data.DataTable.AddRow("BinToBinTemp","REC_NO",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Rec_No!FieldVal,"RECORD_NO",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,"Part",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Part!FieldValTrim,"Lot",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Lot!FieldValTrim,"Heat",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Heat!FieldValTrim,"Serial_Number",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Serial_Number!FieldValTrim,"From_Bin","INTRAN","TO_Bin","","Rec_Type",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Rec_Type!FieldValTrim)
						 	F.Intrinsic.Control.Else
						 		F.Data.DataTable.AddRow("BinToBinTemp","REC_NO",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Rec_No!FieldVal,"RECORD_NO",V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,"Part",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Part!FieldValTrim,"Lot",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Lot!FieldValTrim,"Heat",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Heat!FieldValTrim,"Serial_Number",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Serial_Number!FieldValTrim,"From_Bin",V.DataView.GCG_INTransit!TSO(V.Local.iCount).To_Bin!FieldValTrim,"TO_Bin","","Rec_Type",V.DataView.GCG_INTransit!TSO(V.Local.iCount).Rec_Type!FieldValTrim)
						 	F.Intrinsic.Control.EndIf
						 F.Intrinsic.Control.Next(V.Local.iCount)
						
						'calling screen for the user to move these records to another bin before processing more records
						Gui.BinToBin.txtDiff.Text(V.Local.iDiff)
						Gui.BinToBin.txtSalesOrder.Text(V.DataTable.GCGSalesORder(V.Local.i).Order_No!FieldValTrim)
						
						F.Data.DataTable.SetValue("BintoBinTemp",-1,"Selection",False)
						
						F.Intrinsic.Control.CallSub(BinToBinSetProperties)
						
						Gui.BinToBin..Show
			
						'waiting for dismiss
						f.Intrinsic.Control.CallSub(WaitforDismiss,"Screen","BintoBin")
						'checking to see if there are no parts left to be moved
						'if parts still need to be moved so order will not be removed from the so change table
						F.Intrinsic.Control.If(V.Screen.BinToBin!txtDiff.Text,>,0)
							V.Local.bDelete.Set(False)
						F.Intrinsic.Control.Else
							'updating qty
							F.Data.DataTable.SetValue("GCGSalesORder",V.Local.i,"Qty_Ordered",V.DataView.SOOrder!SSO(V.DataView.SOOrder!SSO.RowCount--).Qty_Ordered!FieldValFloat)
						F.Intrinsic.Control.EndIf
						'clearing out the temp datatable for the next set of records that need to bemoved
						F.Data.DataTable.DeleteRow("BinToBinTemp")
						F.Data.DataTable.AcceptChanges("BinToBinTemp")
					F.Intrinsic.Control.Else
						'deleting records from in transit table that's not INTRAN or SHIP
						F.Intrinsic.String.Build("Delete From GCG_4552_IN_Transit Where Order_No = '{0}' and Record_No = '{1}' and Rec_Type = ''",V.DataTable.GCGSalesORder(V.Local.i).Order_No!FieldValTrim,V.DataTable.GCGSalesORder(V.Local.i).Record_No!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!con.Execute(V.Local.sSql)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					'no action required just updating the qty
					F.Data.DataView.SetValue("GCGSalesORder","SO",V.Local.i,"Qty_Ordered",V.DataTable.GCGSalesORder(V.Local.i).Qty_Ordered!FieldValFloat)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
F.Intrinsic.Control.Else
	Gui.In_Transit.lblStatus.Caption("")
	F.Intrinsic.String.Build("Delete From GCG_4552_SO_Change Where Order_No = '{0}'",V.Screen.In_Transit!txtNum.Text,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.bDelete,=,True)
	Gui.In_Transit.lblStatus.Caption("")
	Gui.In_Transit.cmdupdate.Visible(False)
	Gui.In_Transit..Enabled(True)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.[V.Local.sDatatableChild].Exists,=,True)
	F.Data.DataTable.Close(V.Local.sDatatableChild)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.[V.Local.sDatatableParent].Exists,=,True)
	F.Data.DataTable.Close(V.Local.sDatatableParent)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.GCGSalesORder!SO.Exists,=,True)
	F.Data.DataView.Close("GCGSalesORder","SO")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.GCGSalesORder.Exists,=,True)
	F.Data.DataTable.Close("GCGSalesORder")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.GCG_INTransit!TSO.Exists,=,True)
	F.Data.DataView.Close("GCG_INTransit","TSO")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.GCG_INTransit.Exists,=,True)
	F.Data.DataTable.Close("GCG_INTransit")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.BinToBinTemp.Exists,=,True)
	F.Data.DataTable.Close("BinToBinTemp")
F.Intrinsic.Control.EndIf

Gui.In_Transit.cmdupdate.Enabled(True)

F.Intrinsic.Control.CallSub(Get_Data)

Gui.In_Transit..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.cmdupdate_Click.End

Program.Sub.BinToBin_UnLoad.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

Gui.BinToBin..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.BinToBin_UnLoad.End

Program.Sub.GsGridControlBinTransfer_CellValueChanged.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.iDiff.Declare(Long,0)

F.Intrinsic.Control.If(V.Args.Column.UCase,=,"SELECTION")
	'checking to make sure user can't select more records than what needs to be removed
	F.Intrinsic.Control.If(V.Screen.BinToBin!txtDiff.Text,>,0)
		Gui.BinToBin.GsGridControlBinTransfer.SetCellValue("Head","Selection",V.Args.RowIndex,V.DataTable.BinToBinTemp(V.Args.RowIndex).Selection!FieldValNot)
		F.Intrinsic.Math.Sub(V.Screen.BinToBin!txtDiff.Text,1,V.Local.iDiff)
		Gui.BinToBin.txtDiff.Text(V.Local.iDiff)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.DataTable.BinToBinTemp(V.Args.RowIndex).Selection!FieldValNot,=,False)
			Gui.BinToBin.GsGridControlBinTransfer.SetCellValue("Head","Selection",V.Args.RowIndex,V.DataTable.BinToBinTemp(V.Args.RowIndex).Selection!FieldValNot)
			F.Intrinsic.Math.Add(V.Screen.BinToBin!txtDiff.Text,1,V.Local.iDiff)
			Gui.BinToBin.txtDiff.Text(V.Local.iDiff)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.GsGridControlBinTransfer_CellValueChanged.End

Program.Sub.BintoBinSetProperties.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.sToBin.Declare(String,"")

F.Data.Dictionary.ReturnAllPairs("ToBin",V.Local.sToBin)

F.Intrinsic.String.Split(V.Local.sToBin,"!*!",V.Local.sToBin)

Gui.BinToBin.GsGridControlBinTransfer.AddGridviewFromDatatable("Head","BintoBinTemp")

Gui.BinToBin.GsGridControlBinTransfer.MainView("Head")
Gui.BinToBin.GsGridControlBinTransfer.SuspendLayout()
Gui.BinToBin.GsGridControlBinTransfer.SetGridviewProperty("Head","Editable",False)
Gui.BinToBin.GsGridControlBinTransfer.SetGridviewProperty("Head","ReadOnly",True)

Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Selection","HeaderBackColor","Green")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Selection","HeaderForeColor","White")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Selection","Caption","Selection")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Rec_No","HeaderBackColor","Green")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Rec_No","HeaderForeColor","White")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Rec_No","Caption","Rec No")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Rec_No","Visible",False)
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Record_No","HeaderBackColor","Green")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Record_No","HeaderForeColor","White")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Record_No","Caption","Sales Order Line")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Part","HeaderBackColor","Green")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Part","HeaderForeColor","White")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Part","Caption","Part")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","From_Bin","HeaderBackColor","Green")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","From_Bin","HeaderForeColor","White")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","From_Bin","Caption","From Bin")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","To_Bin","HeaderBackColor","Green")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","To_Bin","HeaderForeColor","White")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","To_Bin","Caption","To Bin")
Gui.BinToBin.GsGridControlBinTransfer.ColumnEdit("Head","To_Bin","Combobox",V.Local.sToBin)
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Lot","HeaderBackColor","Green")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Lot","HeaderForeColor","White")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Lot","Caption","Lot")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Heat","HeaderBackColor","Green")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Heat","HeaderForeColor","White")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Heat","Caption","Heat")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Serial_Number","HeaderBackColor","Green")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Serial_Number","HeaderForeColor","White")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Serial_Number","Caption","Serial Number")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Rec_Type","HeaderBackColor","Green")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Rec_Type","HeaderForeColor","White")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Rec_Type","Caption","Rec Type")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Rec_Type","Visible",False)
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Status","HeaderBackColor","Green")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Status","HeaderForeColor","White")
Gui.BinToBin.GsGridControlBinTransfer.SetColumnProperty("Head","Status","Caption","Status")
Gui.BinToBin.GsGridControlBinTransfer.ResumeLayout()

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.BintoBinSetProperties.End

Program.Sub.GsGridControlBinTransfer_RowCellClick.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.iDiff.Declare(Long,0)

F.Intrinsic.Control.If(V.Args.Column.UCase,=,"SELECTION")
	'checking to make sure user can't select more records than what needs to be removed
	F.Intrinsic.Control.If(V.Screen.BinToBin!txtDiff.Text,>,0)
		F.Intrinsic.Control.If(V.DataTable.BinToBinTemp(V.Args.RowIndex).Selection!FieldValNot)
			F.Data.DataTable.SetValue("BintoBinTemp",V.Args.RowIndex,"Selection",V.DataTable.BinToBinTemp(V.Args.RowIndex).Selection!FieldValNot)
			F.Intrinsic.Math.Sub(V.Screen.BinToBin!txtDiff.Text,1,V.Local.iDiff)
			Gui.BinToBin.txtDiff.Text(V.Local.iDiff)
			F.Intrinsic.Control.If(V.Local.iDiff,=,0)
				Gui.BinToBin.cmdSubmit.Enabled(True)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Data.DataTable.SetValue("BintoBinTemp",V.Args.RowIndex,"Selection",V.DataTable.BinToBinTemp(V.Args.RowIndex).Selection!FieldValNot)
			F.Intrinsic.Math.Add(V.Screen.BinToBin!txtDiff.Text,1,V.Local.iDiff)
			Gui.BinToBin.txtDiff.Text(V.Local.iDiff)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.DataTable.BinToBinTemp(V.Args.RowIndex).Selection!FieldValNot,=,False)
			Gui.BinToBin.cmdSubmit.Enabled(False)
			F.Data.DataTable.SetValue("BintoBinTemp",V.Args.RowIndex,"Selection",V.DataTable.BinToBinTemp(V.Args.RowIndex).Selection!FieldValNot)
			F.Intrinsic.Math.Add(V.Screen.BinToBin!txtDiff.Text,1,V.Local.iDiff)
			Gui.BinToBin.txtDiff.Text(V.Local.iDiff)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.GsGridControlBinTransfer_RowCellClick.End

Program.Sub.cmdAutoToBin_Click.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

F.Intrinsic.Control.If(V.DataView.Head$Line!Line.RowCount--,<>,-1)
	F.Data.DataView.SetValue("Head","Line",-1,"To_Bin",V.DataView.Head$Line!Line(V.Global.iBIndex).To_Bin!FieldValTrim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.cmdAutoToBin_Click.End

Program.Sub.cmdSubmit_Click.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.iRet.Declare(Long,0)
V.Local.bRet.Declare(Boolean)
V.Local.sRet.Declare(String,"")
V.Local.sLoc.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.sFile.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sText.Declare(String,"")
V.Local.sFqn.Declare(String,"")
V.Local.sTemp2.Declare(String,"")
V.Local.fQty.Declare(Float,0)
V.Local.iC.Declare(Long,0)
V.Local.iTemp.Declare(Long,0)
V.Local.sStop.Declare(String,"")
V.Local.sStage.Declare(String,"")
V.Local.iUser.Declare(Long,0)
V.Local.sRec_No.Declare(String,"")
V.Local.sTransID.Declare(String,"")
V.Local.sOrdLine.Declare(String,"")

Gui.BinToBin.cmdSubmit.Enabled(False)

F.Intrinsic.Control.If(V.DataTable.Temp.Exists)
	F.Data.DataTable.Close("Temp")
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Selection = True","",V.Local.sFilter)
F.Intrinsic.Control.If(V.DataView.BinToBinTemp!Submit.Exists)
	F.Data.DataView.Close("BinToBinTemp","Submit")
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("BinToBinTemp","Submit")
F.Data.DataView.SetFilter("BinToBinTemp","Submit",V.Local.sFilter)

F.Data.DataView.ToDataTableDistinct("BinToBinTemp","Submit","Temp","Part*!*Lot*!*From_Bin*!*To_Bin*!*Heat*!*Serial_Number",True)

F.Intrinsic.Control.If(V.Screen.BinToBin!txtDiff.Text,=,0)
	F.Intrinsic.Control.If(V.DataView.BinToBinTemp!Submit.RowCount--,<>,-1)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Temp.RowCount--,1)
			'gettign parts that are intrans
			F.Intrinsic.String.Build("Part = '{0}' and Lot = '{1}' and From_Bin = '{2}' and Heat = '{3}' and Serial_Number = '{4}' and Selection = True",V.DataTable.Temp(V.Local.i).Part!FieldValTrim,V.DataTable.Temp(V.Local.i).Lot!FieldValTrim,V.DataTable.Temp(V.Local.i).From_Bin!FieldValTrim,V.DataTable.Temp(V.Local.i).Heat!FieldValTrim,V.DataTable.Temp(V.Local.i).Serial_Number!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.SetFilter("BinToBinTemp","Submit",V.Local.sFilter)
			V.Local.fQty.Set(V.DataView.BinToBinTemp!Submit.RowCount)
			F.Intrinsic.Control.If(V.DataTable.Temp(V.Local.i).To_Bin!FieldValTrim,=,"")	
				F.Intrinsic.Control.DoUntil(V.Local.bRet)
					'swapping out serial part for a new serial part
					F.Intrinsic.String.Build("Select Bin From V_Bin_Master","",V.Local.sSql)
					V.Local.sTitles.Set("Bin")
					V.Local.sWidths.Set("1800")
					F.Intrinsic.UI.Browser("Select Bin","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,V.Local.sRet)
		
					F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
						F.Data.DataTable.SetValue("Temp",-1,"To_Bin",V.Local.sRet(0).Trim)
						V.Local.bRet.Set(True)
					F.Intrinsic.Control.Else
						F.Intrinsic.UI.Msgbox("A To Bin needs to be selected.  Would you like to select a Bin?","",4,V.Local.iRet)
						
						F.Intrinsic.Control.If(V.Local.iRet,=,6)
							V.Local.bRet.Set(False)
							
						F.Intrinsic.Control.Else
							Gui.BinToBin.cmdSubmit.Enabled(False)
							F.Intrinsic.Control.ExitSub
				
						F.Intrinsic.Control.Endif
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Loop
			F.Intrinsic.Control.EndIf
	
			'creating temp datatble for qty, loc, lot, heat, serial for bin selected
			F.Intrinsic.String.Build("Select Location From V_Item_Master Where Part = '{0}' and Bin = '{1}' and Lot = '{2}' and Heat = '{3}' and Serial_Number = '{4}'",V.DataTable.Temp(V.Local.i).Part!FieldValTrim,V.DataTable.Temp(V.Local.i).From_Bin!FieldValTrim,V.DataTable.Temp(V.Local.i).Lot!FieldValTrim,V.DataTable.Temp(V.Local.i).Heat!FieldValTrim,V.DataTable.Temp(V.Local.i).Serial_Number!FieldValTrim,V.Local.sSql)
					
			F.Intrinsic.Control.If(V.DataTable.Item.Exists)
				F.Data.DataTable.Close("Item")
			F.Intrinsic.Control.EndIf
			
			F.Data.DataTable.CreateFromSQL("Item","con",V.Local.sSql,True)
			F.Intrinsic.Control.If(V.DataTable.Item.RowCount--,<>,-1)
				V.Local.sLoc.Set(V.DataTable.Item(V.DataTable.Item.RowCount--).Location!FieldValTrim)
			F.Intrinsic.Control.Else
				V.Local.sLoc.Set("")
			F.Intrinsic.Control.EndIf
			
			V.Local.sTemp.Redim(0,13)
			'part
			V.Local.sTemp(0).Set(V.DataTable.Temp(V.Local.i).Part!FieldValTrim)
			f.Intrinsic.String.RPad(v.Local.sTemp(0)," ",20,v.Local.sTemp(0))
				
			'loc
			V.Local.sTemp(1).set(V.Local.sLoc)
			'transfer qty
			V.Local.sTemp(2).Set(V.Local.fQty)
			'from bin
			V.Local.sTemp(3).Set(V.DataTable.Temp(V.Local.i).From_Bin!FieldValTrim)
			'to bin
			V.Local.sTemp(4).Set(V.DataTable.Temp(V.Local.i).To_Bin!FieldValTrim)
			'lot
			V.Local.sTemp(5).Set(V.DataTable.Temp(V.Local.i).Lot!FieldValTrim)
			'heat
			V.Local.sTemp(6).Set(V.DataTable.Temp(V.Local.i).Heat!FieldValTrim)
			'serial
			V.Local.sTemp(7).Set(V.DataTable.Temp(V.Local.i).Serial_Number!FieldValTrim)
			V.Local.sTemp(8).Set("")
			V.Local.sTemp(9).Set("")
			'to loc
			V.Local.sTemp(10).Set(V.Local.sLoc)
			V.Local.sTemp(11).Set("Y")
			V.Local.sTemp(12).Set(V.Caller.User)
			V.Local.sTemp(13).Set(V.Ambient.Date.formatYYYYMMDD)
			
			F.Data.DataView.ToString("BinToBinTemp","Submit","Rec_No","",",",V.Local.sRec_No)
			F.Data.DataView.Create("BinToBinTemp","Stage",22,"Selection = True and Rec_Type = 'S'","Rec_No")

			F.Intrinsic.String.Build("Delete From GCG_4552_In_Transit Where Rec_No IN ({0})",V.Local.sRec_No,V.Local.sSql)
			F.ODBC.Connection!con.Execute(V.Local.sSql)
			
			F.Intrinsic.String.Build("{0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13}",V.Local.sTemp(0),V.Local.sTemp(1),V.Local.sTemp(2).Long,V.Local.sTemp(3),V.Local.sTemp(4),V.Local.sTemp(5),V.Local.sTemp(6),V.Local.sTemp(7),V.Local.sTemp(8),V.Local.sTemp(9),V.Local.sTemp(10),V.Local.sTemp(11),V.Local.sTemp(12),V.Local.sTemp(13),V.Local.sTemp)
				
			F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sText,V.Local.sTemp,V.Ambient.NewLine,V.Local.sText)

			V.Local.bRet.Set(False)
			
			'getting parts that are staged
			
			F.Intrinsic.Control.If(V.DataView.BinToBinTemp!Stage.RowCount--,<>,-1)
				F.Intrinsic.Control.If(V.Local.sStage.UBound,=,0)
					V.Local.iTemp.Set(-1)
				F.Intrinsic.Control.Else
					V.Local.iTemp.Set(V.Local.sStage.UBound)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Math.Add(V.Local.iTemp,V.DataView.BinToBinTemp!Stage.RowCount,V.Local.iC)
				V.Local.sStage.RedimPreserve(0,V.Local.iC)
				F.Intrinsic.String.Left(V.DataView.BinToBinTemp!Stage(V.Local.i).Record_No!FieldValTrim,3,V.Local.sOrdLine)
				
				F.Intrinsic.Control.For(V.Local.iC,0,V.DataView.BinToBinTemp!Stage.RowCount--,1)
					V.Local.sStage.RedimPreserve(0,V.DataView.BinToBinTemp!Stage.RowCount--)
					'packinglist,order#,line#,part#,Location,Carton#,Pallet#,Quantity(in container),lot,bin,heat,serial
					F.Intrinsic.String.Build("Select Trans_Id, Seq, Trans_Type, Field_1, Field_2, Field_3, Field_4, Field_5, Field_10, Field_11, Field_14, Field_6, Field_7, Field_8, Field_9 From Wireless_Line Where Field_2 = {0} and Field_3 = '{1}' and Field_4 = '{2}' and Field_21 = '{3}' and Trans_Type = 'S10' Order By Trans_ID Desc",V.Screen.BinToBin!txtSalesOrder.Text,V.Local.sOrdLine,V.DataView.BinToBinTemp!Stage(V.Local.i).Part!FieldValTrim,V.DataView.BinToBinTemp!Stage(V.Local.i).Rec_No!FieldVal,V.Local.sSql)
					
					F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
					V.Local.sStage(V.Local.i).Set(V.Local.sRet)
				F.Intrinsic.Control.Next(V.Local.iC)
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Close("BinToBinTemp","Stage")
		F.Intrinsic.Control.Next(V.Local.i)
		
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No Part(s) have been selected to remove from Sales Order")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Local.sText.Length,>,0)
		'accu
		F.Intrinsic.String.Build("0{0}{1}BIN2BINTRNS",V.Caller.CompanyCode,V.Caller.Terminal,V.Local.sFile)
		F.Intrinsic.String.Build("{0}\{1}",V.Caller.FilesDir,V.Local.sFile,V.Local.sFqn)
		F.Intrinsic.File.String2File(V.Local.sFqn,V.Local.sText)
	
		F.Intrinsic.String.Build("{0}\{1}4552.stop",V.Caller.FilesDir,V.Caller.Terminal,V.Local.sStop)
		F.Intrinsic.File.String2File(V.Local.sStop,"Stop")
		F.Intrinsic.Task.LaunchGSSSync("LOT054UP","-c",V.Local.sFile)
		F.Intrinsic.File.DeleteFile(V.Local.sStop)
	F.Intrinsic.Control.EndIf
	'this is commented out until wireless remove part is fixed.  invalic pallet error once 1 container has been removed from the pallet.
'	F.Intrinsic.Control.If(V.Local.sStage.Length,>,0)
'		F.Intrinsic.Control.For(V.Local.i,0,V.Local.sStage.UBound,1)
'			F.ODBC.Connection!con.GetID("Wireless_Line","Trans_ID",True,V.Local.sTransID)
'			F.Intrinsic.String.LPad(V.Local.sTransID,"0",9,V.Local.sTransID)
'			
'			F.Intrinsic.String.Split(V.Local.sStage(V.Local.i),"*!*",V.Local.sTemp)
'			
'			F.ODBC.Connection!con.OpenLocalRecordSetRW("wir","Select * From Wireless_Line")
'			F.ODBC.con!wir.AddNew
'			F.ODBC.con!wir.Set!TRANS_ID(V.Local.sTransID)
'			F.ODBC.con!wir.Set!SEQ("0000")
'			F.ODBC.con!wir.Set!TRANS_TYPE("S30")
'			F.ODBC.con!wir.Set!Field_1(V.Local.sTemp(3))
'			F.ODBC.con!wir.Set!Field_2(V.Local.sTemp(4))
'			F.ODBC.con!wir.Set!Field_3(V.Local.sTemp(5))
'			F.ODBC.con!wir.Set!Field_4(V.Local.sTemp(6))
'			F.ODBC.con!wir.Set!Field_5(V.Local.sTemp(7))
'			F.ODBC.con!wir.Set!Field_6(V.Local.sTemp(8))
'			F.ODBC.con!wir.Set!Field_7(V.Local.sTemp(9))
'			F.ODBC.con!wir.Set!Field_8(V.Local.sTemp(10))
'			F.ODBC.con!wir.Set!Field_9(V.Local.sTemp(11))
'			F.ODBC.con!wir.Set!Field_10(V.Local.sTemp(12))
'			F.ODBC.con!wir.Set!Field_11(V.Local.sTemp(13))
'			F.ODBC.con!wir.Set!Field_12(V.Local.sTemp(14))
'			F.ODBC.con!wir.Update
'			F.ODBC.con!wir.Close
'			
'			F.ODBC.Connection!con.OpenLocalRecordSetRW("rstNew","SELECT * from WIRELESS_HDR")
'			F.ODBC.con!rstNew.AddNew
'			F.ODBC.con!rstNew.Set!TRANS_ID(V.Local.sTransID)
'			F.ODBC.con!rstNew.Set!TRANS_TYPE("S30")
'			F.ODBC.con!rstNew.Set!ATTEMPTED_DATE("00000000")
'			F.ODBC.con!rstNew.Set!ATTEMPTED_TIME("00000000")
'			F.ODBC.con!rstNew.Set!LABEL_PRINTER("")
'			F.Global.Security.GetUserId(V.Caller.User,V.Caller.CompanyCode,V.Local.iUser)
'			F.ODBC.con!rstNew.Set!USER_ID(V.Local.iUser)
'			F.ODBC.con!rstNew.Set!BATCH(0)
'			F.ODBC.con!rstNew.Update
'			F.ODBC.con!rstNew.Close
'					
'		F.Intrinsic.Control.Next(V.Local.i)	
'	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("There are still Parts that need to be removed....","Warning")
F.Intrinsic.Control.EndIf

F.Data.DataTable.SetValue("BinToBinTemp",-1,"Selection",False)

F.Intrinsic.Control.If(V.DataTable.Temp.Exists,=,True)
	F.Data.DataTable.Close("Temp")
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Delete From GCG_4552_SO_Change Where Order_No = '{0}'",V.Screen.BinToBin!txtSalesOrder.Text,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)
			
Gui.BinToBin.cmdSubmit.Enabled(False)

Gui.BinToBin..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.cmdSubmit_Click.End

Program.Sub.WaitforDismiss.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

F.Intrinsic.Control.SelectCase(V.Args.Screen.UCase)
	F.Intrinsic.Control.Case("BINTOBIN")
		F.Intrinsic.Control.DoUntil(V.Screen.BinToBin.Visible,=,False)
		'temp way around until the waitfordismiss functions if fixed.
		F.Intrinsic.Control.Loop

	F.Intrinsic.Control.Case("BINSELECT")
		F.Intrinsic.Control.DoUntil(V.Screen.Form_BinSelect.Visible,=,False)
		'temp way around until the waitfordismiss functions if fixed.
		F.Intrinsic.Control.Loop
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.WaitforDismiss.End

Program.Sub.txtNum_LostFocus.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

F.Intrinsic.Control.CallSub(Get_Data)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.txtNum_LostFocus.End

Program.Sub.Form_BinSelect_UnLoad.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

Gui.Form_BinSelect..Visible(False)
F.Intrinsic.UI.CloseWaitDialog

Gui.In_Transit.txtNewPart.Enabled(True)
Gui.In_Transit.GsGridControlNew.Enabled(True)
		
Gui.In_Transit..Show

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.Form_BinSelect_UnLoad.End

Program.Sub.txtScanBin_KeyPressEnter.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.sBin.Declare(String,"")
V.Local.sSerial.Declare(String,"")
V.Local.sFilter.Declare(String,"")

V.Local.sBin.Set(V.Screen.Form_BinSelect!txtScanBin.Text)
V.Local.sSerial.Set(V.Screen.Form_BinSelect!txtScanSerial.Text)
V.Local.sBin.Set(V.Local.sBin.Trim)
V.Local.sSerial.Set(V.Local.sSerial.Trim)

F.Intrinsic.Control.If(V.Local.sSerial.Length,=,0)
	F.Intrinsic.Control.If(V.Local.sBin.Length,<>,0)
		F.Intrinsic.String.Build("Bin = '{0}'",V.Local.sBin.UCase,V.Local.sFilter)
		F.Data.DataView.SetFilter("BinTemp","Temp",V.Local.sFilter)
		
		F.Intrinsic.Control.If(V.DataView.BinTemp!Temp.RowCount--,=,0)
			F.Intrinsic.UI.PlaySound(V.Global.sGoodScan)
			Gui.Form_BinSelect.txtScanBin.Text("")
			Gui.Form_BinSelect.txtScanSerial.Text("")
			F.Intrinsic.Control.CallSub(Form_BinSelect_UnLoad)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.DataView.BinTemp!Temp.RowCount--,=,-1)
				F.Intrinsic.UI.PlaySound(V.Global.sBadScan)
				F.Intrinsic.UI.SleepMS(250)
				F.Intrinsic.UI.PlaySound(V.Global.sBadScan)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("Serial_Number = '{0}'",V.Local.sSerial.Trim,V.Local.sFilter)
	F.Data.DataView.SetFilter("BinTemp","Temp",V.Local.sFilter)
		
	F.Intrinsic.Control.If(V.DataView.BinTemp!Temp.RowCount--,=,0)
		F.Intrinsic.UI.PlaySound(V.Global.sGoodScan)
		Gui.Form_BinSelect.txtScanBin.Text("")
		Gui.Form_BinSelect.txtScanSerial.Text("")
		F.Intrinsic.Control.CallSub(Form_BinSelect_UnLoad)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.DataView.BinTemp!Temp.RowCount--,=,-1)
			F.Intrinsic.UI.PlaySound(V.Global.sBadScan)
			F.Intrinsic.UI.SleepMS(250)
			F.Intrinsic.UI.PlaySound(V.Global.sBadScan)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

Gui.Form_BinSelect.txtScanSerial.SetFocus
Gui.Form_BinSelect.txtScanSerial.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.txtScanBin_KeyPressEnter.End

Program.Sub.Form_PickShipQty_UnLoad.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

Gui.Form_PickShipQty..Visible(False)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.Form_PickShipQty_UnLoad.End

Program.Sub.cmdPickShipSubmit_Click.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")
V.Local.fQty.Declare(Float,0)
V.Local.iC.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.iCount.Declare(Long,0)
V.Local.sDes.Declare(String,"")
V.Local.iRec.Declare(Long,0)
V.Local.iParentIndex.Declare(Long,0)
V.Local.iChildIndex.Declare(Long,0)
V.Local.sFilter.Declare(String,"")
V.Local.sSql.Declare(String,"")

F.Intrinsic.Control.SelectCase(V.Screen.In_Transit!tab1.Tab)
	F.Intrinsic.Control.Case(0)
		F.Intrinsic.UI.InvokeWaitDialog("Processing Selected Quantities..........","Processing")
		F.Data.DataView.Create("SO","QtyTemp")
		F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SO$Line(V.Global.iIndex).Record_No!FieldValTrim,V.Local.sFilter)
		F.Data.DataView.SetFilter("SO","QtyTemp",V.Local.sFilter)
		
		V.Local.iParentIndex.Set(V.DataView.SO!QtyTemp(V.DataView.SO!QtyTemp.RowCount--).DataTableIndex)
		F.Data.DataView.Close("SO","QtyTemp")
		
		V.Local.fQty.Set(V.DataTable.SO(V.Local.iParentIndex).Qty_Scanned!FieldValFloat)
		F.Intrinsic.Math.Add(V.Local.fQty,V.Screen.Form_PickShipQty!txtQtyCount.Text,V.Local.fQty)
		F.Data.DataTable.SetValue("SO",V.Local.iParentIndex,"Qty_Scanned",V.Local.fQty)
		F.Intrinsic.Math.Sub(V.DataTable.SO(V.Local.iParentIndex).Qty_Required!FieldValFloat,V.Screen.Form_PickShipQty!txtQtyCount.Text,V.Local.fQty)
		F.Data.DataTable.SetValue("SO",V.Local.iParentIndex,"Qty_Required",V.Local.fQty)
		F.Intrinsic.Math.Sub(V.DataTable.SO(V.Local.iParentIndex).Qty_OnHand!FieldValFloat,V.Screen.Form_PickShipQty!txtQtyCount.Text,V.Local.fQty)
		F.Data.DataTable.SetValue("SO",V.Local.iParentIndex,"Qty_OnHand",V.Local.fQty)
		
'		F.Intrinsic.Control.If(V.DataTable.SO(V.Local.iParentIndex).Qty_Required!FieldValFloat,=,0)
'			F.Intrinsic.Control.For(V.Local.iC,0,9,1)
'				Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.iC,V.Local.iParentIndex,"BackColor","#64fd64")
'			F.Intrinsic.Control.Next(V.Local.iC)
'			F.Intrinsic.Control.Else
'			F.Intrinsic.Control.If(V.DataTable.SO(V.Local.iParentIndex).Qty_OnHand!FieldValFloat,<=,0)
'				F.Intrinsic.Control.For(V.Local.iC,0,9,1)
'					Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.iC,V.Local.iParentIndex,"BackColor","#fd6464")
'				F.Intrinsic.Control.Next(V.Local.iC)
'			F.Intrinsic.Control.Else
'				F.Intrinsic.Control.For(V.Local.iC,0,9,1)
'					Gui.In_Transit.GsGridControlNew.SetCellAppearance("SO",V.Local.iC,V.Local.iParentIndex,"BackColor","#EDFD73")
'				F.Intrinsic.Control.Next(V.Local.iC)
'			F.Intrinsic.Control.EndIf
'		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Create("QtySelect","QtySelect")
		F.Data.DataView.SetFilter("QtySelect","QtySelect","Qty > 0")
		
		F.Intrinsic.String.Build("Select Description From Inventory_Mstr Where Part = '{0}'",V.DataTable.SO(V.Local.iParentIndex).Part!FieldValTrim,V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("Des","con",V.Local.sSql,True)
		
		F.Intrinsic.Control.If(V.DataTable.Des.RowCount--,<>,-1)
			V.Local.sDes.Set(V.DataTable.Des(V.DataTable.Des.RowCount--).Description!FieldValTrim)
		F.Intrinsic.Control.EndIf
		
		F.Data.DataTable.Close("Des")
		
		F.ODBC.Connection!con.GetID("GCG_4552_In_Transit","Rec_No",False,V.Local.iRec)
		
		F.Intrinsic.Control.For(V.Local.i,0,V.DataView.QtySelect!QtySelect.RowCount--,1)
			F.Intrinsic.Control.For(V.Local.iCount,1,V.DataView.QtySelect!QtySelect(V.Local.i).Qty!FieldValFloat,1)
				F.Intrinsic.Math.Add(V.Local.iRec,1,V.Local.iRec)
				F.Data.DataTable.AddRow("SO$Line","Rec_No",V.Local.iRec,"Order_No",V.DataTable.SO(V.Local.iParentIndex).Order_No!FieldValTrim,"Record_No",V.DataTable.SO(V.Local.iParentIndex).Record_No!FieldValTrim,"Part",V.DataTable.SO(V.Local.iParentIndex).Part!FieldValTrim,"Description",V.Local.sDes,"Qty_Required",1,"Qty_Scanned",1,"From_Bin",V.DataView.QtySelect!QtySelect(V.Local.i).Bin!FieldValTrim,"Heat",V.DataView.QtySelect!QtySelect(V.Local.i).Heat!FieldValTrim,"Lot",V.DataView.QtySelect!QtySelect(V.Local.i).Lot!FieldValTrim,"Serial_Number",V.DataView.QtySelect!QtySelect(V.Local.i).Serial_Number!FieldValTrim)			
'				F.Intrinsic.Control.For(V.Local.iC,0,12,1)
'					Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",V.Local.iC,V.DataTable.SO$Line.RowCount--,"BackColor","#64fd64")
'				F.Intrinsic.Control.Next(V.Local.iC)
'				
'				Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",5,V.DataTable.SO$Line.RowCount--,"Halignment","far")
'				Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",6,V.DataTable.SO$Line.RowCount--,"Halignment","far")
'				Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",7,V.DataTable.SO$Line.RowCount--,"Halignment","far")
'				Gui.In_Transit.GsGridControlNew.SetCellAppearance("Line",8,V.DataTable.SO$Line.RowCount--,"Halignment","far")
			F.Intrinsic.Control.Next(V.Local.iCount)
		F.Intrinsic.Control.Next(V.Local.i)				
		
		'saving everytime to incase user looses connection
		F.Data.DataTable.SaveToDB("SO","con","GCG_4552_Sales_Order","Order_No*!*Record_NO",256,"Order_No@!@Order_No*!*Record_No@!@Record_No*!*Customer@!@Customer*!*Part@!@Part*!*Qty_Ordered@!@Qty_Ordered*!*Qty_Required@!@Qty_Required*!*Qty_Scanned@!@Qty_Scanned")
		F.Data.DataTable.SaveToDB("SO$Line","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*Order_No@!@Order_No*!*Record_No@!@Record_No*!*Part@!@Part*!*Description@!@Description*!*Qty_Required@!@Qty_Required*!*Qty_Scanned@!@Qty_Scanned*!*From_Bin@!@From_Bin*!*To_Bin@!@To_Bin*!*Lot@!@Lot*!*Heat@!@Heat*!*Serial_Number@!@Serial_Number*!*Rec_Type@!@Rec_Type")
	
		F.Data.DataView.Close("QtySelect","QtySelect")
		F.Data.DataTable.Close("QtySelect")
		
		Gui.In_Transit.txtNum.Text(V.DataTable.SO(V.Local.iParentIndex).Order_No!FieldValTrim)
		F.Intrinsic.Control.CallSub(Get_Data)
		
		F.Intrinsic.UI.CloseWaitDialog
		
		F.Intrinsic.Control.CallSub(Form_PickShipQty_UnLoad)
		
	F.Intrinsic.Control.Case(1)
		F.Intrinsic.UI.InvokeWaitDialog("Processing Selected Quantities..........","Processing")
		
		F.Data.DataView.Create("SORec","QtyTemp")
		F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SORec$LineRec(V.Global.iIndex).Record_No!FieldValTrim,V.Local.sFilter)
		F.Data.DataView.SetFilter("SORec","QtyTemp",V.Local.sFilter)
	
		V.Local.iParentIndex.Set(V.DataView.SORec!QtyTemp(V.DataView.SORec!QtyTemp.RowCount--).DataTableIndex)
		F.Data.DataView.Close("SORec","QtyTemp")
		
		V.Local.fQty.Set(V.DataTable.SORec(V.Local.iParentIndex).Qty_Scanned!FieldValFloat)
		
		F.Intrinsic.Math.Add(V.Local.fQty,V.Screen.Form_PickShipQty!txtQtyCount.Text,V.Local.fQty)
		F.Data.DataTable.SetValue("SORec",V.Local.iParentIndex,"Qty_Scanned",V.Local.fQty)
		F.Intrinsic.Math.Sub(V.DataTable.SORec(V.Local.iParentIndex).Qty_Required!FieldValFloat,V.Screen.Form_PickShipQty!txtQtyCount.Text,V.Local.fQty)
		
		'saving everytime to incase user looses connection
		F.Data.DataTable.SaveToDB("QtySelect","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*QtySelect@!@Qty_Scanned")
		
		F.Data.DataTable.Close("QtySelect")
		
		F.Intrinsic.Control.CallSub(Get_Data)
		
		F.Intrinsic.UI.CloseWaitDialog
		
		F.Intrinsic.Control.CallSub(Form_PickShipQty_UnLoad)
		
	F.Intrinsic.Control.Case(2)
		F.Intrinsic.UI.InvokeWaitDialog("Processing Selected Quantities..........","Processing")
		
		F.Data.DataView.Create("SOStage","QtyTemp")
		F.Intrinsic.String.Build("Record_No = '{0}'",V.DataTable.SOStage$LineStage(V.Global.iIndex).Record_No!FieldValTrim,V.Local.sFilter)
		F.Data.DataView.SetFilter("SOStage","QtyTemp",V.Local.sFilter)
	
		V.Local.iParentIndex.Set(V.DataView.SOStage!QtyTemp(V.DataView.SOStage!QtyTemp.RowCount--).DataTableIndex)
		F.Data.DataView.Close("SOStage","QtyTemp")
		
		V.Local.fQty.Set(V.DataTable.SOStage(V.Local.iParentIndex).Qty_Scanned!FieldValFloat)
		
		F.Intrinsic.Math.Add(V.Local.fQty,V.Screen.Form_PickShipQty!txtQtyCount.Text,V.Local.fQty)
		F.Data.DataTable.SetValue("SOStage",V.Local.iParentIndex,"Qty_Scanned",V.Local.fQty)
		F.Intrinsic.Math.Sub(V.DataTable.SOStage(V.Local.iParentIndex).Qty_Required!FieldValFloat,V.Screen.Form_PickShipQty!txtQtyCount.Text,V.Local.fQty)
		
		'saving everytime to incase user looses connection
		F.Data.DataTable.SaveToDB("QtySelect","con","GCG_4552_In_Transit","Rec_No",256,"Rec_No@!@Rec_No*!*QtySelect@!@Qty_Scanned")
		
		F.Data.DataTable.Close("QtySelect")
		
		F.Intrinsic.Control.CallSub(Get_Data)
		
		F.Intrinsic.UI.CloseWaitDialog
		
		F.Intrinsic.Control.CallSub(Form_PickShipQty_UnLoad)
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.cmdPickShipSubmit_Click.End

Program.Sub.GsGridControlPickShipQty_CellValueChanged.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

F.Data.DataTable.AcceptChanges("QtySelect")

F.Intrinsic.Control.SelectCase(V.Screen.In_Transit!tab1.Tab)
	F.Intrinsic.Control.Case(0)
		Gui.Form_PickShipQty.txtQtyCount.Text(V.DataTable.QtySelect(V.DataTable.QtySelect.RowCount--).QtyCount!FieldValFloat)
		
		F.Intrinsic.Control.If(V.Screen.Form_PickShipQty!txtQtyCount.Text,>,V.Screen.Form_PickShipQty!txtQtyLeft.Text)
			F.Data.DataTable.SetValue("QtySelect",V.Args.RowIndex,"Qty",0)
			F.Data.DataTable.AcceptChanges("QtySelect")
			Gui.Form_PickShipQty.txtQtyCount.Text(V.DataTable.QtySelect(V.DataTable.QtySelect.RowCount--).QtyCount!FieldValFloat)
		F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Case(1)
		F.Data.DataTable.SetValue("QtySelect",V.Args.RowIndex,"Selected",V.DataTable.QtySelect(V.Args.RowIndex).Selected!FieldValNot)
		
		F.Data.DataTable.AcceptChanges("QtySelect")
		Gui.Form_PickShipQty.txtQtyCount.Text(V.DataTable.QtySelect(V.DataTable.QtySelect.RowCount--).QtyCount!FieldValFloat)
		
	F.Intrinsic.Control.Case(2)
		F.Data.DataTable.SetValue("QtySelect",V.Args.RowIndex,"Selected",V.DataTable.QtySelect(V.Args.RowIndex).Selected!FieldValNot)
		
		F.Data.DataTable.AcceptChanges("QtySelect")
		Gui.Form_PickShipQty.txtQtyCount.Text(V.DataTable.QtySelect(V.DataTable.QtySelect.RowCount--).QtyCount!FieldValFloat)
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.GsGridControlPickShipQty_CellValueChanged.End

Program.Sub.txtRecPart_GotFocus.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

Gui.In_Transit.txtRecPart.SelectAll

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.txtRecPart_GotFocus.End

Program.Sub.txtNewPart_GotFocus.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

Gui.In_Transit.txtNewPart.SelectAll

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.txtNewPart_GotFocus.End

Program.Sub.txtPartStage_GotFocus.Start
F.Intrinsic.Control.Try
V.Local.sError.Declare(String,"")

Gui.In_Transit.txtPartStage.SelectAll

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
		F.Intrinsic.String.Build("Project: GCG_4552_In_Transit.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.CallSub(In_Transit_UnLoad)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndTry
Program.Sub.txtPartStage_GotFocus.End

Program.Sub.Comments.Start
${$0$}$$}$$}$12:00:00 AM$}$False
Program.Sub.Comments.End
